begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to The Apereo Foundation under one or more contributor license  * agreements. See the NOTICE file distributed with this work for  * additional information regarding copyright ownership.  *  * The Apereo Foundation licenses this file to you under the Apache License,  * Version 2.0 (the "License"); you may not use this file except in  * compliance with the License. You may obtain a copy of the License at:  *  * http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  *  * See the License for the specific language governing permissions and  * limitations under the License.  *  */
end_comment

begin_package
package|package
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|server
operator|.
name|menu
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|File
import|;
end_import

begin_import
import|import
name|java
operator|.
name|net
operator|.
name|URL
import|;
end_import

begin_import
import|import
name|java
operator|.
name|net
operator|.
name|URLDecoder
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collection
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|servlet
operator|.
name|ServletException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|log4j
operator|.
name|Logger
import|;
end_import

begin_import
import|import
name|org
operator|.
name|dom4j
operator|.
name|Attribute
import|;
end_import

begin_import
import|import
name|org
operator|.
name|dom4j
operator|.
name|Document
import|;
end_import

begin_import
import|import
name|org
operator|.
name|dom4j
operator|.
name|Element
import|;
end_import

begin_import
import|import
name|org
operator|.
name|dom4j
operator|.
name|io
operator|.
name|SAXReader
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|beans
operator|.
name|factory
operator|.
name|InitializingBean
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|beans
operator|.
name|factory
operator|.
name|annotation
operator|.
name|Autowired
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|context
operator|.
name|annotation
operator|.
name|DependsOn
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|localization
operator|.
name|impl
operator|.
name|Localization
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|localization
operator|.
name|messages
operator|.
name|PageNames
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|ApplicationProperties
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|action
operator|.
name|PersonalizedExamReportAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|defaults
operator|.
name|ApplicationProperty
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|command
operator|.
name|client
operator|.
name|GwtRpcException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|command
operator|.
name|client
operator|.
name|GwtRpcResponseList
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|command
operator|.
name|server
operator|.
name|GwtRpcImplementation
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|command
operator|.
name|server
operator|.
name|GwtRpcImplements
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|MenuInterface
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|MenuInterface
operator|.
name|MenuRpcRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|PointInTimeData
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Roles
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|SavedHQL
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|SolverGroup
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|SessionDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|SessionContext
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|UserAuthority
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|UserContext
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|qualifiers
operator|.
name|SimpleQualifier
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|rights
operator|.
name|Right
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|service
operator|.
name|SolverServerService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|RoomAvailability
import|;
end_import

begin_import
import|import
name|org
operator|.
name|xml
operator|.
name|sax
operator|.
name|EntityResolver
import|;
end_import

begin_import
import|import
name|org
operator|.
name|xml
operator|.
name|sax
operator|.
name|InputSource
import|;
end_import

begin_comment
comment|/**  * @author Tomas Muller  */
end_comment

begin_class
annotation|@
name|GwtRpcImplements
argument_list|(
name|MenuRpcRequest
operator|.
name|class
argument_list|)
annotation|@
name|DependsOn
argument_list|(
block|{
literal|"startupService"
block|}
argument_list|)
specifier|public
class|class
name|MenuBackend
implements|implements
name|GwtRpcImplementation
argument_list|<
name|MenuRpcRequest
argument_list|,
name|GwtRpcResponseList
argument_list|<
name|MenuInterface
argument_list|>
argument_list|>
implements|,
name|InitializingBean
block|{
specifier|private
specifier|static
name|Logger
name|sLog
init|=
name|Logger
operator|.
name|getLogger
argument_list|(
name|MenuBackend
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|protected
name|Element
name|iRoot
init|=
literal|null
decl_stmt|;
specifier|private
specifier|static
name|PageNames
name|sPageNames
init|=
name|Localization
operator|.
name|create
argument_list|(
name|PageNames
operator|.
name|class
argument_list|)
decl_stmt|;
annotation|@
name|Autowired
specifier|private
name|SolverServerService
name|solverServerService
decl_stmt|;
annotation|@
name|Autowired
specifier|private
name|SessionContext
name|sessionContext
decl_stmt|;
annotation|@
name|Override
specifier|public
name|void
name|afterPropertiesSet
parameter_list|()
throws|throws
name|Exception
block|{
try|try
block|{
name|String
name|menu
init|=
name|ApplicationProperty
operator|.
name|MenuFile
operator|.
name|value
argument_list|()
decl_stmt|;
name|Document
name|document
init|=
literal|null
decl_stmt|;
name|URL
name|menuUrl
init|=
name|ApplicationProperties
operator|.
name|class
operator|.
name|getClassLoader
argument_list|()
operator|.
name|getResource
argument_list|(
name|menu
argument_list|)
decl_stmt|;
name|SAXReader
name|sax
init|=
operator|new
name|SAXReader
argument_list|()
decl_stmt|;
name|sax
operator|.
name|setEntityResolver
argument_list|(
operator|new
name|EntityResolver
argument_list|()
block|{
specifier|public
name|InputSource
name|resolveEntity
parameter_list|(
name|String
name|publicId
parameter_list|,
name|String
name|systemId
parameter_list|)
block|{
if|if
condition|(
name|publicId
operator|.
name|equals
argument_list|(
literal|"-//UniTime//UniTime Menu DTD/EN"
argument_list|)
condition|)
block|{
return|return
operator|new
name|InputSource
argument_list|(
name|ApplicationProperties
operator|.
name|class
operator|.
name|getClassLoader
argument_list|()
operator|.
name|getResourceAsStream
argument_list|(
literal|"menu.dtd"
argument_list|)
argument_list|)
return|;
block|}
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuUrl
operator|!=
literal|null
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Reading menu from "
operator|+
name|URLDecoder
operator|.
name|decode
argument_list|(
name|menuUrl
operator|.
name|getPath
argument_list|()
argument_list|,
literal|"UTF-8"
argument_list|)
operator|+
literal|" ..."
argument_list|)
expr_stmt|;
name|document
operator|=
name|sax
operator|.
name|read
argument_list|(
name|menuUrl
operator|.
name|openStream
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
operator|new
name|File
argument_list|(
name|menu
argument_list|)
operator|.
name|exists
argument_list|()
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Reading menu from "
operator|+
name|menu
operator|+
literal|" ..."
argument_list|)
expr_stmt|;
name|document
operator|=
name|sax
operator|.
name|read
argument_list|(
operator|new
name|File
argument_list|(
name|menu
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|document
operator|==
literal|null
condition|)
throw|throw
operator|new
name|ServletException
argument_list|(
literal|"Unable to create menu, reason: resource "
operator|+
name|menu
operator|+
literal|" not found."
argument_list|)
throw|;
if|if
condition|(
operator|!
literal|"unitime-menu"
operator|.
name|equals
argument_list|(
name|document
operator|.
name|getRootElement
argument_list|()
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
throw|throw
operator|new
name|ServletException
argument_list|(
literal|"Menu has an unknown format."
argument_list|)
throw|;
name|iRoot
operator|=
name|document
operator|.
name|getRootElement
argument_list|()
expr_stmt|;
name|String
name|customMenu
init|=
name|ApplicationProperty
operator|.
name|CustomMenuFile
operator|.
name|value
argument_list|()
decl_stmt|;
name|Document
name|customDocument
init|=
literal|null
decl_stmt|;
name|URL
name|customMenuUrl
init|=
name|ApplicationProperties
operator|.
name|class
operator|.
name|getClassLoader
argument_list|()
operator|.
name|getResource
argument_list|(
name|customMenu
argument_list|)
decl_stmt|;
if|if
condition|(
name|customMenuUrl
operator|!=
literal|null
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Reading custom menu from "
operator|+
name|URLDecoder
operator|.
name|decode
argument_list|(
name|customMenuUrl
operator|.
name|getPath
argument_list|()
argument_list|,
literal|"UTF-8"
argument_list|)
operator|+
literal|" ..."
argument_list|)
expr_stmt|;
name|customDocument
operator|=
name|sax
operator|.
name|read
argument_list|(
name|customMenuUrl
operator|.
name|openStream
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
operator|new
name|File
argument_list|(
name|customMenu
argument_list|)
operator|.
name|exists
argument_list|()
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Reading custom menu from "
operator|+
name|customMenu
operator|+
literal|" ..."
argument_list|)
expr_stmt|;
name|customDocument
operator|=
name|sax
operator|.
name|read
argument_list|(
operator|new
name|File
argument_list|(
name|customMenu
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|customDocument
operator|!=
literal|null
condition|)
block|{
name|merge
argument_list|(
name|iRoot
argument_list|,
name|customDocument
operator|.
name|getRootElement
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
if|if
condition|(
name|e
operator|instanceof
name|RuntimeException
condition|)
throw|throw
operator|(
name|RuntimeException
operator|)
name|e
throw|;
throw|throw
operator|new
name|RuntimeException
argument_list|(
literal|"Unable to initialize, reason: "
operator|+
name|e
operator|.
name|getMessage
argument_list|()
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
specifier|public
name|GwtRpcResponseList
argument_list|<
name|MenuInterface
argument_list|>
name|execute
parameter_list|(
name|MenuRpcRequest
name|request
parameter_list|,
name|SessionContext
name|context
parameter_list|)
block|{
try|try
block|{
name|org
operator|.
name|hibernate
operator|.
name|Session
name|hibSession
init|=
name|SessionDAO
operator|.
name|getInstance
argument_list|()
operator|.
name|getSession
argument_list|()
decl_stmt|;
try|try
block|{
name|GwtRpcResponseList
argument_list|<
name|MenuInterface
argument_list|>
name|menu
init|=
operator|new
name|GwtRpcResponseList
argument_list|<
name|MenuInterface
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|iRoot
operator|==
literal|null
condition|)
throw|throw
operator|new
name|GwtRpcException
argument_list|(
literal|"menu is not configured properly"
argument_list|)
throw|;
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|iRoot
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|element
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|MenuInterface
name|m
init|=
name|getMenu
argument_list|(
name|element
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|!=
literal|null
condition|)
name|menu
operator|.
name|add
argument_list|(
name|m
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|menu
operator|.
name|isEmpty
argument_list|()
condition|)
throw|throw
operator|new
name|GwtRpcException
argument_list|(
literal|"no menu"
argument_list|)
throw|;
return|return
name|menu
return|;
block|}
finally|finally
block|{
name|hibSession
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
block|}
catch|catch
parameter_list|(
name|GwtRpcException
name|e
parameter_list|)
block|{
throw|throw
name|e
throw|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|GwtRpcException
argument_list|(
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
throw|;
block|}
block|}
specifier|private
name|void
name|merge
parameter_list|(
name|Element
name|menu
parameter_list|,
name|Element
name|custom
parameter_list|)
block|{
if|if
condition|(
literal|"remove"
operator|.
name|equals
argument_list|(
name|custom
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|menu
operator|.
name|getParent
argument_list|()
operator|.
name|remove
argument_list|(
name|menu
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|Iterator
argument_list|<
name|Attribute
argument_list|>
name|i
init|=
name|custom
operator|.
name|attributeIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Attribute
name|a
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|menu
operator|.
name|addAttribute
argument_list|(
name|a
operator|.
name|getName
argument_list|()
argument_list|,
name|a
operator|.
name|getValue
argument_list|()
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|custom
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|e
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
literal|"parameter"
operator|.
name|equals
argument_list|(
name|e
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|j
init|=
name|menu
operator|.
name|elementIterator
argument_list|(
literal|"parameter"
argument_list|)
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|menu
operator|.
name|remove
argument_list|(
name|j
operator|.
name|next
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|menu
operator|.
name|add
argument_list|(
name|e
operator|.
name|createCopy
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
literal|"condition"
operator|.
name|equals
argument_list|(
name|e
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|menu
operator|.
name|add
argument_list|(
name|e
operator|.
name|createCopy
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
literal|"new-condition"
operator|.
name|equals
argument_list|(
name|e
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|j
init|=
name|menu
operator|.
name|elementIterator
argument_list|(
literal|"condition"
argument_list|)
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|menu
operator|.
name|remove
argument_list|(
name|j
operator|.
name|next
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|Element
name|f
init|=
name|e
operator|.
name|createCopy
argument_list|()
decl_stmt|;
name|f
operator|.
name|setName
argument_list|(
literal|"condition"
argument_list|)
expr_stmt|;
name|menu
operator|.
name|add
argument_list|(
name|f
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|String
name|name
init|=
name|e
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
decl_stmt|;
name|Element
name|x
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|name
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|j
init|=
name|menu
operator|.
name|elementIterator
argument_list|()
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|f
init|=
name|j
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|name
operator|.
name|equals
argument_list|(
name|f
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
argument_list|)
condition|)
block|{
name|x
operator|=
name|f
expr_stmt|;
break|break;
block|}
block|}
block|}
if|if
condition|(
name|x
operator|!=
literal|null
condition|)
block|{
name|merge
argument_list|(
name|x
argument_list|,
name|e
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|int
name|pos
init|=
name|Integer
operator|.
name|parseInt
argument_list|(
name|e
operator|.
name|attributeValue
argument_list|(
literal|"position"
argument_list|,
literal|"-1"
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
name|pos
operator|>=
literal|0
condition|)
block|{
name|List
argument_list|<
name|Element
argument_list|>
name|after
init|=
operator|new
name|ArrayList
argument_list|<
name|Element
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|j
init|=
name|menu
operator|.
name|elementIterator
argument_list|()
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|f
init|=
name|j
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
literal|"condition"
operator|.
name|equals
argument_list|(
name|f
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|pos
operator|>
literal|0
condition|)
block|{
name|pos
operator|--
expr_stmt|;
block|}
else|else
block|{
name|after
operator|.
name|add
argument_list|(
name|f
argument_list|)
expr_stmt|;
name|menu
operator|.
name|remove
argument_list|(
name|f
argument_list|)
expr_stmt|;
block|}
block|}
name|menu
operator|.
name|add
argument_list|(
name|e
operator|.
name|createCopy
argument_list|()
argument_list|)
expr_stmt|;
for|for
control|(
name|Element
name|f
range|:
name|after
control|)
name|menu
operator|.
name|add
argument_list|(
name|f
argument_list|)
expr_stmt|;
block|}
else|else
name|menu
operator|.
name|add
argument_list|(
name|e
operator|.
name|createCopy
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
specifier|private
name|MenuInterface
name|getMenu
parameter_list|(
name|Element
name|menuElement
parameter_list|)
block|{
try|try
block|{
name|MenuInterface
name|menu
init|=
operator|new
name|MenuInterface
argument_list|()
decl_stmt|;
name|String
name|name
init|=
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
decl_stmt|;
name|String
name|localizedName
init|=
operator|(
name|name
operator|==
literal|null
condition|?
literal|null
else|:
name|sPageNames
operator|.
name|translateMessage
argument_list|(
name|name
operator|.
name|trim
argument_list|()
operator|.
name|replace
argument_list|(
literal|' '
argument_list|,
literal|'-'
argument_list|)
operator|.
name|replace
argument_list|(
literal|"("
argument_list|,
literal|""
argument_list|)
operator|.
name|replace
argument_list|(
literal|")"
argument_list|,
literal|""
argument_list|)
operator|.
name|replace
argument_list|(
literal|':'
argument_list|,
literal|'-'
argument_list|)
operator|.
name|toLowerCase
argument_list|()
argument_list|,
literal|null
argument_list|)
operator|)
decl_stmt|;
name|menu
operator|.
name|setName
argument_list|(
name|localizedName
operator|==
literal|null
condition|?
name|name
else|:
name|localizedName
argument_list|)
expr_stmt|;
name|menu
operator|.
name|setTitle
argument_list|(
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"title"
argument_list|)
argument_list|)
expr_stmt|;
name|menu
operator|.
name|setTarget
argument_list|(
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"target"
argument_list|)
argument_list|)
expr_stmt|;
name|menu
operator|.
name|setPage
argument_list|(
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"page"
argument_list|)
argument_list|)
expr_stmt|;
name|menu
operator|.
name|setHash
argument_list|(
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"hash"
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|type
init|=
name|menuElement
operator|.
name|attributeValue
argument_list|(
literal|"type"
argument_list|)
decl_stmt|;
if|if
condition|(
literal|"gwt"
operator|.
name|equals
argument_list|(
name|type
argument_list|)
condition|)
name|menu
operator|.
name|setGWT
argument_list|(
literal|true
argument_list|)
expr_stmt|;
if|if
condition|(
literal|"property"
operator|.
name|equals
argument_list|(
name|type
argument_list|)
operator|&&
name|menu
operator|.
name|getPage
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|menu
operator|.
name|setPage
argument_list|(
name|ApplicationProperties
operator|.
name|getProperty
argument_list|(
name|menu
operator|.
name|getPage
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|menu
operator|.
name|getPage
argument_list|()
operator|==
literal|null
condition|)
return|return
literal|null
return|;
block|}
name|boolean
name|sep
init|=
literal|true
decl_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|menuElement
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|element
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
literal|"condition"
operator|.
name|equals
argument_list|(
name|element
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|check
argument_list|(
name|element
argument_list|)
condition|)
return|return
literal|null
return|;
block|}
if|else if
condition|(
literal|"parameter"
operator|.
name|equals
argument_list|(
name|element
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|menu
operator|.
name|addParameter
argument_list|(
name|element
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
argument_list|,
name|element
operator|.
name|attributeValue
argument_list|(
literal|"value"
argument_list|,
name|element
operator|.
name|getText
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|MenuInterface
name|m
init|=
name|getMenu
argument_list|(
name|element
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|!=
literal|null
condition|)
block|{
if|if
condition|(
name|sep
operator|&&
name|m
operator|.
name|isSeparator
argument_list|()
condition|)
continue|continue;
name|menu
operator|.
name|addSubMenu
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|sep
operator|=
name|m
operator|.
name|isSeparator
argument_list|()
expr_stmt|;
block|}
block|}
block|}
while|while
condition|(
name|menu
operator|.
name|hasSubMenus
argument_list|()
operator|&&
name|menu
operator|.
name|getSubMenus
argument_list|()
operator|.
name|get
argument_list|(
name|menu
operator|.
name|getSubMenus
argument_list|()
operator|.
name|size
argument_list|()
operator|-
literal|1
argument_list|)
operator|.
name|isSeparator
argument_list|()
condition|)
name|menu
operator|.
name|getSubMenus
argument_list|()
operator|.
name|remove
argument_list|(
name|menu
operator|.
name|getSubMenus
argument_list|()
operator|.
name|size
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
return|return
operator|(
name|menu
operator|.
name|isSeparator
argument_list|()
operator|||
name|menu
operator|.
name|hasPage
argument_list|()
operator|||
name|menu
operator|.
name|hasSubMenus
argument_list|()
condition|?
name|menu
else|:
literal|null
operator|)
return|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|e
operator|.
name|printStackTrace
argument_list|()
expr_stmt|;
return|return
literal|null
return|;
block|}
block|}
specifier|private
name|boolean
name|check
parameter_list|(
name|Element
name|conditionElement
parameter_list|)
block|{
name|String
name|cond
init|=
name|conditionElement
operator|.
name|getName
argument_list|()
decl_stmt|;
if|if
condition|(
literal|"and"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
operator|||
literal|"condition"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|conditionElement
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|element
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|check
argument_list|(
name|element
argument_list|)
condition|)
return|return
literal|false
return|;
block|}
return|return
literal|true
return|;
block|}
if|else  if
condition|(
literal|"or"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|conditionElement
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|element
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|check
argument_list|(
name|element
argument_list|)
condition|)
return|return
literal|true
return|;
block|}
return|return
literal|false
return|;
block|}
if|else if
condition|(
literal|"not"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
argument_list|<
name|Element
argument_list|>
name|i
init|=
name|conditionElement
operator|.
name|elementIterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Element
name|element
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|check
argument_list|(
name|element
argument_list|)
condition|)
return|return
literal|false
return|;
block|}
return|return
literal|true
return|;
block|}
if|else if
condition|(
literal|"isAuthenticated"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
return|;
block|}
if|else if
condition|(
literal|"hasRole"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
name|UserContext
name|user
init|=
name|sessionContext
operator|.
name|getUser
argument_list|()
decl_stmt|;
if|if
condition|(
name|user
operator|==
literal|null
condition|)
return|return
literal|false
return|;
name|String
name|role
init|=
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
decl_stmt|;
if|if
condition|(
name|role
operator|==
literal|null
condition|)
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HasRole
argument_list|)
return|;
empty_stmt|;
comment|// has any role
if|if
condition|(
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|==
literal|null
condition|)
return|return
name|Roles
operator|.
name|ROLE_ANONYMOUS
operator|.
name|equals
argument_list|(
name|role
argument_list|)
return|;
else|else
return|return
name|role
operator|.
name|equalsIgnoreCase
argument_list|(
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|.
name|getRole
argument_list|()
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"propertyEquals"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
return|return
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"value"
argument_list|,
literal|"true"
argument_list|)
operator|.
name|equalsIgnoreCase
argument_list|(
name|ApplicationProperties
operator|.
name|getProperty
argument_list|(
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|,
literal|"dummy"
argument_list|)
argument_list|,
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"defaultValue"
argument_list|,
literal|"false"
argument_list|)
argument_list|)
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasProperty"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
return|return
name|ApplicationProperties
operator|.
name|getProperty
argument_list|(
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|,
literal|"dummy"
argument_list|)
argument_list|)
operator|!=
literal|null
return|;
block|}
if|else if
condition|(
literal|"hasPermission"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
name|Right
name|right
init|=
literal|null
decl_stmt|;
try|try
block|{
name|right
operator|=
name|Right
operator|.
name|valueOf
argument_list|(
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|IllegalArgumentException
name|e
parameter_list|)
block|{
name|sLog
operator|.
name|warn
argument_list|(
literal|"Unknown right: "
operator|+
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|right
operator|==
literal|null
condition|)
return|return
literal|false
return|;
name|String
name|authority
init|=
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"authority"
argument_list|,
literal|"current"
argument_list|)
decl_stmt|;
name|String
name|check
init|=
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"check"
argument_list|,
literal|"true"
argument_list|)
decl_stmt|;
if|if
condition|(
literal|"false"
operator|.
name|equals
argument_list|(
name|check
argument_list|)
condition|)
block|{
name|UserContext
name|user
init|=
operator|(
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
condition|?
name|sessionContext
operator|.
name|getUser
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
if|if
condition|(
name|user
operator|==
literal|null
condition|)
return|return
literal|false
return|;
if|if
condition|(
literal|"session"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
name|Long
name|sessionId
init|=
name|user
operator|.
name|getCurrentAcademicSessionId
argument_list|()
decl_stmt|;
name|Collection
argument_list|<
name|?
extends|extends
name|UserAuthority
argument_list|>
name|authorities
init|=
name|user
operator|.
name|getAuthorities
argument_list|()
decl_stmt|;
if|if
condition|(
name|authorities
operator|!=
literal|null
operator|&&
name|sessionId
operator|!=
literal|null
condition|)
for|for
control|(
name|UserAuthority
name|ua
range|:
name|authorities
control|)
if|if
condition|(
name|sessionId
operator|.
name|equals
argument_list|(
name|ua
operator|.
name|getAcademicSession
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|ua
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getQualifierId
argument_list|()
argument_list|)
operator|&&
name|ua
operator|.
name|hasRight
argument_list|(
name|right
argument_list|)
condition|)
return|return
literal|true
return|;
return|return
literal|false
return|;
block|}
if|else if
condition|(
literal|"role"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
name|String
name|role
init|=
operator|(
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|!=
literal|null
condition|?
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|.
name|getRole
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
name|Collection
argument_list|<
name|?
extends|extends
name|UserAuthority
argument_list|>
name|authorities
init|=
operator|(
name|role
operator|==
literal|null
condition|?
literal|null
else|:
name|user
operator|.
name|getAuthorities
argument_list|(
name|role
argument_list|)
operator|)
decl_stmt|;
if|if
condition|(
name|authorities
operator|!=
literal|null
condition|)
for|for
control|(
name|UserAuthority
name|ua
range|:
name|authorities
control|)
if|if
condition|(
name|ua
operator|.
name|hasRight
argument_list|(
name|right
argument_list|)
condition|)
return|return
literal|true
return|;
block|}
if|else if
condition|(
literal|"any"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
name|Collection
argument_list|<
name|?
extends|extends
name|UserAuthority
argument_list|>
name|authorities
init|=
name|user
operator|.
name|getAuthorities
argument_list|()
decl_stmt|;
if|if
condition|(
name|authorities
operator|!=
literal|null
condition|)
for|for
control|(
name|UserAuthority
name|ua
range|:
name|authorities
control|)
if|if
condition|(
name|ua
operator|.
name|hasRight
argument_list|(
name|right
argument_list|)
condition|)
return|return
literal|true
return|;
return|return
literal|false
return|;
block|}
else|else
block|{
return|return
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|!=
literal|null
operator|&&
name|user
operator|.
name|getCurrentAuthority
argument_list|()
operator|.
name|hasRight
argument_list|(
name|right
argument_list|)
return|;
block|}
block|}
else|else
block|{
if|if
condition|(
literal|"session"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
name|Long
name|sessionId
init|=
operator|(
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
condition|?
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getCurrentAcademicSessionId
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
return|return
operator|(
name|sessionId
operator|==
literal|null
condition|?
literal|false
else|:
name|sessionContext
operator|.
name|hasPermissionAnyAuthority
argument_list|(
name|right
argument_list|,
operator|new
name|SimpleQualifier
argument_list|(
literal|"Session"
argument_list|,
name|sessionId
argument_list|)
argument_list|)
operator|)
return|;
block|}
if|else if
condition|(
literal|"role"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
name|UserAuthority
name|ua
init|=
operator|(
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
condition|?
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getCurrentAuthority
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
name|String
name|role
init|=
operator|(
name|ua
operator|!=
literal|null
condition|?
name|ua
operator|.
name|getRole
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
return|return
operator|(
name|role
operator|==
literal|null
condition|?
literal|false
else|:
name|sessionContext
operator|.
name|hasPermissionAnyAuthority
argument_list|(
name|right
argument_list|,
operator|new
name|SimpleQualifier
argument_list|(
literal|"Role"
argument_list|,
name|role
argument_list|)
argument_list|)
operator|)
return|;
block|}
if|else if
condition|(
literal|"any"
operator|.
name|equals
argument_list|(
name|authority
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermissionAnyAuthority
argument_list|(
name|right
argument_list|)
return|;
block|}
else|else
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|right
argument_list|)
return|;
block|}
block|}
block|}
if|else if
condition|(
literal|"hasRight"
operator|.
name|equals
argument_list|(
name|cond
argument_list|)
condition|)
block|{
name|String
name|right
init|=
name|conditionElement
operator|.
name|attributeValue
argument_list|(
literal|"name"
argument_list|,
literal|"unknown"
argument_list|)
decl_stmt|;
if|if
condition|(
literal|"canSeeEvents"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermissionAnyAuthority
argument_list|(
name|Right
operator|.
name|Events
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasRoomAvailability"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|RoomAvailability
operator|.
name|getInstance
argument_list|()
operator|!=
literal|null
return|;
block|}
if|else if
condition|(
literal|"hasPersonalReport"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
operator|&&
name|PersonalizedExamReportAction
operator|.
name|hasPersonalReport
argument_list|(
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalUserId
argument_list|()
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"isChameleon"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
operator|&&
operator|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|Chameleon
argument_list|)
operator|||
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|instanceof
name|UserContext
operator|.
name|Chameleon
operator|)
return|;
block|}
if|else if
condition|(
literal|"isSectioningEnabled"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|solverServerService
operator|.
name|isOnlineStudentSchedulingEnabled
argument_list|()
return|;
block|}
if|else if
condition|(
literal|"isStudent"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
operator|&&
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|hasRole
argument_list|(
name|Roles
operator|.
name|ROLE_STUDENT
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"isInstructor"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
operator|&&
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|hasRole
argument_list|(
name|Roles
operator|.
name|ROLE_INSTRUCTOR
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"isRegistrationEnabled"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|solverServerService
operator|.
name|isStudentRegistrationEnabled
argument_list|()
return|;
block|}
else|else
block|{
if|if
condition|(
literal|"canSeeCourses"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|InstructionalOfferings
argument_list|)
operator|||
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|Classes
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"canSeeTimetable"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|ClassAssignments
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"canDoTimetable"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|CourseTimetabling
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasASolverGroup"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|isAuthenticated
argument_list|()
operator|&&
operator|!
name|SolverGroup
operator|.
name|getUserSolverGroups
argument_list|(
name|sessionContext
operator|.
name|getUser
argument_list|()
argument_list|)
operator|.
name|isEmpty
argument_list|()
return|;
block|}
if|else if
condition|(
literal|"canSectionStudents"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|StudentScheduling
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"canSeeExams"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|Examinations
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"canTimetableExams"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|ExaminationTimetabling
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"canAudit"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|CourseTimetablingAudit
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasCourseReports"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsCourses
argument_list|)
operator|&&
name|SavedHQL
operator|.
name|hasQueries
argument_list|(
name|SavedHQL
operator|.
name|Flag
operator|.
name|APPEARANCE_COURSES
argument_list|,
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsAdminOnly
argument_list|)
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasExamReports"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsExaminations
argument_list|)
operator|&&
name|SavedHQL
operator|.
name|hasQueries
argument_list|(
name|SavedHQL
operator|.
name|Flag
operator|.
name|APPEARANCE_EXAMS
argument_list|,
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsAdminOnly
argument_list|)
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasEventReports"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsEvents
argument_list|)
operator|&&
name|SavedHQL
operator|.
name|hasQueries
argument_list|(
name|SavedHQL
operator|.
name|Flag
operator|.
name|APPEARANCE_EVENTS
argument_list|,
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsAdminOnly
argument_list|)
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasStudentReports"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsStudents
argument_list|)
operator|&&
name|SavedHQL
operator|.
name|hasQueries
argument_list|(
name|SavedHQL
operator|.
name|Flag
operator|.
name|APPEARANCE_SECTIONING
argument_list|,
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|HQLReportsAdminOnly
argument_list|)
argument_list|)
return|;
block|}
if|else if
condition|(
literal|"hasPointInTimeDataReports"
operator|.
name|equals
argument_list|(
name|right
argument_list|)
operator|&&
operator|!
name|PointInTimeData
operator|.
name|findAllForSession
argument_list|(
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getCurrentAcademicSessionId
argument_list|()
argument_list|)
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
return|return
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|PointInTimeDataReports
argument_list|)
return|;
block|}
block|}
name|sLog
operator|.
name|warn
argument_list|(
literal|"Unknown right "
operator|+
name|right
operator|+
literal|"."
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
name|sLog
operator|.
name|warn
argument_list|(
literal|"Unknown condition "
operator|+
name|cond
operator|+
literal|"."
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
block|}
end_class

end_unit

