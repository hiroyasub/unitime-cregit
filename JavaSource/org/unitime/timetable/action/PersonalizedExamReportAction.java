begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to The Apereo Foundation under one or more contributor license  * agreements. See the NOTICE file distributed with this work for  * additional information regarding copyright ownership.  *  * The Apereo Foundation licenses this file to you under the Apache License,  * Version 2.0 (the "License"); you may not use this file except in  * compliance with the License. You may obtain a copy of the License at:  *  * http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  *  * See the License for the specific language governing permissions and  * limitations under the License.  *  */
end_comment

begin_package
package|package
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|action
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|File
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|FileWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|OutputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|PrintWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|text
operator|.
name|DecimalFormat
import|;
end_import

begin_import
import|import
name|java
operator|.
name|text
operator|.
name|SimpleDateFormat
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Calendar
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Date
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Locale
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Set
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|TimeZone
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|TreeSet
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|servlet
operator|.
name|http
operator|.
name|HttpServletRequest
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|servlet
operator|.
name|http
operator|.
name|HttpServletResponse
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|Log
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|LogFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|struts
operator|.
name|action
operator|.
name|Action
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|struts
operator|.
name|action
operator|.
name|ActionForm
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|struts
operator|.
name|action
operator|.
name|ActionForward
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|struts
operator|.
name|action
operator|.
name|ActionMapping
import|;
end_import

begin_import
import|import
name|org
operator|.
name|cpsolver
operator|.
name|coursett
operator|.
name|model
operator|.
name|TimeLocation
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|beans
operator|.
name|factory
operator|.
name|annotation
operator|.
name|Autowired
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|security
operator|.
name|core
operator|.
name|context
operator|.
name|SecurityContextHolder
import|;
end_import

begin_import
import|import
name|org
operator|.
name|springframework
operator|.
name|stereotype
operator|.
name|Service
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|Debug
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|MultiComparable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|WebTable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|WebTable
operator|.
name|WebTableLine
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|WebTable
operator|.
name|WebTableTweakStyle
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|localization
operator|.
name|impl
operator|.
name|Localization
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|defaults
operator|.
name|ApplicationProperty
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|events
operator|.
name|QueryEncoderBackend
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|form
operator|.
name|PersonalizedExamReportForm
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|GwtConstants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|interfaces
operator|.
name|ExternalUidTranslation
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|interfaces
operator|.
name|ExternalUidTranslation
operator|.
name|Source
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Assignment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|ClassInstructor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Class_
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|CourseOffering
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|DatePattern
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|DepartmentStatusType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|DepartmentalInstructor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Exam
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|ExamOwner
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|ExamType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Location
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Meeting
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|PreferenceLevel
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Session
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|StudentClassEnrollment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|DepartmentalInstructorDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|ExamDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|SessionDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|StudentDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|reports
operator|.
name|exam
operator|.
name|InstructorExamReport
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|reports
operator|.
name|exam
operator|.
name|StudentExamReport
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|SessionContext
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|security
operator|.
name|rights
operator|.
name|Right
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamAssignment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamAssignmentInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamAssignmentInfo
operator|.
name|BackToBackConflict
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamAssignmentInfo
operator|.
name|DirectConflict
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamAssignmentInfo
operator|.
name|MoreThanTwoADayConflict
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|solver
operator|.
name|exam
operator|.
name|ui
operator|.
name|ExamInfo
operator|.
name|ExamSectionInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|AccessDeniedException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Constants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|ExportUtils
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Formats
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|webutil
operator|.
name|PdfWebTable
import|;
end_import

begin_comment
comment|/**  * @author Tomas Muller  */
end_comment

begin_class
annotation|@
name|Service
argument_list|(
literal|"/personalSchedule"
argument_list|)
specifier|public
class|class
name|PersonalizedExamReportAction
extends|extends
name|Action
block|{
specifier|protected
specifier|static
name|GwtConstants
name|CONSTANTS
init|=
name|Localization
operator|.
name|create
argument_list|(
name|GwtConstants
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|public
specifier|static
name|ExternalUidTranslation
name|sTranslation
decl_stmt|;
specifier|private
specifier|static
name|Log
name|sLog
init|=
name|LogFactory
operator|.
name|getLog
argument_list|(
name|PersonalizedExamReportAction
operator|.
name|class
argument_list|)
decl_stmt|;
annotation|@
name|Autowired
name|SessionContext
name|sessionContext
decl_stmt|;
static|static
block|{
if|if
condition|(
name|ApplicationProperty
operator|.
name|ExternalUserIdTranslation
operator|.
name|value
argument_list|()
operator|!=
literal|null
condition|)
block|{
try|try
block|{
name|sTranslation
operator|=
operator|(
name|ExternalUidTranslation
operator|)
name|Class
operator|.
name|forName
argument_list|(
name|ApplicationProperty
operator|.
name|ExternalUserIdTranslation
operator|.
name|value
argument_list|()
argument_list|)
operator|.
name|getConstructor
argument_list|()
operator|.
name|newInstance
argument_list|()
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|Debug
operator|.
name|error
argument_list|(
literal|"Unable to instantiate external uid translation class, "
operator|+
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
specifier|public
specifier|static
name|String
name|translate
parameter_list|(
name|String
name|uid
parameter_list|,
name|Source
name|target
parameter_list|)
block|{
if|if
condition|(
name|sTranslation
operator|==
literal|null
operator|||
name|uid
operator|==
literal|null
operator|||
name|target
operator|.
name|equals
argument_list|(
name|Source
operator|.
name|User
argument_list|)
condition|)
return|return
name|uid
return|;
return|return
name|sTranslation
operator|.
name|translate
argument_list|(
name|uid
argument_list|,
name|Source
operator|.
name|User
argument_list|,
name|target
argument_list|)
return|;
block|}
specifier|public
specifier|static
name|boolean
name|hasPersonalReport
parameter_list|(
name|String
name|userId
parameter_list|)
block|{
if|if
condition|(
name|userId
operator|==
literal|null
condition|)
return|return
literal|false
return|;
comment|//if (user.getRole()!=null) return false;
name|HashSet
argument_list|<
name|Session
argument_list|>
name|sessions
init|=
operator|new
name|HashSet
argument_list|()
decl_stmt|;
name|DepartmentalInstructor
name|instructor
init|=
literal|null
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|DepartmentalInstructorDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"select i from DepartmentalInstructor i where i.externalUniqueId=:externalId"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"externalId"
argument_list|,
name|userId
argument_list|)
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|DepartmentalInstructor
name|s
init|=
operator|(
name|DepartmentalInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|canDisplay
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
condition|)
continue|continue;
name|sessions
operator|.
name|add
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|instructor
operator|==
literal|null
operator|||
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|compareTo
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|instructor
operator|=
name|s
expr_stmt|;
block|}
name|Student
name|student
init|=
literal|null
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|StudentDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"select s from Student s where s.externalUniqueId=:externalId"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"externalId"
argument_list|,
name|userId
argument_list|)
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Student
name|s
init|=
operator|(
name|Student
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|canDisplay
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
condition|)
continue|continue;
name|sessions
operator|.
name|add
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|student
operator|==
literal|null
operator|||
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|compareTo
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|student
operator|=
name|s
expr_stmt|;
block|}
if|if
condition|(
name|instructor
operator|==
literal|null
operator|&&
name|student
operator|==
literal|null
condition|)
return|return
literal|false
return|;
return|return
literal|true
return|;
block|}
specifier|public
name|ActionForward
name|execute
parameter_list|(
name|ActionMapping
name|mapping
parameter_list|,
name|ActionForm
name|form
parameter_list|,
name|HttpServletRequest
name|request
parameter_list|,
name|HttpServletResponse
name|response
parameter_list|)
throws|throws
name|Exception
block|{
name|PersonalizedExamReportForm
name|myForm
init|=
operator|(
name|PersonalizedExamReportForm
operator|)
name|form
decl_stmt|;
name|String
name|back
init|=
operator|(
name|String
operator|)
name|request
operator|.
name|getSession
argument_list|()
operator|.
name|getAttribute
argument_list|(
literal|"loginPage"
argument_list|)
decl_stmt|;
if|if
condition|(
name|back
operator|==
literal|null
condition|)
name|back
operator|=
literal|"back"
expr_stmt|;
try|try
block|{
name|sessionContext
operator|.
name|checkPermission
argument_list|(
name|Right
operator|.
name|PersonalSchedule
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|AccessDeniedException
name|e
parameter_list|)
block|{
name|request
operator|.
name|setAttribute
argument_list|(
literal|"message"
argument_list|,
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
return|return
name|mapping
operator|.
name|findForward
argument_list|(
name|back
argument_list|)
return|;
block|}
if|if
condition|(
name|request
operator|.
name|getParameter
argument_list|(
literal|"q"
argument_list|)
operator|!=
literal|null
condition|)
block|{
name|String
index|[]
name|params
init|=
name|QueryEncoderBackend
operator|.
name|decode
argument_list|(
name|request
operator|.
name|getParameter
argument_list|(
literal|"q"
argument_list|)
argument_list|)
operator|.
name|split
argument_list|(
literal|":"
argument_list|)
decl_stmt|;
if|if
condition|(
name|params
operator|!=
literal|null
operator|&&
name|params
operator|.
name|length
operator|==
literal|2
condition|)
block|{
name|myForm
operator|.
name|setUid
argument_list|(
name|params
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|myForm
operator|.
name|setSessionId
argument_list|(
name|Long
operator|.
name|valueOf
argument_list|(
name|params
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|String
name|externalId
init|=
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalUserId
argument_list|()
decl_stmt|;
name|String
name|userName
init|=
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getName
argument_list|()
decl_stmt|;
name|myForm
operator|.
name|setAdmin
argument_list|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|PersonalScheduleLookup
argument_list|)
argument_list|)
expr_stmt|;
name|myForm
operator|.
name|setLogout
argument_list|(
operator|!
literal|"back"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|PersonalScheduleLookup
argument_list|)
operator|&&
name|myForm
operator|.
name|getUid
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|myForm
operator|.
name|getUid
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|externalId
operator|=
name|myForm
operator|.
name|getUid
argument_list|()
expr_stmt|;
name|userName
operator|=
operator|(
name|myForm
operator|.
name|getLname
argument_list|()
operator|==
literal|null
operator|||
name|myForm
operator|.
name|getLname
argument_list|()
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|?
literal|""
else|:
literal|" "
operator|+
name|Constants
operator|.
name|toInitialCase
argument_list|(
name|myForm
operator|.
name|getLname
argument_list|()
argument_list|)
operator|)
operator|+
operator|(
name|myForm
operator|.
name|getFname
argument_list|()
operator|==
literal|null
operator|||
name|myForm
operator|.
name|getFname
argument_list|()
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|?
literal|""
else|:
literal|" "
operator|+
name|myForm
operator|.
name|getFname
argument_list|()
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
operator|.
name|toUpperCase
argument_list|()
operator|)
operator|+
operator|(
name|myForm
operator|.
name|getMname
argument_list|()
operator|==
literal|null
operator|||
name|myForm
operator|.
name|getMname
argument_list|()
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|?
literal|""
else|:
literal|" "
operator|+
name|myForm
operator|.
name|getMname
argument_list|()
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
operator|.
name|toUpperCase
argument_list|()
operator|)
expr_stmt|;
block|}
if|if
condition|(
name|externalId
operator|==
literal|null
operator|||
name|externalId
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|)
block|{
name|request
operator|.
name|setAttribute
argument_list|(
literal|"message"
argument_list|,
literal|"No user id provided."
argument_list|)
expr_stmt|;
return|return
name|mapping
operator|.
name|findForward
argument_list|(
name|back
argument_list|)
return|;
block|}
if|if
condition|(
literal|"Log Out"
operator|.
name|equals
argument_list|(
name|myForm
operator|.
name|getOp
argument_list|()
argument_list|)
condition|)
block|{
name|SecurityContextHolder
operator|.
name|getContext
argument_list|()
operator|.
name|setAuthentication
argument_list|(
literal|null
argument_list|)
expr_stmt|;
return|return
name|mapping
operator|.
name|findForward
argument_list|(
name|back
argument_list|)
return|;
block|}
if|if
condition|(
literal|"classes"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
block|{
if|if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|==
literal|null
condition|)
block|{
name|myForm
operator|.
name|setSessionId
argument_list|(
operator|(
name|Long
operator|)
name|request
operator|.
name|getSession
argument_list|()
operator|.
name|getAttribute
argument_list|(
literal|"Classes.session"
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|request
operator|.
name|getSession
argument_list|()
operator|.
name|setAttribute
argument_list|(
literal|"Classes.session"
argument_list|,
name|myForm
operator|.
name|getSessionId
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
literal|"exams"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
block|{
if|if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|==
literal|null
condition|)
block|{
name|myForm
operator|.
name|setSessionId
argument_list|(
operator|(
name|Long
operator|)
name|request
operator|.
name|getSession
argument_list|()
operator|.
name|getAttribute
argument_list|(
literal|"Exams.session"
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|request
operator|.
name|getSession
argument_list|()
operator|.
name|setAttribute
argument_list|(
literal|"Exams.session"
argument_list|,
name|myForm
operator|.
name|getSessionId
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
name|HashSet
argument_list|<
name|Session
argument_list|>
name|sessions
init|=
operator|new
name|HashSet
argument_list|()
decl_stmt|;
name|DepartmentalInstructor
name|instructor
init|=
literal|null
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|DepartmentalInstructorDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"select i from DepartmentalInstructor i where i.externalUniqueId=:externalId"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"externalId"
argument_list|,
name|translate
argument_list|(
name|externalId
argument_list|,
name|Source
operator|.
name|Staff
argument_list|)
argument_list|)
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|DepartmentalInstructor
name|s
init|=
operator|(
name|DepartmentalInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|canDisplay
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
condition|)
continue|continue;
name|sessions
operator|.
name|add
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|instructor
operator|==
literal|null
operator|||
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|compareTo
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|instructor
operator|=
name|s
expr_stmt|;
block|}
if|else if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|.
name|equals
argument_list|(
name|s
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
block|{
name|instructor
operator|=
name|s
expr_stmt|;
block|}
block|}
name|Student
name|student
init|=
literal|null
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|StudentDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"select s from Student s where s.externalUniqueId=:externalId"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"externalId"
argument_list|,
name|translate
argument_list|(
name|externalId
argument_list|,
name|Source
operator|.
name|Student
argument_list|)
argument_list|)
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Student
name|s
init|=
operator|(
name|Student
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|canDisplay
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
condition|)
continue|continue;
name|sessions
operator|.
name|add
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|student
operator|==
literal|null
operator|||
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|compareTo
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|student
operator|=
name|s
expr_stmt|;
block|}
if|else if
condition|(
name|myForm
operator|.
name|getSessionId
argument_list|()
operator|.
name|equals
argument_list|(
name|s
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
name|student
operator|=
name|s
expr_stmt|;
block|}
if|if
condition|(
name|instructor
operator|==
literal|null
operator|&&
name|student
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|myForm
operator|.
name|getAdmin
argument_list|()
condition|)
block|{
name|back
operator|=
literal|"back"
expr_stmt|;
name|myForm
operator|.
name|setLogout
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
literal|"classes"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
name|request
operator|.
name|setAttribute
argument_list|(
literal|"message"
argument_list|,
literal|"No classes found."
argument_list|)
expr_stmt|;
if|else if
condition|(
literal|"exams"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
name|request
operator|.
name|setAttribute
argument_list|(
literal|"message"
argument_list|,
literal|"No examinations found."
argument_list|)
expr_stmt|;
else|else
name|request
operator|.
name|setAttribute
argument_list|(
literal|"message"
argument_list|,
literal|"No schedule found."
argument_list|)
expr_stmt|;
name|sLog
operator|.
name|info
argument_list|(
literal|"No matching instructor or student found for "
operator|+
name|userName
operator|+
literal|" ("
operator|+
name|translate
argument_list|(
name|externalId
argument_list|,
name|Source
operator|.
name|Student
argument_list|)
operator|+
literal|"), forwarding back ("
operator|+
name|back
operator|+
literal|")."
argument_list|)
expr_stmt|;
return|return
name|mapping
operator|.
name|findForward
argument_list|(
name|back
argument_list|)
return|;
block|}
block|}
name|myForm
operator|.
name|setCanExport
argument_list|(
literal|false
argument_list|)
expr_stmt|;
if|if
condition|(
name|instructor
operator|!=
literal|null
operator|&&
name|student
operator|!=
literal|null
operator|&&
operator|!
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|equals
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
argument_list|)
condition|)
block|{
if|if
condition|(
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|compareTo
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|instructor
operator|=
literal|null
expr_stmt|;
else|else
name|student
operator|=
literal|null
expr_stmt|;
block|}
name|long
name|t0
init|=
name|System
operator|.
name|currentTimeMillis
argument_list|()
decl_stmt|;
if|if
condition|(
name|instructor
operator|!=
literal|null
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Requesting schedule for "
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
operator|+
literal|" (instructor)"
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|student
operator|!=
literal|null
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"Requesting schedule for "
operator|+
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
operator|+
literal|" (student)"
argument_list|)
expr_stmt|;
block|}
name|HashSet
argument_list|<
name|ExamOwner
argument_list|>
name|studentExams
init|=
operator|new
name|HashSet
argument_list|<
name|ExamOwner
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|student
operator|!=
literal|null
condition|)
block|{
comment|/*             for (Iterator i=student.getClassEnrollments().iterator();i.hasNext();) {                 StudentClassEnrollment sce = (StudentClassEnrollment)i.next();                 studentExams.addAll(Exam.findAllRelated("Class_", sce.getClazz().getUniqueId()));             }             */
name|studentExams
operator|.
name|addAll
argument_list|(
operator|new
name|ExamDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"select distinct o from Student s inner join s.classEnrollments ce, ExamOwner o inner join o.course co "
operator|+
literal|"inner join co.instructionalOffering io "
operator|+
literal|"inner join io.instrOfferingConfigs ioc "
operator|+
literal|"inner join ioc.schedulingSubparts ss "
operator|+
literal|"inner join ss.classes c where "
operator|+
literal|"s.uniqueId=:studentId and c=ce.clazz and ("
operator|+
literal|"(o.ownerType="
operator|+
name|ExamOwner
operator|.
name|sOwnerTypeCourse
operator|+
literal|" and o.ownerId=co.uniqueId) or "
operator|+
literal|"(o.ownerType="
operator|+
name|ExamOwner
operator|.
name|sOwnerTypeOffering
operator|+
literal|" and o.ownerId=io.uniqueId) or "
operator|+
literal|"(o.ownerType="
operator|+
name|ExamOwner
operator|.
name|sOwnerTypeConfig
operator|+
literal|" and o.ownerId=ioc.uniqueId) or "
operator|+
literal|"(o.ownerType="
operator|+
name|ExamOwner
operator|.
name|sOwnerTypeClass
operator|+
literal|" and o.ownerId=c.uniqueId) "
operator|+
literal|")"
argument_list|)
operator|.
name|setLong
argument_list|(
literal|"studentId"
argument_list|,
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
argument_list|)
expr_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|ExamOwner
argument_list|>
name|i
init|=
name|studentExams
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Exam
name|exam
init|=
name|i
operator|.
name|next
argument_list|()
operator|.
name|getExam
argument_list|()
decl_stmt|;
name|DepartmentStatusType
name|type
init|=
name|exam
operator|.
name|effectiveStatusType
argument_list|()
decl_stmt|;
if|if
condition|(
name|type
operator|==
literal|null
operator|||
operator|!
name|type
operator|.
name|can
argument_list|(
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
operator|==
name|ExamType
operator|.
name|sExamTypeFinal
condition|?
name|DepartmentStatusType
operator|.
name|Status
operator|.
name|ReportExamsFinal
else|:
name|DepartmentStatusType
operator|.
name|Status
operator|.
name|ReportExamsMidterm
argument_list|)
condition|)
name|i
operator|.
name|remove
argument_list|()
expr_stmt|;
block|}
block|}
name|HashSet
argument_list|<
name|Exam
argument_list|>
name|instructorExams
init|=
operator|new
name|HashSet
argument_list|<
name|Exam
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|instructor
operator|!=
literal|null
condition|)
block|{
name|instructorExams
operator|.
name|addAll
argument_list|(
name|instructor
operator|.
name|getAllExams
argument_list|()
argument_list|)
expr_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|Exam
argument_list|>
name|i
init|=
name|instructorExams
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Exam
name|exam
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|DepartmentStatusType
name|type
init|=
name|exam
operator|.
name|effectiveStatusType
argument_list|()
decl_stmt|;
if|if
condition|(
name|type
operator|==
literal|null
operator|||
operator|!
name|type
operator|.
name|can
argument_list|(
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
operator|==
name|ExamType
operator|.
name|sExamTypeFinal
condition|?
name|DepartmentStatusType
operator|.
name|Status
operator|.
name|ReportExamsFinal
else|:
name|DepartmentStatusType
operator|.
name|Status
operator|.
name|ReportExamsMidterm
argument_list|)
condition|)
name|i
operator|.
name|remove
argument_list|()
expr_stmt|;
block|}
block|}
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o0"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o0"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o1"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o1"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o2"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o2"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o3"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o3"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o4"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o4"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o5"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o5"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o6"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o6"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|WebTable
operator|.
name|setOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o7"
argument_list|,
name|request
operator|.
name|getParameter
argument_list|(
literal|"o7"
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|boolean
name|hasClasses
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|student
operator|!=
literal|null
operator|&&
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
operator|&&
operator|!
name|student
operator|.
name|getClassEnrollments
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|PdfWebTable
name|table
init|=
name|getStudentClassSchedule
argument_list|(
literal|true
argument_list|,
name|student
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|table
operator|.
name|getLines
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|request
operator|.
name|setAttribute
argument_list|(
literal|"clsschd"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o6"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|hasClasses
operator|=
literal|true
expr_stmt|;
name|myForm
operator|.
name|setCanExport
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|instructor
operator|!=
literal|null
operator|&&
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
condition|)
block|{
name|PdfWebTable
name|table
init|=
name|getInstructorClassSchedule
argument_list|(
literal|true
argument_list|,
name|instructor
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|table
operator|.
name|getLines
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|request
operator|.
name|setAttribute
argument_list|(
literal|"iclsschd"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|Math
operator|.
name|abs
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o7"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|hasClasses
operator|=
literal|true
expr_stmt|;
name|myForm
operator|.
name|setCanExport
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|instructor
operator|!=
literal|null
operator|&&
name|sessions
operator|.
name|size
argument_list|()
operator|>
literal|1
condition|)
block|{
name|PdfWebTable
name|table
init|=
name|getSessions
argument_list|(
literal|true
argument_list|,
name|sessions
argument_list|,
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
decl_stmt|;
name|request
operator|.
name|setAttribute
argument_list|(
literal|"sessions"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o0"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|student
operator|!=
literal|null
operator|&&
name|sessions
operator|.
name|size
argument_list|()
operator|>
literal|1
condition|)
block|{
name|PdfWebTable
name|table
init|=
name|getSessions
argument_list|(
literal|true
argument_list|,
name|sessions
argument_list|,
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
decl_stmt|;
name|request
operator|.
name|setAttribute
argument_list|(
literal|"sessions"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o0"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|hasClasses
operator|&&
name|instructorExams
operator|.
name|isEmpty
argument_list|()
operator|&&
name|studentExams
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
if|if
condition|(
literal|"classes"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
name|myForm
operator|.
name|setMessage
argument_list|(
literal|"No classes found in "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
else|:
name|student
operator|.
name|getSession
argument_list|()
operator|)
operator|.
name|getLabel
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
if|else if
condition|(
literal|"exams"
operator|.
name|equals
argument_list|(
name|back
argument_list|)
condition|)
name|myForm
operator|.
name|setMessage
argument_list|(
literal|"No examinations found in "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
else|:
name|student
operator|.
name|getSession
argument_list|()
operator|)
operator|.
name|getLabel
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
if|else if
condition|(
name|student
operator|!=
literal|null
operator|||
name|instructor
operator|!=
literal|null
condition|)
name|myForm
operator|.
name|setMessage
argument_list|(
literal|"No classes or examinations found in "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
else|:
name|student
operator|.
name|getSession
argument_list|()
operator|)
operator|.
name|getLabel
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
if|else if
condition|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|Right
operator|.
name|PersonalScheduleLookup
argument_list|)
condition|)
name|myForm
operator|.
name|setMessage
argument_list|(
literal|"No classes or examinations found in "
operator|+
name|SessionDAO
operator|.
name|getInstance
argument_list|()
operator|.
name|get
argument_list|(
name|sessionContext
operator|.
name|getUser
argument_list|()
operator|.
name|getCurrentAcademicSessionId
argument_list|()
argument_list|)
operator|.
name|getLabel
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
else|else
name|myForm
operator|.
name|setMessage
argument_list|(
literal|"No classes or examinations found for "
operator|+
name|userName
operator|+
literal|"."
argument_list|)
expr_stmt|;
name|sLog
operator|.
name|info
argument_list|(
literal|"No classes or exams found for "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
else|:
name|student
operator|!=
literal|null
condition|?
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
else|:
name|userName
operator|)
argument_list|)
expr_stmt|;
block|}
name|boolean
name|useCache
init|=
name|ApplicationProperty
operator|.
name|ExaminationCacheConflicts
operator|.
name|isTrue
argument_list|()
decl_stmt|;
if|if
condition|(
literal|"Export PDF"
operator|.
name|equals
argument_list|(
name|myForm
operator|.
name|getOp
argument_list|()
argument_list|)
condition|)
block|{
name|sLog
operator|.
name|info
argument_list|(
literal|"  Generating PDF for "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
else|:
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|OutputStream
name|out
init|=
name|ExportUtils
operator|.
name|getPdfOutputStream
argument_list|(
name|response
argument_list|,
literal|"schedule"
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|instructorExams
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
init|=
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|Exam
name|exam
range|:
name|instructorExams
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
name|exams
operator|.
name|add
argument_list|(
operator|new
name|ExamAssignmentInfo
argument_list|(
name|exam
argument_list|,
name|useCache
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|InstructorExamReport
name|ir
init|=
operator|new
name|InstructorExamReport
argument_list|(
literal|0
argument_list|,
name|out
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|,
literal|null
argument_list|,
literal|null
argument_list|,
name|exams
argument_list|)
decl_stmt|;
name|ir
operator|.
name|setM2d
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ir
operator|.
name|setDirect
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ir
operator|.
name|setClassSchedule
argument_list|(
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
argument_list|)
expr_stmt|;
name|ir
operator|.
name|printHeader
argument_list|()
expr_stmt|;
name|ir
operator|.
name|printReport
argument_list|(
name|ExamInfo
operator|.
name|createInstructorInfo
argument_list|(
name|instructor
argument_list|)
argument_list|,
name|exams
argument_list|)
expr_stmt|;
name|ir
operator|.
name|lastPage
argument_list|()
expr_stmt|;
name|ir
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
operator|!
name|studentExams
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
init|=
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
decl_stmt|;
name|TreeSet
argument_list|<
name|ExamSectionInfo
argument_list|>
name|sections
init|=
operator|new
name|TreeSet
argument_list|<
name|ExamSectionInfo
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamOwner
name|examOwner
range|:
name|studentExams
control|)
block|{
if|if
condition|(
name|examOwner
operator|.
name|getExam
argument_list|()
operator|.
name|getAssignedPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
name|ExamAssignmentInfo
name|x
init|=
operator|new
name|ExamAssignmentInfo
argument_list|(
name|examOwner
argument_list|,
name|student
argument_list|,
name|studentExams
argument_list|)
decl_stmt|;
name|exams
operator|.
name|add
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|sections
operator|.
name|addAll
argument_list|(
name|x
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|StudentExamReport
name|sr
init|=
operator|new
name|StudentExamReport
argument_list|(
literal|0
argument_list|,
name|out
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
argument_list|,
literal|null
argument_list|,
literal|null
argument_list|,
name|exams
argument_list|)
decl_stmt|;
name|sr
operator|.
name|setM2d
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setBtb
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setDirect
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setClassSchedule
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
argument_list|)
expr_stmt|;
name|sr
operator|.
name|printHeader
argument_list|()
expr_stmt|;
name|sr
operator|.
name|printReport
argument_list|(
name|student
argument_list|,
name|sections
argument_list|)
expr_stmt|;
name|sr
operator|.
name|lastPage
argument_list|()
expr_stmt|;
name|sr
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
name|hasClasses
condition|)
block|{
if|if
condition|(
name|instructor
operator|!=
literal|null
condition|)
block|{
name|InstructorExamReport
name|ir
init|=
operator|new
name|InstructorExamReport
argument_list|(
literal|0
argument_list|,
name|out
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
argument_list|,
literal|null
argument_list|,
literal|null
argument_list|,
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
argument_list|)
decl_stmt|;
name|ir
operator|.
name|setM2d
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ir
operator|.
name|setDirect
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ir
operator|.
name|setClassSchedule
argument_list|(
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
argument_list|)
expr_stmt|;
name|ir
operator|.
name|printHeader
argument_list|()
expr_stmt|;
name|ir
operator|.
name|printReport
argument_list|(
name|ExamInfo
operator|.
name|createInstructorInfo
argument_list|(
name|instructor
argument_list|)
argument_list|,
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
argument_list|)
expr_stmt|;
name|ir
operator|.
name|lastPage
argument_list|()
expr_stmt|;
name|ir
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
name|student
operator|!=
literal|null
condition|)
block|{
name|StudentExamReport
name|sr
init|=
operator|new
name|StudentExamReport
argument_list|(
literal|0
argument_list|,
name|out
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
argument_list|,
literal|null
argument_list|,
literal|null
argument_list|,
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
argument_list|)
decl_stmt|;
name|sr
operator|.
name|setM2d
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setBtb
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setDirect
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|sr
operator|.
name|setClassSchedule
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
argument_list|)
expr_stmt|;
name|sr
operator|.
name|printHeader
argument_list|()
expr_stmt|;
name|sr
operator|.
name|printReport
argument_list|(
name|student
argument_list|,
operator|new
name|TreeSet
argument_list|<
name|ExamSectionInfo
argument_list|>
argument_list|()
argument_list|)
expr_stmt|;
name|sr
operator|.
name|lastPage
argument_list|()
expr_stmt|;
name|sr
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
block|}
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
return|return
literal|null
return|;
block|}
if|if
condition|(
literal|"iCalendar"
operator|.
name|equals
argument_list|(
name|myForm
operator|.
name|getOp
argument_list|()
argument_list|)
condition|)
block|{
name|Long
name|sid
init|=
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
else|:
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
operator|)
decl_stmt|;
name|response
operator|.
name|sendRedirect
argument_list|(
name|response
operator|.
name|encodeURL
argument_list|(
literal|"export?q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
literal|"output=events.ics&type=person&ext="
operator|+
name|externalId
operator|+
operator|(
name|sid
operator|==
literal|null
condition|?
literal|""
else|:
literal|"&sid="
operator|+
name|sid
operator|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|null
return|;
block|}
comment|/*         if ("iCalendar".equals(myForm.getOp())) {             sLog.info("  Generating calendar for "+(instructor!=null?instructor.getName(DepartmentalInstructor.sNameFormatShort):student.getName(DepartmentalInstructor.sNameFormatShort)));             try {                 File file = ApplicationProperties.getTempFile("schedule", "ics");                                  if (instructor!=null) {                     printInstructorSchedule(file, instructor, instructorExams);                 } else {                     printStudentSchedule(file, student, studentExams);                 }                                  request.setAttribute(Constants.REQUEST_OPEN_URL, "temp/"+file.getName());             } catch (Exception e) {                 sLog.error("Unable to generate calendar for "+(instructor!=null?instructor.getName(DepartmentalInstructor.sNameFormatShort):student.getName(DepartmentalInstructor.sNameFormatShort)),e);             }         }         */
if|if
condition|(
operator|!
name|studentExams
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|myForm
operator|.
name|setCanExport
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
init|=
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamOwner
name|examOwner
range|:
name|studentExams
control|)
name|exams
operator|.
name|add
argument_list|(
operator|new
name|ExamAssignmentInfo
argument_list|(
name|examOwner
argument_list|,
name|student
argument_list|,
name|studentExams
argument_list|)
argument_list|)
expr_stmt|;
name|PdfWebTable
name|table
init|=
name|getStudentExamSchedule
argument_list|(
literal|true
argument_list|,
name|exams
argument_list|,
name|student
argument_list|)
decl_stmt|;
name|request
operator|.
name|setAttribute
argument_list|(
literal|"schedule"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|=
name|getStudentConflits
argument_list|(
literal|true
argument_list|,
name|exams
argument_list|,
name|student
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|table
operator|.
name|getLines
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|request
operator|.
name|setAttribute
argument_list|(
literal|"conf"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o3"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|instructorExams
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|myForm
operator|.
name|setCanExport
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
init|=
operator|new
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|Exam
name|exam
range|:
name|instructorExams
control|)
name|exams
operator|.
name|add
argument_list|(
operator|new
name|ExamAssignmentInfo
argument_list|(
name|exam
argument_list|,
name|useCache
argument_list|)
argument_list|)
expr_stmt|;
name|PdfWebTable
name|table
init|=
name|getInstructorExamSchedule
argument_list|(
literal|true
argument_list|,
name|exams
argument_list|,
name|instructor
argument_list|)
decl_stmt|;
name|request
operator|.
name|setAttribute
argument_list|(
literal|"ischedule"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o2"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|=
name|getInstructorConflits
argument_list|(
literal|true
argument_list|,
name|exams
argument_list|,
name|instructor
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|table
operator|.
name|getLines
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|request
operator|.
name|setAttribute
argument_list|(
literal|"iconf"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|=
name|getStudentConflits
argument_list|(
literal|true
argument_list|,
name|exams
argument_list|,
name|instructor
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|table
operator|.
name|getLines
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|request
operator|.
name|setAttribute
argument_list|(
literal|"sconf"
argument_list|,
name|table
operator|.
name|printTable
argument_list|(
name|WebTable
operator|.
name|getOrder
argument_list|(
name|sessionContext
argument_list|,
literal|"exams.o5"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|long
name|t1
init|=
name|System
operator|.
name|currentTimeMillis
argument_list|()
decl_stmt|;
name|sLog
operator|.
name|info
argument_list|(
literal|"Request processed in "
operator|+
operator|new
name|DecimalFormat
argument_list|(
literal|"0.00"
argument_list|)
operator|.
name|format
argument_list|(
operator|(
operator|(
name|double
operator|)
operator|(
name|t1
operator|-
name|t0
operator|)
operator|)
operator|/
literal|1000.0
argument_list|)
operator|+
literal|" s for "
operator|+
operator|(
name|instructor
operator|!=
literal|null
condition|?
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
else|:
name|student
operator|!=
literal|null
condition|?
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatShort
argument_list|)
else|:
name|userName
operator|)
argument_list|)
expr_stmt|;
return|return
name|mapping
operator|.
name|findForward
argument_list|(
literal|"show"
argument_list|)
return|;
block|}
specifier|public
specifier|static
name|boolean
name|canDisplay
parameter_list|(
name|Session
name|session
parameter_list|)
block|{
if|if
condition|(
name|session
operator|.
name|getStatusType
argument_list|()
operator|==
literal|null
condition|)
return|return
literal|false
return|;
if|if
condition|(
name|session
operator|.
name|canNoRoleReportExamFinal
argument_list|()
condition|)
return|return
literal|true
return|;
if|if
condition|(
name|session
operator|.
name|canNoRoleReportExamMidterm
argument_list|()
condition|)
return|return
literal|true
return|;
if|if
condition|(
name|session
operator|.
name|canNoRoleReportClass
argument_list|()
condition|)
return|return
literal|true
return|;
return|return
literal|false
return|;
block|}
specifier|public
name|int
name|getDaysCode
parameter_list|(
name|Set
name|meetings
parameter_list|)
block|{
name|int
name|daysCode
init|=
literal|0
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
name|meetings
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Meeting
name|meeting
init|=
operator|(
name|Meeting
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|Calendar
name|date
init|=
name|Calendar
operator|.
name|getInstance
argument_list|(
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
name|date
operator|.
name|setTime
argument_list|(
name|meeting
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|date
operator|.
name|get
argument_list|(
name|Calendar
operator|.
name|DAY_OF_WEEK
argument_list|)
condition|)
block|{
case|case
name|Calendar
operator|.
name|MONDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_MON
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|TUESDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_TUE
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|WEDNESDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_WED
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|THURSDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_THU
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|FRIDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_FRI
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|SATURDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SAT
index|]
expr_stmt|;
break|break;
case|case
name|Calendar
operator|.
name|SUNDAY
case|:
name|daysCode
operator||=
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SUN
index|]
expr_stmt|;
break|break;
block|}
block|}
return|return
name|daysCode
return|;
block|}
specifier|public
specifier|static
name|String
name|DAY_NAMES_SHORT
index|[]
init|=
operator|new
name|String
index|[]
block|{
literal|"M"
block|,
literal|"T"
block|,
literal|"W"
block|,
literal|"R"
block|,
literal|"F"
block|,
literal|"S"
block|,
literal|"U"
block|}
decl_stmt|;
specifier|protected
name|long
name|getMeetingComparable
parameter_list|(
name|ExamSectionInfo
name|section
parameter_list|)
block|{
if|if
condition|(
name|section
operator|.
name|getOwner
argument_list|()
operator|.
name|getOwnerObject
argument_list|()
operator|instanceof
name|Class_
condition|)
block|{
name|Class_
name|clazz
init|=
operator|(
name|Class_
operator|)
name|section
operator|.
name|getOwner
argument_list|()
operator|.
name|getOwnerObject
argument_list|()
decl_stmt|;
name|Assignment
name|assignment
init|=
name|clazz
operator|.
name|getCommittedAssignment
argument_list|()
decl_stmt|;
name|TreeSet
name|meetings
init|=
operator|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
argument_list|)
operator|)
decl_stmt|;
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
return|return
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
operator|.
name|getTime
argument_list|()
return|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
condition|)
block|{
return|return
name|assignment
operator|.
name|getTimeLocation
argument_list|()
operator|.
name|getStartSlot
argument_list|()
return|;
block|}
block|}
return|return
operator|-
literal|1
return|;
block|}
specifier|protected
name|String
name|getMeetingTime
parameter_list|(
name|ExamSectionInfo
name|section
parameter_list|)
block|{
name|String
name|meetingTime
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|section
operator|.
name|getOwner
argument_list|()
operator|.
name|getOwnerObject
argument_list|()
operator|instanceof
name|Class_
condition|)
block|{
name|Formats
operator|.
name|Format
argument_list|<
name|Date
argument_list|>
name|dpf
init|=
name|Formats
operator|.
name|getDateFormat
argument_list|(
name|Formats
operator|.
name|Pattern
operator|.
name|DATE_EVENT_SHORT
argument_list|)
decl_stmt|;
name|Class_
name|clazz
init|=
operator|(
name|Class_
operator|)
name|section
operator|.
name|getOwner
argument_list|()
operator|.
name|getOwnerObject
argument_list|()
decl_stmt|;
name|Assignment
name|assignment
init|=
name|clazz
operator|.
name|getCommittedAssignment
argument_list|()
decl_stmt|;
name|TreeSet
name|meetings
init|=
operator|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
argument_list|)
operator|)
decl_stmt|;
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|Date
name|first
init|=
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
decl_stmt|;
name|Date
name|last
init|=
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|last
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
decl_stmt|;
name|meetingTime
operator|+=
name|dpf
operator|.
name|format
argument_list|(
name|first
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|last
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
operator|&&
name|assignment
operator|.
name|getDatePattern
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|DatePattern
name|dp
init|=
name|assignment
operator|.
name|getDatePattern
argument_list|()
decl_stmt|;
if|if
condition|(
name|dp
operator|!=
literal|null
operator|&&
operator|!
name|dp
operator|.
name|isDefault
argument_list|()
condition|)
block|{
if|if
condition|(
name|dp
operator|.
name|getType
argument_list|()
operator|.
name|intValue
argument_list|()
operator|==
name|DatePattern
operator|.
name|sTypeAlternate
condition|)
name|meetingTime
operator|+=
name|dp
operator|.
name|getName
argument_list|()
expr_stmt|;
else|else
block|{
name|meetingTime
operator|+=
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getStartDate
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getEndDate
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|int
name|dayCode
init|=
name|getDaysCode
argument_list|(
name|meetings
argument_list|)
decl_stmt|;
name|String
name|days
init|=
literal|""
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|Constants
operator|.
name|DAY_CODES
operator|.
name|length
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|i
index|]
operator|)
operator|!=
literal|0
condition|)
name|days
operator|+=
name|CONSTANTS
operator|.
name|shortDays
argument_list|()
index|[
name|i
index|]
expr_stmt|;
name|meetingTime
operator|+=
literal|" "
operator|+
name|days
expr_stmt|;
name|Meeting
name|first
init|=
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
decl_stmt|;
name|meetingTime
operator|+=
literal|" "
operator|+
name|first
operator|.
name|startTime
argument_list|()
operator|+
literal|" - "
operator|+
name|first
operator|.
name|stopTime
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
condition|)
block|{
name|TimeLocation
name|t
init|=
name|assignment
operator|.
name|getTimeLocation
argument_list|()
decl_stmt|;
name|meetingTime
operator|+=
literal|" "
operator|+
name|t
operator|.
name|getDayHeader
argument_list|()
operator|+
literal|" "
operator|+
name|t
operator|.
name|getStartTimeHeader
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|t
operator|.
name|getEndTimeHeader
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|meetingTime
return|;
block|}
specifier|public
name|PdfWebTable
name|getSessions
parameter_list|(
name|boolean
name|html
parameter_list|,
name|HashSet
argument_list|<
name|Session
argument_list|>
name|sessions
parameter_list|,
name|String
name|name
parameter_list|,
name|Long
name|sessionId
parameter_list|)
block|{
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|5
argument_list|,
literal|"Available Academic Sessions for "
operator|+
name|name
argument_list|,
literal|"personalSchedule.do?o0=%%"
operator|+
operator|(
name|sessionId
operator|==
literal|null
condition|?
literal|""
else|:
literal|"&sessionId="
operator|+
name|sessionId
operator|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Term"
block|,
literal|"Year"
block|,
literal|"Campus"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
for|for
control|(
name|Session
name|session
range|:
name|sessions
control|)
block|{
name|String
name|bgColor
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|sessionId
operator|.
name|equals
argument_list|(
name|session
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
name|bgColor
operator|=
literal|"rgb(168,187,225)"
expr_stmt|;
name|table
operator|.
name|addLine
argument_list|(
literal|"onClick=\"personalizedExamReportForm.sessionId.value='"
operator|+
name|session
operator|.
name|getUniqueId
argument_list|()
operator|+
literal|"'; personalizedExamReportForm.submit();\""
argument_list|,
operator|new
name|String
index|[]
block|{
name|session
operator|.
name|getAcademicTerm
argument_list|()
block|,
name|session
operator|.
name|getAcademicYear
argument_list|()
block|,
name|session
operator|.
name|getAcademicInitiative
argument_list|()
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
name|session
operator|.
name|getSessionBeginDateTime
argument_list|()
argument_list|,
name|session
operator|.
name|getAcademicInitiative
argument_list|()
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|session
operator|.
name|getSessionBeginDateTime
argument_list|()
argument_list|,
name|session
operator|.
name|getAcademicInitiative
argument_list|()
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|session
operator|.
name|getAcademicInitiative
argument_list|()
argument_list|,
name|session
operator|.
name|getSessionBeginDateTime
argument_list|()
argument_list|)
block|}
argument_list|)
operator|.
name|setBgColor
argument_list|(
name|bgColor
argument_list|)
expr_stmt|;
block|}
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getStudentExamSchedule
parameter_list|(
name|boolean
name|html
parameter_list|,
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
parameter_list|,
name|Student
name|student
parameter_list|)
block|{
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|5
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Examination Schedule for "
operator|+
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o1=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|student
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Class / Course"
block|,
literal|"Meeting Time"
block|,
literal|"Date"
block|,
literal|"Time"
block|,
literal|"Room"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|String
name|noRoom
init|=
name|ApplicationProperty
operator|.
name|ExaminationsNoRoomText
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamAssignmentInfo
name|exam
range|:
name|exams
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|getPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|sectionName
init|=
name|section
operator|.
name|getName
argument_list|()
decl_stmt|;
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|sectionName
block|,
name|getMeetingTime
argument_list|(
name|section
argument_list|)
block|,
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
block|,
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
block|,
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|html
condition|?
name|exam
operator|.
name|getRoomsNameWithHint
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|sectionName
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|getMeetingComparable
argument_list|(
name|section
argument_list|)
argument_list|,
name|sectionName
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|sectionName
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|==
literal|null
condition|?
operator|-
literal|1
else|:
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|sectionName
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|sectionName
argument_list|,
name|exam
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
block|}
name|table
operator|.
name|setWebTableTweakStyle
argument_list|(
operator|new
name|WebTableTweakStyle
argument_list|()
block|{
specifier|public
name|String
name|getStyleHtml
parameter_list|(
name|WebTableLine
name|current
parameter_list|,
name|WebTableLine
name|next
parameter_list|,
name|int
name|order
parameter_list|)
block|{
if|if
condition|(
name|next
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|MultiComparable
operator|)
name|current
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
operator|.
name|compareTo
argument_list|(
operator|(
operator|(
name|MultiComparable
operator|)
name|next
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
argument_list|)
operator|!=
literal|0
condition|)
return|return
literal|"border-bottom: rgb(81,81,81) 1px dashed"
return|;
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getStudentConflits
parameter_list|(
name|boolean
name|html
parameter_list|,
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
parameter_list|,
name|Student
name|student
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|boolean
name|showBackToBack
init|=
name|ApplicationProperty
operator|.
name|ExaminationReportsStudentBackToBacks
operator|.
name|isTrue
argument_list|()
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|6
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Examination Conflicts"
operator|+
operator|(
name|showBackToBack
condition|?
literal|" and/or Back-To-Back Examinations"
else|:
literal|""
operator|)
operator|+
literal|" for "
operator|+
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o3=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|student
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Type"
block|,
literal|"Class / Course"
block|,
literal|"Date"
block|,
literal|"Time"
block|,
literal|"Room"
block|,
literal|"Distance"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|String
name|noRoom
init|=
name|ApplicationProperty
operator|.
name|ExaminationsNoRoomText
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamAssignmentInfo
name|exam
range|:
name|exams
control|)
block|{
for|for
control|(
name|DirectConflict
name|conflict
range|:
name|exam
operator|.
name|getDirectConflicts
argument_list|()
control|)
block|{
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
operator|&&
name|exam
operator|.
name|compareTo
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
operator|!
name|conflict
operator|.
name|getStudents
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|html
condition|?
name|exam
operator|.
name|getRoomsNameWithHint
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|firstSection
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|room
operator|+=
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|conflict
operator|.
name|getOtherEventId
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
name|classes
operator|+=
name|conflict
operator|.
name|getOtherEventName
argument_list|()
expr_stmt|;
name|room
operator|+=
name|conflict
operator|.
name|getOtherEventRoom
argument_list|()
expr_stmt|;
comment|//date += conflict.getOtherEventDate();
name|time
operator|+=
name|conflict
operator|.
name|getOtherEventTime
argument_list|()
expr_stmt|;
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"P"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
operator|(
name|conflict
operator|.
name|getOtherEventId
argument_list|()
operator|!=
literal|null
condition|?
name|conflict
operator|.
name|isOtherClass
argument_list|()
condition|?
literal|"Class"
else|:
literal|"Event"
else|:
literal|"Direct"
operator|)
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|date
block|,
name|time
block|,
name|room
block|,
literal|""
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
literal|1.0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|showBackToBack
condition|)
for|for
control|(
name|BackToBackConflict
name|conflict
range|:
name|exam
operator|.
name|getBackToBackConflicts
argument_list|()
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|compareTo
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
operator|!
name|conflict
operator|.
name|getStudents
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
empty_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|firstSection
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|time
operator|+=
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"1"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
literal|"Back-To-Back"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|date
block|,
name|time
block|,
name|room
block|,
operator|(
name|int
operator|)
operator|(
name|conflict
operator|.
name|getDistance
argument_list|()
operator|*
literal|10.0
operator|)
operator|+
literal|" m"
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|2
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|conflict
operator|.
name|getDistance
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
name|conflicts
label|:
for|for
control|(
name|MoreThanTwoADayConflict
name|conflict
range|:
name|exam
operator|.
name|getMoreThanTwoADaysConflicts
argument_list|()
control|)
block|{
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
if|if
condition|(
name|exam
operator|.
name|compareTo
argument_list|(
name|other
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|other
argument_list|)
condition|)
continue|continue
name|conflicts
continue|;
if|if
condition|(
operator|!
name|conflict
operator|.
name|getStudents
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
block|{
name|firstSection
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|other
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|time
operator|+=
name|other
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|other
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|other
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|exam
argument_list|,
name|Right
operator|.
name|ExaminationDetail
argument_list|)
condition|?
literal|"onClick=\"document.location='examDetail.do?examId="
operator|+
name|exam
operator|.
name|getExamId
argument_list|()
operator|+
literal|"';\""
else|:
literal|""
operator|)
argument_list|,
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"2"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
operator|(
name|html
condition|?
literal|"&gt;"
else|:
literal|""
operator|)
operator|+
literal|"2 A Day"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|date
block|,
name|time
block|,
name|room
block|,
literal|""
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|1
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
literal|1.0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|,
name|exam
operator|.
name|getExamId
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
name|table
operator|.
name|setWebTableTweakStyle
argument_list|(
operator|new
name|WebTableTweakStyle
argument_list|()
block|{
specifier|public
name|String
name|getStyleHtml
parameter_list|(
name|WebTableLine
name|current
parameter_list|,
name|WebTableLine
name|next
parameter_list|,
name|int
name|order
parameter_list|)
block|{
if|if
condition|(
name|next
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|MultiComparable
operator|)
name|current
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
operator|.
name|compareTo
argument_list|(
operator|(
operator|(
name|MultiComparable
operator|)
name|next
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
argument_list|)
operator|!=
literal|0
condition|)
return|return
literal|"border-bottom: rgb(81,81,81) 1px dashed"
return|;
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getInstructorExamSchedule
parameter_list|(
name|boolean
name|html
parameter_list|,
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
parameter_list|,
name|DepartmentalInstructor
name|instructor
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|8
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Examination Instructor Schedule for "
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o2=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|instructor
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Class / Course"
block|,
literal|"Enrollment"
block|,
literal|"Seating"
operator|+
name|nl
operator|+
literal|"Type"
block|,
literal|"Meeting Times"
block|,
literal|"Date"
block|,
literal|"Time"
block|,
literal|"Room"
block|,
literal|"Capacity"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"right"
block|,
literal|"center"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"right"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|String
name|noRoom
init|=
name|ApplicationProperty
operator|.
name|ExaminationsNoRoomText
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamAssignmentInfo
name|exam
range|:
name|exams
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|getPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|section
operator|.
name|getName
argument_list|()
block|,
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
block|,
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
block|,
name|getMeetingTime
argument_list|(
name|section
argument_list|)
block|,
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
block|,
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
block|,
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
block|,
name|exam
operator|.
name|getRoomsCapacity
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|exam
operator|.
name|getNrStudents
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getSeatingType
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|getMeetingComparable
argument_list|(
name|section
argument_list|)
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|==
literal|null
condition|?
operator|-
literal|1
else|:
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|exam
operator|.
name|getRoomsCapacity
argument_list|()
argument_list|,
name|section
operator|.
name|getName
argument_list|()
argument_list|,
name|exam
argument_list|)
block|,                         }
argument_list|)
expr_stmt|;
block|}
block|}
name|table
operator|.
name|setWebTableTweakStyle
argument_list|(
operator|new
name|WebTableTweakStyle
argument_list|()
block|{
specifier|public
name|String
name|getStyleHtml
parameter_list|(
name|WebTableLine
name|current
parameter_list|,
name|WebTableLine
name|next
parameter_list|,
name|int
name|order
parameter_list|)
block|{
if|if
condition|(
name|next
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|MultiComparable
operator|)
name|current
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
operator|.
name|compareTo
argument_list|(
operator|(
operator|(
name|MultiComparable
operator|)
name|next
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
argument_list|)
operator|!=
literal|0
condition|)
return|return
literal|"border-bottom: rgb(81,81,81) 1px dashed"
return|;
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getInstructorConflits
parameter_list|(
name|boolean
name|html
parameter_list|,
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
parameter_list|,
name|DepartmentalInstructor
name|instructor
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|boolean
name|showBackToBack
init|=
name|ApplicationProperty
operator|.
name|ExaminationReportsInstructorBackToBacks
operator|.
name|isTrue
argument_list|()
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|8
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Examination Instructor Conflicts"
operator|+
operator|(
name|showBackToBack
condition|?
literal|" and/or Back-To-Back Examinations"
else|:
literal|""
operator|)
operator|+
literal|" for "
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o4=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|instructor
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Type"
block|,
literal|"Class / Course"
block|,
literal|"Enrollment"
block|,
literal|"Seating"
operator|+
name|nl
operator|+
literal|"Type"
block|,
literal|"Date"
block|,
literal|"Time"
block|,
literal|"Room"
block|,
literal|"Distance"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"right"
block|,
literal|"center"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|String
name|noRoom
init|=
name|ApplicationProperty
operator|.
name|ExaminationsNoRoomText
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|ExamAssignmentInfo
name|exam
range|:
name|exams
control|)
block|{
for|for
control|(
name|DirectConflict
name|conflict
range|:
name|exam
operator|.
name|getInstructorDirectConflicts
argument_list|()
control|)
block|{
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
operator|&&
name|exam
operator|.
name|compareTo
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|enrollment
init|=
literal|""
decl_stmt|,
name|seating
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|firstSection
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|room
operator|+=
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|conflict
operator|.
name|getOtherExam
argument_list|()
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|conflict
operator|.
name|getOtherEventId
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
name|classes
operator|+=
name|conflict
operator|.
name|getOtherEventName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|conflict
operator|.
name|getOtherEventSize
argument_list|()
expr_stmt|;
name|seating
operator|+=
name|conflict
operator|.
name|isOtherClass
argument_list|()
condition|?
literal|"Class"
else|:
literal|"Event"
expr_stmt|;
name|room
operator|+=
name|conflict
operator|.
name|getOtherEventRoom
argument_list|()
expr_stmt|;
comment|//date += conflict.getOtherEventDate();
name|time
operator|+=
name|conflict
operator|.
name|getOtherEventTime
argument_list|()
expr_stmt|;
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"P"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
operator|(
name|conflict
operator|.
name|getOtherEventId
argument_list|()
operator|!=
literal|null
condition|?
name|conflict
operator|.
name|isOtherClass
argument_list|()
condition|?
literal|"Class"
else|:
literal|"Event"
else|:
literal|"Direct"
operator|)
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|enrollment
block|,
name|seating
block|,
name|date
block|,
name|time
block|,
name|room
block|,
literal|""
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|exam
operator|.
name|getNrStudents
argument_list|()
operator|-
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrStudents
argument_list|()
operator|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getExamTypeLabel
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
literal|1.0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|showBackToBack
condition|)
for|for
control|(
name|BackToBackConflict
name|conflict
range|:
name|exam
operator|.
name|getInstructorBackToBackConflicts
argument_list|()
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|compareTo
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
condition|)
continue|continue;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|enrollment
init|=
literal|""
decl_stmt|,
name|seating
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|firstSection
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|time
operator|+=
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|conflict
operator|.
name|getOtherExam
argument_list|()
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"1"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
literal|"Back-To-Back"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|enrollment
block|,
name|seating
block|,
name|date
block|,
name|time
block|,
name|room
block|,
operator|(
name|int
operator|)
operator|(
name|conflict
operator|.
name|getDistance
argument_list|()
operator|*
literal|10.0
operator|)
operator|+
literal|" m"
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|2
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|exam
operator|.
name|getNrStudents
argument_list|()
operator|-
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrStudents
argument_list|()
operator|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getExamTypeLabel
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|conflict
operator|.
name|getDistance
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
name|conflicts
label|:
for|for
control|(
name|MoreThanTwoADayConflict
name|conflict
range|:
name|exam
operator|.
name|getInstructorMoreThanTwoADaysConflicts
argument_list|()
control|)
block|{
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
if|if
condition|(
name|exam
operator|.
name|compareTo
argument_list|(
name|other
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|other
argument_list|)
condition|)
continue|continue
name|conflicts
continue|;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|enrollment
init|=
literal|""
decl_stmt|,
name|seating
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|int
name|nrStudents
init|=
name|exam
operator|.
name|getNrStudents
argument_list|()
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
block|{
name|firstSection
operator|=
literal|true
expr_stmt|;
name|nrStudents
operator|+=
name|other
operator|.
name|getNrStudents
argument_list|()
expr_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|other
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|time
operator|+=
name|other
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|other
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|other
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|(
name|sessionContext
operator|.
name|hasPermission
argument_list|(
name|exam
argument_list|,
name|Right
operator|.
name|ExaminationDetail
argument_list|)
condition|?
literal|"onClick=\"document.location='examDetail.do?examId="
operator|+
name|exam
operator|.
name|getExamId
argument_list|()
operator|+
literal|"';\""
else|:
literal|""
operator|)
argument_list|,
operator|new
name|String
index|[]
block|{
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"2"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
operator|(
name|html
condition|?
literal|"&gt;"
else|:
literal|""
operator|)
operator|+
literal|"2 A Day"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|enrollment
block|,
name|seating
block|,
name|date
block|,
name|time
block|,
name|room
block|,
literal|""
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|1
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|nrStudents
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getExamTypeLabel
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
literal|1.0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|,
name|exam
operator|.
name|getExamId
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
name|table
operator|.
name|setWebTableTweakStyle
argument_list|(
operator|new
name|WebTableTweakStyle
argument_list|()
block|{
specifier|public
name|String
name|getStyleHtml
parameter_list|(
name|WebTableLine
name|current
parameter_list|,
name|WebTableLine
name|next
parameter_list|,
name|int
name|order
parameter_list|)
block|{
if|if
condition|(
name|next
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|MultiComparable
operator|)
name|current
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
operator|.
name|compareTo
argument_list|(
operator|(
operator|(
name|MultiComparable
operator|)
name|next
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
argument_list|)
operator|!=
literal|0
condition|)
return|return
literal|"border-bottom: rgb(81,81,81) 1px dashed"
return|;
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getStudentConflits
parameter_list|(
name|boolean
name|html
parameter_list|,
name|TreeSet
argument_list|<
name|ExamAssignmentInfo
argument_list|>
name|exams
parameter_list|,
name|DepartmentalInstructor
name|instructor
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|8
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Examination Conflicts for "
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o5=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|instructor
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Name"
block|,
literal|"Type"
block|,
literal|"Class / Course"
block|,
literal|"Enrollment"
block|,
literal|"Seating"
operator|+
name|nl
operator|+
literal|"Type"
block|,
literal|"Date"
block|,
literal|"Time"
block|,
literal|"Room"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"right"
block|,
literal|"center"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|String
name|noRoom
init|=
name|ApplicationProperty
operator|.
name|ExaminationsNoRoomText
operator|.
name|value
argument_list|()
decl_stmt|;
name|table
operator|.
name|setBlankWhenSame
argument_list|(
literal|true
argument_list|)
expr_stmt|;
for|for
control|(
name|ExamAssignmentInfo
name|exam
range|:
name|exams
control|)
block|{
for|for
control|(
name|DirectConflict
name|conflict
range|:
name|exam
operator|.
name|getDirectConflicts
argument_list|()
control|)
block|{
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
operator|&&
name|exam
operator|.
name|compareTo
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
argument_list|)
condition|)
continue|continue;
for|for
control|(
name|Long
name|studentId
range|:
name|conflict
operator|.
name|getStudents
argument_list|()
control|)
block|{
name|Student
name|student
init|=
operator|new
name|StudentDAO
argument_list|()
operator|.
name|get
argument_list|(
name|studentId
argument_list|)
decl_stmt|;
name|String
name|id
init|=
name|student
operator|.
name|getExternalUniqueId
argument_list|()
decl_stmt|;
name|String
name|name
init|=
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
decl_stmt|;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|enrollment
init|=
literal|""
decl_stmt|,
name|seating
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|studentId
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
name|firstSection
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|studentId
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|room
operator|+=
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|conflict
operator|.
name|getOtherEventId
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
name|classes
operator|+=
name|conflict
operator|.
name|getOtherEventName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|conflict
operator|.
name|getOtherEventSize
argument_list|()
expr_stmt|;
name|seating
operator|+=
name|conflict
operator|.
name|isOtherClass
argument_list|()
condition|?
literal|"Class"
else|:
literal|"Event"
expr_stmt|;
name|room
operator|+=
name|conflict
operator|.
name|getOtherEventRoom
argument_list|()
expr_stmt|;
comment|//date += conflict.getOtherEventDate();
name|time
operator|+=
name|conflict
operator|.
name|getOtherEventTime
argument_list|()
expr_stmt|;
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|name
block|,
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"P"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
literal|"Direct"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|enrollment
block|,
name|seating
block|,
name|date
block|,
name|time
block|,
name|room
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|name
argument_list|,
name|id
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|0
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|exam
operator|.
name|getNrStudents
argument_list|()
operator|-
operator|(
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|conflict
operator|.
name|getOtherExam
argument_list|()
operator|.
name|getNrStudents
argument_list|()
operator|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getExamTypeLabel
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|(
name|exam
operator|.
name|getPeriod
argument_list|()
operator|==
literal|null
condition|?
operator|-
literal|1
else|:
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
operator|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
block|}
comment|/*             for (BackToBackConflict conflict : exam.getBackToBackConflicts()) {                 if (exam.compareTo(conflict.getOtherExam())>=0&& exams.contains(conflict.getOtherExam())) continue;                 for (Long studentId : conflict.getStudents()) {                     Student student = new StudentDAO().get(studentId);                     String id = student.getExternalUniqueId();                     String name = student.getName(DepartmentalInstructor.sNameFormatLastFist);                     String classes = "", enrollment = "", seating = "", date = "", time = "", room = "", distance = "", blank="";                     boolean firstSection = true;                     for (ExamSectionInfo section : exam.getSectionsIncludeCrosslistedDummies()) {                         if (!section.getStudentIds().contains(studentId)) continue;                         if (classes.length()>0) {                             blank+=nl; classes += nl; enrollment += nl; seating += nl; date += nl; time += nl; room += nl; distance += nl;                         }                         classes += section.getName();                         enrollment += String.valueOf(section.getNrStudents());                         if (firstSection) {                             seating += Exam.sSeatingTypes[exam.getSeatingType()];                             date += exam.getDate(false);                             time += exam.getTime(false);                             room += (exam.getNrRooms()==0?noRoom:exam.getRoomsName(false,", "));                         }                         firstSection = false;                     }                     firstSection = true;                     for (ExamSectionInfo section : conflict.getOtherExam().getSectionsIncludeCrosslistedDummies()) {                         if (!section.getStudentIds().contains(studentId)) continue;                         if (classes.length()>0) {                             blank+=nl; classes += nl; enrollment += nl; seating += nl; date += nl; time += nl; room += nl; distance += nl;                         }                         classes += section.getName();                         enrollment += String.valueOf(section.getNrStudents());                         if (firstSection) {                             seating += Exam.sSeatingTypes[exam.getSeatingType()];                             time += conflict.getOtherExam().getTime(false);                             room += (conflict.getOtherExam().getNrRooms()==0?noRoom:conflict.getOtherExam().getRoomsName(false,", "));                         }                         firstSection = false;                     }                     table.addLine(                             new String[] {                                 name,                                 (html?"<font color='"+PreferenceLevel.prolog2color("1")+"'>":"")+"Back-To-Back"+(html?"</font>":""),                                 classes,                                 enrollment,                                 seating,                                 date,                                 time,                                 room                             }, new Comparable[] {                                 new MultiComparable(-exam.getExamType(), name, id, exam, 0),                                 new MultiComparable(-exam.getExamType(), 2, exam, 0),                                 new MultiComparable(-exam.getExamType(), exam, exam, 0),                                 new MultiComparable(-exam.getExamType(), -exam.getNrStudents()-conflict.getOtherExam().getNrStudents(), exam, 0),                                 new MultiComparable(-exam.getExamType(), exam.getExamType(), exam, 0),                                 new MultiComparable(-exam.getExamType(), exam.getPeriodOrd(), exam, 0),                                 new MultiComparable(-exam.getExamType(), exam.getPeriod().getStartSlot(), exam, 0),                                 new MultiComparable(-exam.getExamType(), exam.getRoomsName(":"), exam, 0)                             });                 }             }             */
name|conflicts
label|:
for|for
control|(
name|MoreThanTwoADayConflict
name|conflict
range|:
name|exam
operator|.
name|getMoreThanTwoADaysConflicts
argument_list|()
control|)
block|{
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
if|if
condition|(
name|exam
operator|.
name|compareTo
argument_list|(
name|other
argument_list|)
operator|>=
literal|0
operator|&&
name|exams
operator|.
name|contains
argument_list|(
name|other
argument_list|)
condition|)
continue|continue
name|conflicts
continue|;
for|for
control|(
name|Long
name|studentId
range|:
name|conflict
operator|.
name|getStudents
argument_list|()
control|)
block|{
name|Student
name|student
init|=
operator|new
name|StudentDAO
argument_list|()
operator|.
name|get
argument_list|(
name|studentId
argument_list|)
decl_stmt|;
name|String
name|id
init|=
name|student
operator|.
name|getExternalUniqueId
argument_list|()
decl_stmt|;
name|String
name|name
init|=
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
decl_stmt|;
name|String
name|classes
init|=
literal|""
decl_stmt|,
name|enrollment
init|=
literal|""
decl_stmt|,
name|seating
init|=
literal|""
decl_stmt|,
name|date
init|=
literal|""
decl_stmt|,
name|time
init|=
literal|""
decl_stmt|,
name|room
init|=
literal|""
decl_stmt|;
name|int
name|nrStudents
init|=
name|exam
operator|.
name|getNrStudents
argument_list|()
decl_stmt|;
name|boolean
name|firstSection
init|=
literal|true
decl_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|exam
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|studentId
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|date
operator|+=
name|exam
operator|.
name|getDate
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|time
operator|+=
name|exam
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|exam
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
for|for
control|(
name|ExamAssignment
name|other
range|:
name|conflict
operator|.
name|getOtherExams
argument_list|()
control|)
block|{
name|firstSection
operator|=
literal|true
expr_stmt|;
name|nrStudents
operator|+=
name|other
operator|.
name|getNrStudents
argument_list|()
expr_stmt|;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
name|other
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|studentId
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|classes
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|classes
operator|+=
name|nl
expr_stmt|;
name|enrollment
operator|+=
name|nl
expr_stmt|;
name|seating
operator|+=
name|nl
expr_stmt|;
name|date
operator|+=
name|nl
expr_stmt|;
name|time
operator|+=
name|nl
expr_stmt|;
name|room
operator|+=
name|nl
expr_stmt|;
block|}
name|classes
operator|+=
name|section
operator|.
name|getName
argument_list|()
expr_stmt|;
name|enrollment
operator|+=
name|String
operator|.
name|valueOf
argument_list|(
name|section
operator|.
name|getNrStudents
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstSection
condition|)
block|{
name|seating
operator|+=
name|Exam
operator|.
name|sSeatingTypes
index|[
name|exam
operator|.
name|getSeatingType
argument_list|()
index|]
expr_stmt|;
name|time
operator|+=
name|other
operator|.
name|getTime
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|room
operator|+=
operator|(
name|other
operator|.
name|getNrRooms
argument_list|()
operator|==
literal|0
condition|?
name|noRoom
else|:
name|other
operator|.
name|getRoomsName
argument_list|(
literal|false
argument_list|,
literal|", "
argument_list|)
operator|)
expr_stmt|;
block|}
name|firstSection
operator|=
literal|false
expr_stmt|;
block|}
block|}
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|name
block|,
operator|(
name|html
condition|?
literal|"<font color='"
operator|+
name|PreferenceLevel
operator|.
name|prolog2color
argument_list|(
literal|"2"
argument_list|)
operator|+
literal|"'>"
else|:
literal|""
operator|)
operator|+
operator|(
name|html
condition|?
literal|"&gt;"
else|:
literal|""
operator|)
operator|+
literal|"2 A Day"
operator|+
operator|(
name|html
condition|?
literal|"</font>"
else|:
literal|""
operator|)
block|,
name|classes
block|,
name|enrollment
block|,
name|seating
block|,
name|date
block|,
name|time
block|,
name|room
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|name
argument_list|,
name|id
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
literal|1
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
operator|-
name|nrStudents
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getExamTypeLabel
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriodOrd
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getPeriod
argument_list|()
operator|.
name|getStartSlot
argument_list|()
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getType
argument_list|()
argument_list|,
name|exam
operator|.
name|getRoomsName
argument_list|(
literal|":"
argument_list|)
argument_list|,
name|exam
argument_list|,
literal|0
argument_list|)
block|,                             }
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|table
operator|.
name|setWebTableTweakStyle
argument_list|(
operator|new
name|WebTableTweakStyle
argument_list|()
block|{
specifier|public
name|String
name|getStyleHtml
parameter_list|(
name|WebTableLine
name|current
parameter_list|,
name|WebTableLine
name|next
parameter_list|,
name|int
name|order
parameter_list|)
block|{
if|if
condition|(
name|next
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|MultiComparable
operator|)
name|current
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
operator|.
name|compareTo
argument_list|(
operator|(
operator|(
name|MultiComparable
operator|)
name|next
operator|.
name|getOrderBy
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getContent
argument_list|()
index|[
literal|0
index|]
argument_list|)
operator|!=
literal|0
condition|)
return|return
literal|"border-bottom: rgb(81,81,81) 1px solid"
return|;
return|return
literal|null
return|;
block|}
block|}
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
specifier|protected
name|String
name|getMeetingTime
parameter_list|(
name|Class_
name|clazz
parameter_list|)
block|{
name|String
name|meetingTime
init|=
literal|""
decl_stmt|;
name|Formats
operator|.
name|Format
argument_list|<
name|Date
argument_list|>
name|dpf
init|=
name|Formats
operator|.
name|getDateFormat
argument_list|(
name|Formats
operator|.
name|Pattern
operator|.
name|DATE_EVENT_SHORT
argument_list|)
decl_stmt|;
name|Assignment
name|assignment
init|=
name|clazz
operator|.
name|getCommittedAssignment
argument_list|()
decl_stmt|;
name|TreeSet
name|meetings
init|=
operator|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|DatePattern
name|dp
init|=
operator|(
name|assignment
operator|==
literal|null
condition|?
literal|null
else|:
name|assignment
operator|.
name|getDatePattern
argument_list|()
operator|)
decl_stmt|;
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|int
name|dayCode
init|=
name|getDaysCode
argument_list|(
name|meetings
argument_list|)
decl_stmt|;
name|String
name|days
init|=
literal|""
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|Constants
operator|.
name|DAY_CODES
operator|.
name|length
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|i
index|]
operator|)
operator|!=
literal|0
condition|)
name|days
operator|+=
name|CONSTANTS
operator|.
name|shortDays
argument_list|()
index|[
name|i
index|]
expr_stmt|;
name|meetingTime
operator|+=
name|days
expr_stmt|;
name|Meeting
name|first
init|=
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
decl_stmt|;
name|meetingTime
operator|+=
literal|" "
operator|+
name|first
operator|.
name|startTime
argument_list|()
operator|+
literal|" - "
operator|+
name|first
operator|.
name|stopTime
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
condition|)
block|{
name|TimeLocation
name|t
init|=
name|assignment
operator|.
name|getTimeLocation
argument_list|()
decl_stmt|;
name|meetingTime
operator|+=
name|t
operator|.
name|getDayHeader
argument_list|()
operator|+
literal|" "
operator|+
name|t
operator|.
name|getStartTimeHeader
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|t
operator|.
name|getEndTimeHeader
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|meetingTime
operator|+=
literal|"Arr Hrs"
expr_stmt|;
block|}
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
if|if
condition|(
name|dp
operator|==
literal|null
operator|||
operator|!
name|dp
operator|.
name|isDefault
argument_list|()
condition|)
block|{
name|Date
name|first
init|=
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
decl_stmt|;
name|Date
name|last
init|=
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|last
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
decl_stmt|;
if|if
condition|(
name|dp
operator|!=
literal|null
operator|&&
name|dp
operator|.
name|getType
argument_list|()
operator|==
name|DatePattern
operator|.
name|sTypeAlternate
condition|)
name|meetingTime
operator|+=
literal|" ("
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|first
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|last
argument_list|)
operator|+
literal|" "
operator|+
name|dp
operator|.
name|getName
argument_list|()
operator|+
literal|")"
expr_stmt|;
else|else
name|meetingTime
operator|+=
literal|" ("
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|first
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|last
argument_list|)
operator|+
literal|")"
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|dp
operator|!=
literal|null
operator|&&
operator|!
name|dp
operator|.
name|isDefault
argument_list|()
condition|)
block|{
if|if
condition|(
name|dp
operator|.
name|getType
argument_list|()
operator|==
name|DatePattern
operator|.
name|sTypeAlternate
condition|)
name|meetingTime
operator|+=
literal|" ("
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getStartDate
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getEndDate
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|dp
operator|.
name|getName
argument_list|()
operator|+
literal|")"
expr_stmt|;
else|else
name|meetingTime
operator|+=
literal|" ("
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getStartDate
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|dpf
operator|.
name|format
argument_list|(
name|dp
operator|.
name|getEndDate
argument_list|()
argument_list|)
operator|+
literal|")"
expr_stmt|;
block|}
return|return
name|meetingTime
return|;
block|}
specifier|protected
name|String
name|getMeetingRooms
parameter_list|(
name|boolean
name|html
parameter_list|,
name|Class_
name|clazz
parameter_list|)
block|{
name|String
name|meetingRooms
init|=
literal|""
decl_stmt|;
name|Assignment
name|assignment
init|=
name|clazz
operator|.
name|getCommittedAssignment
argument_list|()
decl_stmt|;
name|TreeSet
argument_list|<
name|Meeting
argument_list|>
name|meetings
init|=
operator|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|TreeSet
argument_list|<
name|Location
argument_list|>
name|locations
init|=
operator|new
name|TreeSet
argument_list|<
name|Location
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|Meeting
name|meeting
range|:
name|meetings
control|)
if|if
condition|(
name|meeting
operator|.
name|getLocation
argument_list|()
operator|!=
literal|null
condition|)
name|locations
operator|.
name|add
argument_list|(
name|meeting
operator|.
name|getLocation
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
operator|&&
name|assignment
operator|.
name|getDatePattern
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|Iterator
name|i
init|=
name|assignment
operator|.
name|getRooms
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|locations
operator|.
name|add
argument_list|(
operator|(
name|Location
operator|)
name|i
operator|.
name|next
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
for|for
control|(
name|Location
name|location
range|:
name|locations
control|)
block|{
if|if
condition|(
name|meetingRooms
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
name|meetingRooms
operator|+=
literal|", "
expr_stmt|;
name|meetingRooms
operator|+=
operator|(
name|html
condition|?
name|location
operator|.
name|getLabelWithHint
argument_list|()
else|:
name|location
operator|.
name|getLabel
argument_list|()
operator|)
expr_stmt|;
block|}
return|return
name|meetingRooms
return|;
block|}
specifier|protected
name|long
name|getMeetingComparable
parameter_list|(
name|Class_
name|clazz
parameter_list|)
block|{
name|Assignment
name|assignment
init|=
name|clazz
operator|.
name|getCommittedAssignment
argument_list|()
decl_stmt|;
name|TreeSet
name|meetings
init|=
operator|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
argument_list|)
operator|)
decl_stmt|;
if|if
condition|(
name|meetings
operator|!=
literal|null
operator|&&
operator|!
name|meetings
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
return|return
operator|(
operator|(
name|Meeting
operator|)
name|meetings
operator|.
name|first
argument_list|()
operator|)
operator|.
name|getMeetingDate
argument_list|()
operator|.
name|getTime
argument_list|()
return|;
block|}
if|else if
condition|(
name|assignment
operator|!=
literal|null
condition|)
block|{
return|return
name|assignment
operator|.
name|getTimeLocation
argument_list|()
operator|.
name|getStartSlot
argument_list|()
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
specifier|protected
name|String
name|getMeetingInstructor
parameter_list|(
name|Class_
name|clazz
parameter_list|)
block|{
name|String
name|meetingInstructor
init|=
literal|""
decl_stmt|;
if|if
condition|(
operator|!
name|clazz
operator|.
name|isDisplayInstructor
argument_list|()
condition|)
return|return
name|meetingInstructor
return|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|TreeSet
argument_list|(
name|clazz
operator|.
name|getClassInstructors
argument_list|()
argument_list|)
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|ClassInstructor
name|ci
init|=
operator|(
name|ClassInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|meetingInstructor
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
name|meetingInstructor
operator|+=
literal|", "
expr_stmt|;
name|meetingInstructor
operator|+=
name|ci
operator|.
name|getInstructor
argument_list|()
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastInitial
argument_list|)
expr_stmt|;
block|}
return|return
name|meetingInstructor
return|;
block|}
specifier|public
name|PdfWebTable
name|getStudentClassSchedule
parameter_list|(
name|boolean
name|html
parameter_list|,
name|Student
name|student
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|6
argument_list|,
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Class Schedule for "
operator|+
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o6=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|student
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Course"
block|,
literal|"Instruction"
operator|+
name|nl
operator|+
literal|"Type"
block|,
literal|"Section"
block|,
literal|"Time"
block|,
literal|"Room"
block|,
literal|"Instructor"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|table
operator|.
name|setBlankWhenSame
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|boolean
name|suffix
init|=
name|ApplicationProperty
operator|.
name|ExaminationReportsClassSufix
operator|.
name|isTrue
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
name|student
operator|.
name|getClassEnrollments
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|StudentClassEnrollment
name|sce
init|=
operator|(
name|StudentClassEnrollment
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|String
name|course
init|=
name|sce
operator|.
name|getCourseOffering
argument_list|()
operator|.
name|getCourseName
argument_list|()
decl_stmt|;
name|String
name|itype
init|=
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getItypeDesc
argument_list|()
decl_stmt|;
name|int
name|itypeCmp
init|=
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getItype
argument_list|()
operator|.
name|getItype
argument_list|()
decl_stmt|;
name|String
name|section
init|=
operator|(
name|suffix
operator|&&
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getClassSuffix
argument_list|()
operator|!=
literal|null
condition|?
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getClassSuffix
argument_list|()
else|:
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getSectionNumberString
argument_list|()
operator|)
decl_stmt|;
name|String
name|time
init|=
name|getMeetingTime
argument_list|(
name|sce
operator|.
name|getClazz
argument_list|()
argument_list|)
decl_stmt|;
name|long
name|timeCmp
init|=
name|getMeetingComparable
argument_list|(
name|sce
operator|.
name|getClazz
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|room
init|=
name|getMeetingRooms
argument_list|(
name|html
argument_list|,
name|sce
operator|.
name|getClazz
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|instr
init|=
name|getMeetingInstructor
argument_list|(
name|sce
operator|.
name|getClazz
argument_list|()
argument_list|)
decl_stmt|;
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|course
block|,
name|itype
block|,
name|section
block|,
name|time
block|,
name|room
block|,
name|instr
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|instr
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|itypeCmp
argument_list|,
name|course
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|instr
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|section
argument_list|,
name|itypeCmp
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|instr
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|timeCmp
argument_list|,
name|room
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|instr
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|room
argument_list|,
name|timeCmp
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|instr
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|instr
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
return|return
name|table
return|;
block|}
specifier|public
name|PdfWebTable
name|getInstructorClassSchedule
parameter_list|(
name|boolean
name|html
parameter_list|,
name|DepartmentalInstructor
name|instructor
parameter_list|)
block|{
name|String
name|nl
init|=
operator|(
name|html
condition|?
literal|"<br>"
else|:
literal|"\n"
operator|)
decl_stmt|;
name|PdfWebTable
name|table
init|=
operator|new
name|PdfWebTable
argument_list|(
literal|6
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Class Schedule for "
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|,
literal|"personalSchedule.do?o7=%%&q="
operator|+
name|QueryEncoderBackend
operator|.
name|encode
argument_list|(
name|instructor
operator|.
name|getExternalUniqueId
argument_list|()
operator|+
literal|":"
operator|+
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"Course"
block|,
literal|"Instruction"
operator|+
name|nl
operator|+
literal|"Type"
block|,
literal|"Section"
block|,
literal|"Time"
block|,
literal|"Room"
block|,
literal|"Share"
block|}
argument_list|,
operator|new
name|String
index|[]
block|{
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|,
literal|"left"
block|}
argument_list|,
operator|new
name|boolean
index|[]
block|{
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|,
literal|true
block|}
argument_list|)
decl_stmt|;
name|Set
name|allClasses
init|=
operator|new
name|HashSet
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
name|DepartmentalInstructor
operator|.
name|getAllForInstructor
argument_list|(
name|instructor
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|DepartmentalInstructor
name|di
init|=
operator|(
name|DepartmentalInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|allClasses
operator|.
name|addAll
argument_list|(
name|di
operator|.
name|getClasses
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|table
operator|.
name|setRowStyle
argument_list|(
literal|"white-space:nowrap"
argument_list|)
expr_stmt|;
name|table
operator|.
name|setBlankWhenSame
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|boolean
name|suffix
init|=
name|ApplicationProperty
operator|.
name|ExaminationReportsClassSufix
operator|.
name|isTrue
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
name|allClasses
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|ClassInstructor
name|ci
init|=
operator|(
name|ClassInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
name|String
name|course
init|=
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getControllingCourseOffering
argument_list|()
operator|.
name|getCourseName
argument_list|()
decl_stmt|;
name|String
name|itype
init|=
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getItypeDesc
argument_list|()
decl_stmt|;
name|int
name|itypeCmp
init|=
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getItype
argument_list|()
operator|.
name|getItype
argument_list|()
decl_stmt|;
name|String
name|section
init|=
operator|(
name|suffix
operator|&&
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getClassSuffix
argument_list|()
operator|!=
literal|null
condition|?
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getClassSuffix
argument_list|()
else|:
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSectionNumberString
argument_list|()
operator|)
decl_stmt|;
name|String
name|time
init|=
name|getMeetingTime
argument_list|(
name|ci
operator|.
name|getClassInstructing
argument_list|()
argument_list|)
decl_stmt|;
name|long
name|timeCmp
init|=
name|getMeetingComparable
argument_list|(
name|ci
operator|.
name|getClassInstructing
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|room
init|=
name|getMeetingRooms
argument_list|(
name|html
argument_list|,
name|ci
operator|.
name|getClassInstructing
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|share
init|=
name|ci
operator|.
name|getPercentShare
argument_list|()
operator|+
literal|"%"
decl_stmt|;
if|if
condition|(
name|html
operator|&&
name|ci
operator|.
name|isLead
argument_list|()
condition|)
name|share
operator|=
literal|"<b>"
operator|+
name|share
operator|+
literal|"</b>"
expr_stmt|;
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
name|course
block|,
name|itype
block|,
name|section
block|,
name|time
block|,
name|room
block|,
name|share
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
literal|""
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|itypeCmp
argument_list|,
name|course
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
literal|""
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|section
argument_list|,
name|itypeCmp
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
literal|""
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|timeCmp
argument_list|,
name|room
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
literal|""
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|room
argument_list|,
name|timeCmp
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
literal|""
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|ci
operator|.
name|getPercentShare
argument_list|()
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
literal|""
argument_list|)
block|}
argument_list|)
expr_stmt|;
if|if
condition|(
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getInstrOfferingConfig
argument_list|()
operator|.
name|getInstructionalOffering
argument_list|()
operator|.
name|getCourseOfferings
argument_list|()
operator|.
name|size
argument_list|()
operator|>
literal|1
condition|)
block|{
name|String
name|clist
init|=
literal|""
decl_stmt|;
for|for
control|(
name|Iterator
name|j
init|=
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSchedulingSubpart
argument_list|()
operator|.
name|getInstrOfferingConfig
argument_list|()
operator|.
name|getInstructionalOffering
argument_list|()
operator|.
name|getCourseOfferings
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|CourseOffering
name|co
init|=
operator|(
name|CourseOffering
operator|)
name|j
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|co
operator|.
name|isIsControl
argument_list|()
condition|)
continue|continue;
if|if
condition|(
name|clist
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
name|clist
operator|+=
literal|", "
expr_stmt|;
name|String
name|xcourse
init|=
name|co
operator|.
name|getCourseName
argument_list|()
decl_stmt|;
name|String
name|xsection
init|=
operator|(
name|suffix
operator|&&
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getClassSuffix
argument_list|(
name|co
argument_list|)
operator|!=
literal|null
condition|?
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getClassSuffix
argument_list|(
name|co
argument_list|)
else|:
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getSectionNumberString
argument_list|()
operator|)
decl_stmt|;
name|table
operator|.
name|addLine
argument_list|(
operator|new
name|String
index|[]
block|{
literal|"&nbsp;&nbsp;&nbsp;w / "
operator|+
name|xcourse
block|,
literal|""
block|,
operator|(
name|section
operator|.
name|equals
argument_list|(
name|xsection
argument_list|)
condition|?
literal|""
else|:
name|xsection
operator|)
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
argument_list|,
operator|new
name|Comparable
index|[]
block|{
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|xcourse
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|itypeCmp
argument_list|,
name|course
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|xcourse
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|course
argument_list|,
name|section
argument_list|,
name|itypeCmp
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|xcourse
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|timeCmp
argument_list|,
name|room
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|xcourse
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
name|room
argument_list|,
name|timeCmp
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|xcourse
argument_list|)
block|,
operator|new
name|MultiComparable
argument_list|(
operator|-
name|ci
operator|.
name|getPercentShare
argument_list|()
argument_list|,
name|course
argument_list|,
name|itypeCmp
argument_list|,
name|section
argument_list|,
name|timeCmp
argument_list|,
name|room
argument_list|,
name|xcourse
argument_list|)
block|}
argument_list|)
expr_stmt|;
block|}
block|}
block|}
return|return
name|table
return|;
block|}
specifier|public
name|void
name|printStudentSchedule
parameter_list|(
name|File
name|file
parameter_list|,
name|Student
name|student
parameter_list|,
name|HashSet
argument_list|<
name|ExamOwner
argument_list|>
name|exams
parameter_list|)
throws|throws
name|Exception
block|{
name|PrintWriter
name|out
init|=
literal|null
decl_stmt|;
try|try
block|{
name|SimpleDateFormat
name|df
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"yyyyMMdd"
argument_list|)
decl_stmt|;
name|df
operator|.
name|setTimeZone
argument_list|(
name|TimeZone
operator|.
name|getTimeZone
argument_list|(
literal|"UTC"
argument_list|)
argument_list|)
expr_stmt|;
name|SimpleDateFormat
name|tf
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"HHmmss"
argument_list|)
decl_stmt|;
name|tf
operator|.
name|setTimeZone
argument_list|(
name|TimeZone
operator|.
name|getTimeZone
argument_list|(
literal|"UTC"
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|=
operator|new
name|PrintWriter
argument_list|(
operator|new
name|FileWriter
argument_list|(
name|file
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VCALENDAR"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"VERSION:2.0"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"CALSCALE:GREGORIAN"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"METHOD:PUBLISH"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"X-WR-CALNAME:"
operator|+
name|student
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"X-WR-TIMEZONE:"
operator|+
name|TimeZone
operator|.
name|getDefault
argument_list|()
operator|.
name|getID
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"PRODID:-//UniTime "
operator|+
name|Constants
operator|.
name|getVersion
argument_list|()
operator|+
literal|"/UniTime Personal Schedule//NONSGML v1.0//EN"
argument_list|)
expr_stmt|;
if|if
condition|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
condition|)
block|{
for|for
control|(
name|Iterator
name|i
init|=
name|student
operator|.
name|getClassEnrollments
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|StudentClassEnrollment
name|sce
init|=
operator|(
name|StudentClassEnrollment
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getEvent
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|Iterator
name|k
init|=
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|k
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Meeting
name|meeting
init|=
operator|(
name|Meeting
operator|)
name|k
operator|.
name|next
argument_list|()
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VEVENT"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"UID:m"
operator|+
name|meeting
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTSTART:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTEND:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStopTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStopTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"SUMMARY:"
operator|+
name|sce
operator|.
name|getClazz
argument_list|()
operator|.
name|getClassLabel
argument_list|(
name|sce
operator|.
name|getCourseOffering
argument_list|()
argument_list|)
operator|+
literal|" ("
operator|+
name|meeting
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventTypeLabel
argument_list|()
operator|+
literal|")"
argument_list|)
expr_stmt|;
if|if
condition|(
name|meeting
operator|.
name|getLocation
argument_list|()
operator|!=
literal|null
condition|)
name|out
operator|.
name|println
argument_list|(
literal|"LOCATION:"
operator|+
name|meeting
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"END:VEVENT"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
for|for
control|(
name|ExamOwner
name|examOwner
range|:
name|exams
control|)
block|{
name|Exam
name|exam
init|=
name|examOwner
operator|.
name|getExam
argument_list|()
decl_stmt|;
if|if
condition|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|ExamSectionInfo
name|section
range|:
operator|new
name|ExamAssignment
argument_list|(
name|exam
argument_list|)
operator|.
name|getSectionsIncludeCrosslistedDummies
argument_list|()
control|)
block|{
if|if
condition|(
name|section
operator|.
name|getStudentIds
argument_list|()
operator|.
name|contains
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
block|{
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VEVENT"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"UID:x"
operator|+
name|exam
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTSTART:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|Calendar
name|endTime
init|=
name|Calendar
operator|.
name|getInstance
argument_list|()
decl_stmt|;
name|endTime
operator|.
name|setTime
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
expr_stmt|;
name|endTime
operator|.
name|add
argument_list|(
name|Calendar
operator|.
name|MINUTE
argument_list|,
name|exam
operator|.
name|getLength
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTEND:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|endTime
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|endTime
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"SUMMARY:"
operator|+
name|section
operator|.
name|getName
argument_list|()
operator|+
literal|" ("
operator|+
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Exam)"
argument_list|)
expr_stmt|;
comment|//out.println("DESCRIPTION:"+exam.getExamName()+" ("+Exam.sExamTypes[exam.getExamType()]+" Exam)");
if|if
condition|(
operator|!
name|exam
operator|.
name|getAssignedRooms
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|String
name|rooms
init|=
literal|""
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|TreeSet
argument_list|(
name|exam
operator|.
name|getAssignedRooms
argument_list|()
argument_list|)
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Location
name|location
init|=
operator|(
name|Location
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|rooms
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
name|rooms
operator|+=
literal|", "
expr_stmt|;
name|rooms
operator|+=
name|location
operator|.
name|getLabel
argument_list|()
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"LOCATION:"
operator|+
name|rooms
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"END:VEVENT"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|out
operator|.
name|println
argument_list|(
literal|"END:VCALENDAR"
argument_list|)
expr_stmt|;
block|}
finally|finally
block|{
if|if
condition|(
name|out
operator|!=
literal|null
condition|)
block|{
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
block|}
block|}
specifier|public
name|void
name|printInstructorSchedule
parameter_list|(
name|File
name|file
parameter_list|,
name|DepartmentalInstructor
name|instructor
parameter_list|,
name|HashSet
argument_list|<
name|Exam
argument_list|>
name|exams
parameter_list|)
throws|throws
name|Exception
block|{
name|PrintWriter
name|out
init|=
literal|null
decl_stmt|;
try|try
block|{
name|SimpleDateFormat
name|df
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"yyyyMMdd"
argument_list|)
decl_stmt|;
name|df
operator|.
name|setTimeZone
argument_list|(
name|TimeZone
operator|.
name|getTimeZone
argument_list|(
literal|"UTC"
argument_list|)
argument_list|)
expr_stmt|;
name|SimpleDateFormat
name|tf
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"HHmmss"
argument_list|)
decl_stmt|;
name|tf
operator|.
name|setTimeZone
argument_list|(
name|TimeZone
operator|.
name|getTimeZone
argument_list|(
literal|"UTC"
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|=
operator|new
name|PrintWriter
argument_list|(
operator|new
name|FileWriter
argument_list|(
name|file
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VCALENDAR"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"VERSION:2.0"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"CALSCALE:GREGORIAN"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"METHOD:PUBLISH"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"X-WR-CALNAME:"
operator|+
name|instructor
operator|.
name|getName
argument_list|(
name|DepartmentalInstructor
operator|.
name|sNameFormatLastFist
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"X-WR-TIMEZONE:"
operator|+
name|TimeZone
operator|.
name|getDefault
argument_list|()
operator|.
name|getID
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"PRODID:-//UniTime "
operator|+
name|Constants
operator|.
name|getVersion
argument_list|()
operator|+
literal|"/UniTime Personal Schedule//NONSGML v1.0//EN"
argument_list|)
expr_stmt|;
if|if
condition|(
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|canNoRoleReportClass
argument_list|()
condition|)
block|{
for|for
control|(
name|Iterator
name|i
init|=
name|DepartmentalInstructor
operator|.
name|getAllForInstructor
argument_list|(
name|instructor
argument_list|,
name|instructor
operator|.
name|getDepartment
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|DepartmentalInstructor
name|di
init|=
operator|(
name|DepartmentalInstructor
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|j
init|=
name|di
operator|.
name|getClasses
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|ClassInstructor
name|ci
init|=
operator|(
name|ClassInstructor
operator|)
name|j
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getEvent
argument_list|()
operator|!=
literal|null
condition|)
block|{
for|for
control|(
name|Iterator
name|k
init|=
name|ci
operator|.
name|getClassInstructing
argument_list|()
operator|.
name|getEvent
argument_list|()
operator|.
name|getMeetings
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|k
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Meeting
name|meeting
init|=
operator|(
name|Meeting
operator|)
name|k
operator|.
name|next
argument_list|()
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VEVENT"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"UID:m"
operator|+
name|meeting
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTSTART:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTEND:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStopTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|meeting
operator|.
name|getStopTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"SUMMARY:"
operator|+
name|meeting
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
operator|+
literal|" ("
operator|+
name|meeting
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventTypeLabel
argument_list|()
operator|+
literal|")"
argument_list|)
expr_stmt|;
if|if
condition|(
name|meeting
operator|.
name|getLocation
argument_list|()
operator|!=
literal|null
condition|)
name|out
operator|.
name|println
argument_list|(
literal|"LOCATION:"
operator|+
name|meeting
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"END:VEVENT"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
for|for
control|(
name|Exam
name|exam
range|:
name|exams
control|)
block|{
if|if
condition|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
name|out
operator|.
name|println
argument_list|(
literal|"BEGIN:VEVENT"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"UID:x"
operator|+
name|exam
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTSTART:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|Calendar
name|endTime
init|=
name|Calendar
operator|.
name|getInstance
argument_list|()
decl_stmt|;
name|endTime
operator|.
name|setTime
argument_list|(
name|exam
operator|.
name|getAssignedPeriod
argument_list|()
operator|.
name|getStartTime
argument_list|()
argument_list|)
expr_stmt|;
name|endTime
operator|.
name|add
argument_list|(
name|Calendar
operator|.
name|MINUTE
argument_list|,
name|exam
operator|.
name|getLength
argument_list|()
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"DTEND:"
operator|+
name|df
operator|.
name|format
argument_list|(
name|endTime
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|"T"
operator|+
name|tf
operator|.
name|format
argument_list|(
name|endTime
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|"Z"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"SUMMARY:"
operator|+
name|exam
operator|.
name|getLabel
argument_list|()
operator|+
literal|" ("
operator|+
name|exam
operator|.
name|getExamType
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|+
literal|" Exam)"
argument_list|)
expr_stmt|;
comment|//out.println("DESCRIPTION:"+exam.getExamName()+" ("+Exam.sExamTypes[exam.getExamType()]+" Exam)");
if|if
condition|(
operator|!
name|exam
operator|.
name|getAssignedRooms
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|String
name|rooms
init|=
literal|""
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
operator|new
name|TreeSet
argument_list|(
name|exam
operator|.
name|getAssignedRooms
argument_list|()
argument_list|)
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Location
name|location
init|=
operator|(
name|Location
operator|)
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|rooms
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
name|rooms
operator|+=
literal|", "
expr_stmt|;
name|rooms
operator|+=
name|location
operator|.
name|getLabel
argument_list|()
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"LOCATION:"
operator|+
name|rooms
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"END:VEVENT"
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"END:VCALENDAR"
argument_list|)
expr_stmt|;
block|}
finally|finally
block|{
if|if
condition|(
name|out
operator|!=
literal|null
condition|)
block|{
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
block|}
block|}
block|}
end_class

end_unit

