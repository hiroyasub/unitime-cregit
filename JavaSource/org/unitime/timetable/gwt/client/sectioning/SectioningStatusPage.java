begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * UniTime 3.3 (University Timetabling Application)  * Copyright (C) 2011, UniTime LLC, and individual contributors  * as indicated by the @authors tag.  *   * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 3 of the License, or  * (at your option) any later version.  *   * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *   * You should have received a copy of the GNU General Public License along  * with this program.  If not, see<http://www.gnu.org/licenses/>.  *  */
end_comment

begin_package
package|package
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|sectioning
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Comparator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|ToolBox
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|HorizontalPanelWithHint
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|LoadingWidget
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeDialogBox
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTable
operator|.
name|HasColSpan
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTable
operator|.
name|MouseClickListener
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTable
operator|.
name|TableEvent
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTableHeader
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTableHeader
operator|.
name|Operation
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTextBox
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|client
operator|.
name|widgets
operator|.
name|UniTimeTable
operator|.
name|HasCellAlignment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|StudentSectioningConstants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|StudentSectioningMessages
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|StudentSectioningResources
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|services
operator|.
name|SectioningService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|services
operator|.
name|SectioningServiceAsync
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|ClassAssignmentInterface
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|ClassAssignmentInterface
operator|.
name|Enrollment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|ClassAssignmentInterface
operator|.
name|EnrollmentInfo
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|core
operator|.
name|client
operator|.
name|GWT
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|core
operator|.
name|client
operator|.
name|Scheduler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|core
operator|.
name|client
operator|.
name|Scheduler
operator|.
name|ScheduledCommand
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|dom
operator|.
name|client
operator|.
name|Style
operator|.
name|Overflow
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|ClickEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|ClickHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|FocusEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|FocusHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|KeyCodes
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|KeyUpEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|dom
operator|.
name|client
operator|.
name|KeyUpHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|CloseEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|CloseHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|OpenEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|OpenHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|ValueChangeEvent
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|event
operator|.
name|logical
operator|.
name|shared
operator|.
name|ValueChangeHandler
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|http
operator|.
name|client
operator|.
name|URL
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|History
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|Window
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|rpc
operator|.
name|AsyncCallback
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|Button
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|Composite
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|HTML
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|HasHorizontalAlignment
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|HasVerticalAlignment
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|HorizontalPanel
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|Image
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|Label
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|PopupPanel
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|RootPanel
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|ScrollPanel
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestBox
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestOracle
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|TextBox
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|VerticalPanel
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestOracle
operator|.
name|Callback
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestOracle
operator|.
name|Request
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestOracle
operator|.
name|Response
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|SuggestOracle
operator|.
name|Suggestion
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwt
operator|.
name|user
operator|.
name|client
operator|.
name|ui
operator|.
name|Widget
import|;
end_import

begin_class
specifier|public
class|class
name|SectioningStatusPage
extends|extends
name|Composite
block|{
specifier|public
specifier|static
specifier|final
name|StudentSectioningMessages
name|MESSAGES
init|=
name|GWT
operator|.
name|create
argument_list|(
name|StudentSectioningMessages
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|StudentSectioningResources
name|RESOURCES
init|=
name|GWT
operator|.
name|create
argument_list|(
name|StudentSectioningResources
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|StudentSectioningConstants
name|CONSTANTS
init|=
name|GWT
operator|.
name|create
argument_list|(
name|StudentSectioningConstants
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|SectioningServiceAsync
name|iSectioningService
init|=
name|GWT
operator|.
name|create
argument_list|(
name|SectioningService
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|private
name|TextBox
name|iFilter
init|=
literal|null
decl_stmt|;
specifier|private
name|Button
name|iSearch
init|=
literal|null
decl_stmt|;
specifier|private
name|Image
name|iLoadingImage
init|=
literal|null
decl_stmt|;
specifier|private
name|SuggestBox
name|iFilterSuggest
init|=
literal|null
decl_stmt|;
specifier|private
name|VerticalPanel
name|iSectioningPanel
init|=
literal|null
decl_stmt|;
specifier|private
name|VerticalPanel
name|iPanel
init|=
literal|null
decl_stmt|;
specifier|private
name|HorizontalPanel
name|iFilterPanel
init|=
literal|null
decl_stmt|;
specifier|private
name|UniTimeTable
argument_list|<
name|EnrollmentInfo
argument_list|>
name|iCourseTable
init|=
literal|null
decl_stmt|;
specifier|private
name|UniTimeDialogBox
name|iEnrollmentDialog
init|=
literal|null
decl_stmt|;
specifier|private
name|EnrollmentTable
name|iEnrollmentTable
init|=
literal|null
decl_stmt|;
specifier|private
name|ScrollPanel
name|iEnrollmentScroll
init|=
literal|null
decl_stmt|;
specifier|private
name|HTML
name|iHint
init|=
literal|null
decl_stmt|,
name|iError
init|=
literal|null
decl_stmt|;
specifier|private
name|String
name|iLastFilter
init|=
literal|null
decl_stmt|;
specifier|public
name|SectioningStatusPage
parameter_list|()
block|{
name|iPanel
operator|=
operator|new
name|VerticalPanel
argument_list|()
expr_stmt|;
name|iSectioningPanel
operator|=
operator|new
name|VerticalPanel
argument_list|()
expr_stmt|;
name|iFilterPanel
operator|=
operator|new
name|HorizontalPanelWithHint
argument_list|(
operator|new
name|HTML
argument_list|(
name|MESSAGES
operator|.
name|sectioningStatusFilterHint
argument_list|()
argument_list|,
literal|false
argument_list|)
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|setSpacing
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|Label
name|filterLabel
init|=
operator|new
name|Label
argument_list|(
name|MESSAGES
operator|.
name|filter
argument_list|()
argument_list|)
decl_stmt|;
name|iFilterPanel
operator|.
name|add
argument_list|(
name|filterLabel
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|setCellVerticalAlignment
argument_list|(
name|filterLabel
argument_list|,
name|HasVerticalAlignment
operator|.
name|ALIGN_MIDDLE
argument_list|)
expr_stmt|;
name|SuggestOracle
name|courseOfferingOracle
init|=
operator|new
name|SuggestOracle
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|requestDefaultSuggestions
parameter_list|(
name|Request
name|request
parameter_list|,
name|Callback
name|callback
parameter_list|)
block|{
name|requestSuggestions
argument_list|(
name|request
argument_list|,
name|callback
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|requestSuggestions
parameter_list|(
name|Request
name|request
parameter_list|,
name|Callback
name|callback
parameter_list|)
block|{
name|iSectioningService
operator|.
name|querySuggestions
argument_list|(
name|request
operator|.
name|getQuery
argument_list|()
argument_list|,
name|request
operator|.
name|getLimit
argument_list|()
argument_list|,
operator|new
name|SuggestCallback
argument_list|(
name|request
argument_list|,
name|callback
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isDisplayStringHTML
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
block|}
decl_stmt|;
name|iFilter
operator|=
operator|new
name|UniTimeTextBox
argument_list|()
expr_stmt|;
name|iFilter
operator|.
name|setWidth
argument_list|(
literal|"400px"
argument_list|)
expr_stmt|;
name|iFilterSuggest
operator|=
operator|new
name|SuggestBox
argument_list|(
name|courseOfferingOracle
argument_list|,
name|iFilter
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|add
argument_list|(
name|iFilterSuggest
argument_list|)
expr_stmt|;
name|iFilter
operator|.
name|addFocusHandler
argument_list|(
operator|new
name|FocusHandler
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onFocus
parameter_list|(
name|FocusEvent
name|event
parameter_list|)
block|{
if|if
condition|(
name|iFilter
operator|.
name|getText
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|iFilterSuggest
operator|.
name|showSuggestionList
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|iSearch
operator|=
operator|new
name|Button
argument_list|(
name|MESSAGES
operator|.
name|buttonSearch
argument_list|()
argument_list|)
expr_stmt|;
name|iSearch
operator|.
name|setAccessKey
argument_list|(
literal|'s'
argument_list|)
expr_stmt|;
name|iSearch
operator|.
name|addStyleName
argument_list|(
literal|"unitime-NoPrint"
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|add
argument_list|(
name|iSearch
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|setCellVerticalAlignment
argument_list|(
name|iSearch
argument_list|,
name|HasVerticalAlignment
operator|.
name|ALIGN_MIDDLE
argument_list|)
expr_stmt|;
name|iLoadingImage
operator|=
operator|new
name|Image
argument_list|(
name|RESOURCES
operator|.
name|loading_small
argument_list|()
argument_list|)
expr_stmt|;
name|iLoadingImage
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|add
argument_list|(
name|iLoadingImage
argument_list|)
expr_stmt|;
name|iFilterPanel
operator|.
name|setCellVerticalAlignment
argument_list|(
name|iLoadingImage
argument_list|,
name|HasVerticalAlignment
operator|.
name|ALIGN_MIDDLE
argument_list|)
expr_stmt|;
name|iSectioningPanel
operator|.
name|add
argument_list|(
name|iFilterPanel
argument_list|)
expr_stmt|;
name|iSectioningPanel
operator|.
name|setCellHorizontalAlignment
argument_list|(
name|iFilterPanel
argument_list|,
name|HasHorizontalAlignment
operator|.
name|ALIGN_CENTER
argument_list|)
expr_stmt|;
name|iCourseTable
operator|=
operator|new
name|UniTimeTable
argument_list|<
name|ClassAssignmentInterface
operator|.
name|EnrollmentInfo
argument_list|>
argument_list|()
expr_stmt|;
name|iSectioningPanel
operator|.
name|add
argument_list|(
name|iCourseTable
argument_list|)
expr_stmt|;
name|iSectioningPanel
operator|.
name|setWidth
argument_list|(
literal|"100%"
argument_list|)
expr_stmt|;
name|iPanel
operator|.
name|add
argument_list|(
name|iSectioningPanel
argument_list|)
expr_stmt|;
name|iHint
operator|=
operator|new
name|HTML
argument_list|(
name|MESSAGES
operator|.
name|sectioningStatusHint
argument_list|()
argument_list|)
expr_stmt|;
name|iHint
operator|.
name|setStyleName
argument_list|(
literal|"unitime-Hint"
argument_list|)
expr_stmt|;
name|iHint
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iPanel
operator|.
name|add
argument_list|(
name|iHint
argument_list|)
expr_stmt|;
name|iPanel
operator|.
name|setCellHorizontalAlignment
argument_list|(
name|iHint
argument_list|,
name|HasHorizontalAlignment
operator|.
name|ALIGN_RIGHT
argument_list|)
expr_stmt|;
name|iError
operator|=
operator|new
name|HTML
argument_list|()
expr_stmt|;
name|iError
operator|.
name|setStyleName
argument_list|(
literal|"unitime-ErrorMessage"
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iPanel
operator|.
name|add
argument_list|(
name|iError
argument_list|)
expr_stmt|;
name|iPanel
operator|.
name|setCellHorizontalAlignment
argument_list|(
name|iError
argument_list|,
name|HasHorizontalAlignment
operator|.
name|ALIGN_CENTER
argument_list|)
expr_stmt|;
name|initWidget
argument_list|(
name|iPanel
argument_list|)
expr_stmt|;
name|iSearch
operator|.
name|addClickHandler
argument_list|(
operator|new
name|ClickHandler
argument_list|()
block|{
specifier|public
name|void
name|onClick
parameter_list|(
name|ClickEvent
name|event
parameter_list|)
block|{
name|loadCourses
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|iFilter
operator|.
name|addKeyUpHandler
argument_list|(
operator|new
name|KeyUpHandler
argument_list|()
block|{
specifier|public
name|void
name|onKeyUp
parameter_list|(
name|KeyUpEvent
name|event
parameter_list|)
block|{
if|if
condition|(
name|event
operator|.
name|getNativeKeyCode
argument_list|()
operator|==
name|KeyCodes
operator|.
name|KEY_ENTER
condition|)
block|{
if|if
condition|(
name|iFilter
operator|.
name|getText
argument_list|()
operator|.
name|equals
argument_list|(
name|iLastFilter
argument_list|)
condition|)
name|loadCourses
argument_list|()
expr_stmt|;
else|else
name|iLastFilter
operator|=
name|iFilter
operator|.
name|getText
argument_list|()
expr_stmt|;
block|}
block|}
block|}
argument_list|)
expr_stmt|;
name|Scheduler
operator|.
name|get
argument_list|()
operator|.
name|scheduleDeferred
argument_list|(
operator|new
name|ScheduledCommand
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iFilter
operator|.
name|setFocus
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
if|if
condition|(
name|Window
operator|.
name|Location
operator|.
name|getParameter
argument_list|(
literal|"q"
argument_list|)
operator|!=
literal|null
condition|)
block|{
name|iFilter
operator|.
name|setText
argument_list|(
name|Window
operator|.
name|Location
operator|.
name|getParameter
argument_list|(
literal|"q"
argument_list|)
argument_list|)
expr_stmt|;
name|loadCourses
argument_list|()
expr_stmt|;
block|}
if|else if
condition|(
name|Window
operator|.
name|Location
operator|.
name|getHash
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|Window
operator|.
name|Location
operator|.
name|getHash
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|String
name|hash
init|=
name|URL
operator|.
name|decode
argument_list|(
name|Window
operator|.
name|Location
operator|.
name|getHash
argument_list|()
operator|.
name|substring
argument_list|(
literal|1
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|hash
operator|.
name|matches
argument_list|(
literal|"^[0-9]+\\:[0-9]+$"
argument_list|)
condition|)
block|{
name|iFilter
operator|.
name|setText
argument_list|(
name|hash
argument_list|)
expr_stmt|;
name|loadCourses
argument_list|()
expr_stmt|;
block|}
block|}
else|else
block|{
comment|// retrieve last query
block|}
name|iCourseTable
operator|.
name|addMouseClickListener
argument_list|(
operator|new
name|MouseClickListener
argument_list|<
name|ClassAssignmentInterface
operator|.
name|EnrollmentInfo
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onMouseClick
parameter_list|(
specifier|final
name|TableEvent
argument_list|<
name|EnrollmentInfo
argument_list|>
name|event
parameter_list|)
block|{
if|if
condition|(
name|event
operator|.
name|getData
argument_list|()
operator|==
literal|null
operator|||
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseId
argument_list|()
operator|==
literal|null
condition|)
return|return;
comment|// header or footer
name|iCourseTable
operator|.
name|clearHover
argument_list|()
expr_stmt|;
name|setLoading
argument_list|(
literal|true
argument_list|)
expr_stmt|;
specifier|final
name|Long
name|id
init|=
operator|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|?
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getOfferingId
argument_list|()
else|:
operator|-
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getClazzId
argument_list|()
operator|)
decl_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
if|if
condition|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|show
argument_list|(
name|MESSAGES
operator|.
name|loadingEnrollments
argument_list|(
name|MESSAGES
operator|.
name|course
argument_list|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubject
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseNbr
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|show
argument_list|(
name|MESSAGES
operator|.
name|loadingEnrollments
argument_list|(
name|MESSAGES
operator|.
name|clazz
argument_list|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubject
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseNbr
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubpart
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getClazz
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|iSectioningService
operator|.
name|canApprove
argument_list|(
name|id
argument_list|,
operator|new
name|AsyncCallback
argument_list|<
name|Boolean
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onSuccess
parameter_list|(
specifier|final
name|Boolean
name|canApprove
parameter_list|)
block|{
name|iSectioningService
operator|.
name|findEnrollments
argument_list|(
name|iFilter
operator|.
name|getText
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getClazzId
argument_list|()
argument_list|,
operator|new
name|AsyncCallback
argument_list|<
name|List
argument_list|<
name|Enrollment
argument_list|>
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onFailure
parameter_list|(
name|Throwable
name|caught
parameter_list|)
block|{
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|fail
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setHTML
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ToolBox
operator|.
name|checkAccess
argument_list|(
name|caught
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|onSuccess
parameter_list|(
name|List
argument_list|<
name|Enrollment
argument_list|>
name|result
parameter_list|)
block|{
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|hide
argument_list|()
expr_stmt|;
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iEnrollmentTable
operator|.
name|clear
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iEnrollmentTable
operator|.
name|setId
argument_list|(
name|id
argument_list|)
expr_stmt|;
name|iEnrollmentTable
operator|.
name|populate
argument_list|(
name|result
argument_list|,
name|canApprove
argument_list|)
expr_stmt|;
if|if
condition|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
name|iEnrollmentDialog
operator|.
name|setText
argument_list|(
name|MESSAGES
operator|.
name|titleEnrollments
argument_list|(
name|MESSAGES
operator|.
name|course
argument_list|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubject
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseNbr
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|iEnrollmentDialog
operator|.
name|setText
argument_list|(
name|MESSAGES
operator|.
name|titleEnrollments
argument_list|(
name|MESSAGES
operator|.
name|clazz
argument_list|(
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubject
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getCourseNbr
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getSubpart
argument_list|()
argument_list|,
name|event
operator|.
name|getData
argument_list|()
operator|.
name|getClazz
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|center
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|onFailure
parameter_list|(
name|Throwable
name|caught
parameter_list|)
block|{
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|fail
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setHTML
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ToolBox
operator|.
name|checkAccess
argument_list|(
name|caught
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|History
operator|.
name|addValueChangeHandler
argument_list|(
operator|new
name|ValueChangeHandler
argument_list|<
name|String
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onValueChange
parameter_list|(
name|ValueChangeEvent
argument_list|<
name|String
argument_list|>
name|event
parameter_list|)
block|{
name|iFilter
operator|.
name|setText
argument_list|(
name|event
operator|.
name|getValue
argument_list|()
argument_list|)
expr_stmt|;
name|loadCourses
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|iEnrollmentTable
operator|=
operator|new
name|EnrollmentTable
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iEnrollmentScroll
operator|=
operator|new
name|ScrollPanel
argument_list|(
name|iEnrollmentTable
argument_list|)
expr_stmt|;
name|iEnrollmentScroll
operator|.
name|setHeight
argument_list|(
operator|(
operator|(
name|int
operator|)
operator|(
literal|0.8
operator|*
name|Window
operator|.
name|getClientHeight
argument_list|()
operator|)
operator|)
operator|+
literal|"px"
argument_list|)
expr_stmt|;
name|iEnrollmentScroll
operator|.
name|setStyleName
argument_list|(
literal|"unitime-ScrollPanel"
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|=
operator|new
name|UniTimeDialogBox
argument_list|(
literal|true
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|setEscapeToHide
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|setWidget
argument_list|(
name|iEnrollmentScroll
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|addOpenHandler
argument_list|(
operator|new
name|OpenHandler
argument_list|<
name|UniTimeDialogBox
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onOpen
parameter_list|(
name|OpenEvent
argument_list|<
name|UniTimeDialogBox
argument_list|>
name|event
parameter_list|)
block|{
name|RootPanel
operator|.
name|getBodyElement
argument_list|()
operator|.
name|getStyle
argument_list|()
operator|.
name|setOverflow
argument_list|(
name|Overflow
operator|.
name|HIDDEN
argument_list|)
expr_stmt|;
name|iEnrollmentScroll
operator|.
name|setHeight
argument_list|(
name|Math
operator|.
name|min
argument_list|(
name|iEnrollmentTable
operator|.
name|getElement
argument_list|()
operator|.
name|getScrollHeight
argument_list|()
argument_list|,
name|Window
operator|.
name|getClientHeight
argument_list|()
operator|*
literal|80
operator|/
literal|100
argument_list|)
operator|+
literal|"px"
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|setPopupPosition
argument_list|(
name|Math
operator|.
name|max
argument_list|(
name|Window
operator|.
name|getScrollLeft
argument_list|()
operator|+
operator|(
name|Window
operator|.
name|getClientWidth
argument_list|()
operator|-
name|iEnrollmentDialog
operator|.
name|getOffsetWidth
argument_list|()
operator|)
operator|/
literal|2
argument_list|,
literal|0
argument_list|)
argument_list|,
name|Math
operator|.
name|max
argument_list|(
name|Window
operator|.
name|getScrollTop
argument_list|()
operator|+
operator|(
name|Window
operator|.
name|getClientHeight
argument_list|()
operator|-
name|iEnrollmentDialog
operator|.
name|getOffsetHeight
argument_list|()
operator|)
operator|/
literal|2
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|iEnrollmentDialog
operator|.
name|addCloseHandler
argument_list|(
operator|new
name|CloseHandler
argument_list|<
name|PopupPanel
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onClose
parameter_list|(
name|CloseEvent
argument_list|<
name|PopupPanel
argument_list|>
name|event
parameter_list|)
block|{
name|RootPanel
operator|.
name|getBodyElement
argument_list|()
operator|.
name|getStyle
argument_list|()
operator|.
name|setOverflow
argument_list|(
name|Overflow
operator|.
name|AUTO
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
specifier|private
name|void
name|setLoading
parameter_list|(
name|boolean
name|loading
parameter_list|)
block|{
name|iLoadingImage
operator|.
name|setVisible
argument_list|(
name|loading
argument_list|)
expr_stmt|;
name|iSearch
operator|.
name|setVisible
argument_list|(
operator|!
name|loading
argument_list|)
expr_stmt|;
block|}
specifier|private
name|void
name|loadCourses
parameter_list|()
block|{
name|iCourseTable
operator|.
name|clearTable
argument_list|()
expr_stmt|;
name|iHint
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|History
operator|.
name|newItem
argument_list|(
name|iFilter
operator|.
name|getText
argument_list|()
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|show
argument_list|(
name|MESSAGES
operator|.
name|loadingData
argument_list|()
argument_list|)
expr_stmt|;
name|setLoading
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iSectioningService
operator|.
name|findEnrollmentInfos
argument_list|(
name|iFilter
operator|.
name|getText
argument_list|()
argument_list|,
literal|null
argument_list|,
operator|new
name|AsyncCallback
argument_list|<
name|List
argument_list|<
name|EnrollmentInfo
argument_list|>
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onFailure
parameter_list|(
name|Throwable
name|caught
parameter_list|)
block|{
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|hide
argument_list|()
expr_stmt|;
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setHTML
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ToolBox
operator|.
name|checkAccess
argument_list|(
name|caught
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|onSuccess
parameter_list|(
name|List
argument_list|<
name|EnrollmentInfo
argument_list|>
name|result
parameter_list|)
block|{
if|if
condition|(
name|result
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|iError
operator|.
name|setHTML
argument_list|(
name|MESSAGES
operator|.
name|exceptionNoCourses
argument_list|(
name|iFilter
operator|.
name|getText
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|populateCourseTable
argument_list|(
name|result
argument_list|)
expr_stmt|;
block|}
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|LoadingWidget
operator|.
name|getInstance
argument_list|()
operator|.
name|hide
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
specifier|private
name|List
argument_list|<
name|Widget
argument_list|>
name|line
parameter_list|(
specifier|final
name|EnrollmentInfo
name|e
parameter_list|)
block|{
name|List
argument_list|<
name|Widget
argument_list|>
name|line
init|=
operator|new
name|ArrayList
argument_list|<
name|Widget
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|e
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|e
operator|.
name|getCourseId
argument_list|()
operator|!=
literal|null
condition|)
block|{
specifier|final
name|Image
name|showDetails
init|=
operator|new
name|Image
argument_list|(
name|RESOURCES
operator|.
name|treeClosed
argument_list|()
argument_list|)
decl_stmt|;
name|showDetails
operator|.
name|addClickHandler
argument_list|(
operator|new
name|ClickHandler
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onClick
parameter_list|(
name|ClickEvent
name|event
parameter_list|)
block|{
specifier|final
name|int
name|row
init|=
name|iCourseTable
operator|.
name|getCellForEvent
argument_list|(
name|event
argument_list|)
operator|.
name|getRowIndex
argument_list|()
decl_stmt|;
if|if
condition|(
name|row
operator|+
literal|1
operator|==
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|||
name|iCourseTable
operator|.
name|getData
argument_list|(
name|row
operator|+
literal|1
argument_list|)
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
block|{
comment|// open
name|setLoading
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|showDetails
operator|.
name|setResource
argument_list|(
name|RESOURCES
operator|.
name|treeOpen
argument_list|()
argument_list|)
expr_stmt|;
name|iSectioningService
operator|.
name|findEnrollmentInfos
argument_list|(
name|iFilter
operator|.
name|getText
argument_list|()
argument_list|,
name|e
operator|.
name|getCourseId
argument_list|()
argument_list|,
operator|new
name|AsyncCallback
argument_list|<
name|List
argument_list|<
name|EnrollmentInfo
argument_list|>
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|onFailure
parameter_list|(
name|Throwable
name|caught
parameter_list|)
block|{
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setHTML
argument_list|(
name|caught
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|iError
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|ToolBox
operator|.
name|checkAccess
argument_list|(
name|caught
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|onSuccess
parameter_list|(
name|List
argument_list|<
name|EnrollmentInfo
argument_list|>
name|result
parameter_list|)
block|{
name|setLoading
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|int
name|r
init|=
name|row
operator|+
literal|1
decl_stmt|;
for|for
control|(
name|EnrollmentInfo
name|e
range|:
name|result
control|)
block|{
name|iCourseTable
operator|.
name|insertRow
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|iCourseTable
operator|.
name|setRow
argument_list|(
name|r
argument_list|,
name|e
argument_list|,
name|line
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|r
operator|++
expr_stmt|;
block|}
block|}
block|}
argument_list|)
expr_stmt|;
block|}
else|else
block|{
for|for
control|(
name|int
name|r
init|=
name|row
operator|+
literal|1
init|;
name|r
operator|<
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
condition|;
name|r
operator|++
control|)
block|{
if|if
condition|(
name|iCourseTable
operator|.
name|getData
argument_list|(
name|r
argument_list|)
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
break|break;
name|iCourseTable
operator|.
name|getRowFormatter
argument_list|()
operator|.
name|setVisible
argument_list|(
name|r
argument_list|,
operator|!
name|iCourseTable
operator|.
name|getRowFormatter
argument_list|()
operator|.
name|isVisible
argument_list|(
name|r
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|showDetails
operator|.
name|setResource
argument_list|(
name|RESOURCES
operator|.
name|treeClosed
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|event
operator|.
name|getNativeEvent
argument_list|()
operator|.
name|stopPropagation
argument_list|()
expr_stmt|;
name|event
operator|.
name|getNativeEvent
argument_list|()
operator|.
name|preventDefault
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
name|showDetails
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
name|e
operator|.
name|getSubject
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
name|e
operator|.
name|getCourseNbr
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|TitleCell
argument_list|(
name|e
operator|.
name|getTitle
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e
operator|.
name|getTitle
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
name|e
operator|.
name|getConsent
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e
operator|.
name|getConsent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|()
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|HTML
argument_list|(
literal|"&nbsp;&nbsp;"
operator|+
operator|(
name|e
operator|.
name|getSubpart
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e
operator|.
name|getSubpart
argument_list|()
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|HTML
argument_list|(
name|e
operator|.
name|getClazz
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e
operator|.
name|getClazz
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getDays
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|?
literal|""
else|:
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getDaysString
argument_list|(
name|CONSTANTS
operator|.
name|shortDays
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getStartString
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getEndString
argument_list|(
name|CONSTANTS
operator|.
name|useAmPm
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
operator|!
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|hasDatePattern
argument_list|()
condition|?
literal|""
else|:
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getDatePattern
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|Label
argument_list|(
operator|!
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|hasRoom
argument_list|()
condition|?
literal|""
else|:
name|e
operator|.
name|getAssignment
argument_list|()
operator|.
name|getRooms
argument_list|(
literal|","
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|e
operator|.
name|getCourseId
argument_list|()
operator|==
literal|null
condition|)
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
name|e
operator|.
name|getAvailable
argument_list|()
argument_list|,
name|e
operator|.
name|getLimit
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|line
operator|.
name|add
argument_list|(
operator|new
name|AvailableCell
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
literal|null
argument_list|,
name|e
operator|.
name|getProjection
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
name|e
operator|.
name|getEnrollment
argument_list|()
argument_list|,
name|e
operator|.
name|getTotalEnrollment
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
name|e
operator|.
name|getWaitlist
argument_list|()
argument_list|,
name|e
operator|.
name|getTotalWaitlist
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
name|e
operator|.
name|getReservation
argument_list|()
argument_list|,
name|e
operator|.
name|getTotalReservation
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|line
operator|.
name|add
argument_list|(
operator|new
name|NumberCell
argument_list|(
name|e
operator|.
name|getConsentApproved
argument_list|()
operator|+
name|e
operator|.
name|getConsentNeeded
argument_list|()
argument_list|,
name|e
operator|.
name|getTotalConsentApproved
argument_list|()
operator|+
name|e
operator|.
name|getTotalConsentNeeded
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|line
return|;
block|}
specifier|public
name|void
name|populateCourseTable
parameter_list|(
name|List
argument_list|<
name|EnrollmentInfo
argument_list|>
name|result
parameter_list|)
block|{
name|List
argument_list|<
name|Widget
argument_list|>
name|header
init|=
operator|new
name|ArrayList
argument_list|<
name|Widget
argument_list|>
argument_list|()
decl_stmt|;
name|UniTimeTableHeader
name|hOperations
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
literal|""
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hOperations
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hSubject
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colSubject
argument_list|()
operator|+
literal|"<br>"
operator|+
name|MESSAGES
operator|.
name|colSubpart
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hSubject
argument_list|)
expr_stmt|;
name|hSubject
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|SUBJECT
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colSubject
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hCourse
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colCourse
argument_list|()
operator|+
literal|"<br>"
operator|+
name|MESSAGES
operator|.
name|colClass
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hCourse
argument_list|)
expr_stmt|;
name|hCourse
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|COURSE
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colCourse
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hTitleSubpart
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colTitle
argument_list|()
operator|+
literal|"<br>"
operator|+
name|MESSAGES
operator|.
name|colTime
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hTitleSubpart
argument_list|)
expr_stmt|;
name|hTitleSubpart
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|TITLE
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colTitle
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hStart
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
literal|"<br>"
operator|+
name|MESSAGES
operator|.
name|colDate
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hStart
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hRoom
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colConsent
argument_list|()
operator|+
literal|"<br>"
operator|+
name|MESSAGES
operator|.
name|colRoom
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hRoom
argument_list|)
expr_stmt|;
name|hRoom
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|CONSENT
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colConsent
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hLimit
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colAvailable
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hLimit
argument_list|)
expr_stmt|;
name|hLimit
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|LIMIT
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colAvailable
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hProjection
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colProjection
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hProjection
argument_list|)
expr_stmt|;
name|hProjection
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|PROJECTION
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colProjection
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hEnrollment
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colEnrollment
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hEnrollment
argument_list|)
expr_stmt|;
name|hEnrollment
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|ENROLLMENT
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colEnrollment
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hWaitListed
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colWaitListed
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hWaitListed
argument_list|)
expr_stmt|;
name|hWaitListed
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|WAITLIST
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colWaitListed
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hReserved
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colReserved
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hReserved
argument_list|)
expr_stmt|;
name|hReserved
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|RESERVATION
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colReserved
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|UniTimeTableHeader
name|hConsent
init|=
operator|new
name|UniTimeTableHeader
argument_list|(
name|MESSAGES
operator|.
name|colConsent
argument_list|()
argument_list|)
decl_stmt|;
name|header
operator|.
name|add
argument_list|(
name|hConsent
argument_list|)
expr_stmt|;
name|hConsent
operator|.
name|addOperation
argument_list|(
operator|new
name|Operation
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|iCourseTable
operator|.
name|sort
argument_list|(
operator|new
name|EnrollmentComparator
argument_list|(
name|EnrollmentComparator
operator|.
name|SortBy
operator|.
name|NBR_CONSENT
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isApplicable
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasSeparator
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|MESSAGES
operator|.
name|sortBy
argument_list|(
name|MESSAGES
operator|.
name|colConsent
argument_list|()
argument_list|)
return|;
block|}
block|}
argument_list|)
expr_stmt|;
name|iCourseTable
operator|.
name|addRow
argument_list|(
literal|null
argument_list|,
name|header
argument_list|)
expr_stmt|;
for|for
control|(
name|EnrollmentInfo
name|e
range|:
name|result
control|)
block|{
name|iCourseTable
operator|.
name|addRow
argument_list|(
name|e
argument_list|,
name|line
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|iCourseTable
operator|.
name|getRowFormatter
argument_list|()
operator|.
name|getElement
argument_list|(
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|-
literal|1
argument_list|)
operator|.
name|getStyle
argument_list|()
operator|.
name|setBackgroundColor
argument_list|(
literal|"#f3f3f3"
argument_list|)
expr_stmt|;
block|}
comment|// Total line
if|if
condition|(
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|>=
literal|2
condition|)
block|{
for|for
control|(
name|int
name|c
init|=
literal|0
init|;
name|c
operator|<
name|iCourseTable
operator|.
name|getCellCount
argument_list|(
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|-
literal|1
argument_list|)
condition|;
name|c
operator|++
control|)
name|iCourseTable
operator|.
name|getCellFormatter
argument_list|()
operator|.
name|setStyleName
argument_list|(
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|-
literal|1
argument_list|,
name|c
argument_list|,
literal|"unitime-TotalRow"
argument_list|)
expr_stmt|;
name|iCourseTable
operator|.
name|getRowFormatter
argument_list|()
operator|.
name|getElement
argument_list|(
name|iCourseTable
operator|.
name|getRowCount
argument_list|()
operator|-
literal|1
argument_list|)
operator|.
name|getStyle
argument_list|()
operator|.
name|clearBackgroundColor
argument_list|()
expr_stmt|;
block|}
name|iHint
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
specifier|public
specifier|static
class|class
name|SimpleSuggestion
implements|implements
name|Suggestion
block|{
specifier|private
name|String
name|iDisplay
decl_stmt|,
name|iReplace
decl_stmt|;
specifier|public
name|SimpleSuggestion
parameter_list|(
name|String
name|display
parameter_list|,
name|String
name|replace
parameter_list|)
block|{
name|iDisplay
operator|=
name|display
expr_stmt|;
name|iReplace
operator|=
name|replace
expr_stmt|;
block|}
specifier|public
name|SimpleSuggestion
parameter_list|(
name|String
name|replace
parameter_list|)
block|{
name|this
argument_list|(
name|replace
argument_list|,
name|replace
argument_list|)
expr_stmt|;
block|}
specifier|public
name|String
name|getDisplayString
parameter_list|()
block|{
return|return
name|iDisplay
return|;
block|}
specifier|public
name|String
name|getReplacementString
parameter_list|()
block|{
return|return
name|iReplace
return|;
block|}
block|}
specifier|public
class|class
name|SuggestCallback
implements|implements
name|AsyncCallback
argument_list|<
name|List
argument_list|<
name|String
index|[]
argument_list|>
argument_list|>
block|{
specifier|private
name|Request
name|iRequest
decl_stmt|;
specifier|private
name|Callback
name|iCallback
decl_stmt|;
specifier|public
name|SuggestCallback
parameter_list|(
name|Request
name|request
parameter_list|,
name|Callback
name|callback
parameter_list|)
block|{
name|iRequest
operator|=
name|request
expr_stmt|;
name|iCallback
operator|=
name|callback
expr_stmt|;
block|}
specifier|public
name|void
name|onFailure
parameter_list|(
name|Throwable
name|caught
parameter_list|)
block|{
name|ArrayList
argument_list|<
name|Suggestion
argument_list|>
name|suggestions
init|=
operator|new
name|ArrayList
argument_list|<
name|Suggestion
argument_list|>
argument_list|()
decl_stmt|;
name|suggestions
operator|.
name|add
argument_list|(
operator|new
name|SimpleSuggestion
argument_list|(
literal|"<font color='red'>"
operator|+
name|caught
operator|.
name|getMessage
argument_list|()
operator|+
literal|"</font>"
argument_list|,
literal|""
argument_list|)
argument_list|)
expr_stmt|;
name|iCallback
operator|.
name|onSuggestionsReady
argument_list|(
name|iRequest
argument_list|,
operator|new
name|Response
argument_list|(
name|suggestions
argument_list|)
argument_list|)
expr_stmt|;
name|ToolBox
operator|.
name|checkAccess
argument_list|(
name|caught
argument_list|)
expr_stmt|;
block|}
specifier|public
name|void
name|onSuccess
parameter_list|(
name|List
argument_list|<
name|String
index|[]
argument_list|>
name|result
parameter_list|)
block|{
name|ArrayList
argument_list|<
name|Suggestion
argument_list|>
name|suggestions
init|=
operator|new
name|ArrayList
argument_list|<
name|Suggestion
argument_list|>
argument_list|()
decl_stmt|;
for|for
control|(
name|String
index|[]
name|suggestion
range|:
name|result
control|)
block|{
name|suggestions
operator|.
name|add
argument_list|(
operator|new
name|SimpleSuggestion
argument_list|(
name|suggestion
index|[
literal|1
index|]
argument_list|,
name|suggestion
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|iCallback
operator|.
name|onSuggestionsReady
argument_list|(
name|iRequest
argument_list|,
operator|new
name|Response
argument_list|(
name|suggestions
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
specifier|public
specifier|static
class|class
name|NumberCell
extends|extends
name|HTML
implements|implements
name|HasCellAlignment
block|{
name|Integer
name|iValue
decl_stmt|,
name|iTotal
decl_stmt|;
specifier|public
name|NumberCell
parameter_list|(
name|Integer
name|value
parameter_list|,
name|Integer
name|total
parameter_list|)
block|{
name|super
argument_list|()
expr_stmt|;
name|iValue
operator|=
name|value
expr_stmt|;
name|iTotal
operator|=
name|total
expr_stmt|;
if|if
condition|(
name|iValue
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|iTotal
operator|!=
literal|null
condition|)
name|setHTML
argument_list|(
name|iTotal
operator|==
literal|0
condition|?
literal|"-"
else|:
name|iTotal
operator|<
literal|0
condition|?
literal|"&infin;"
else|:
name|iTotal
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|iValue
operator|.
name|equals
argument_list|(
name|iTotal
argument_list|)
condition|)
name|setHTML
argument_list|(
name|iTotal
operator|==
literal|0
condition|?
literal|"-"
else|:
name|iTotal
operator|<
literal|0
condition|?
literal|"&infin;"
else|:
name|iTotal
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
else|else
name|setHTML
argument_list|(
operator|(
name|iValue
operator|<
literal|0
condition|?
literal|"&infin;"
else|:
name|iValue
operator|.
name|toString
argument_list|()
operator|)
operator|+
literal|" / "
operator|+
operator|(
name|iTotal
operator|<
literal|0
condition|?
literal|"&infin;"
else|:
name|iTotal
operator|.
name|toString
argument_list|()
operator|)
argument_list|)
expr_stmt|;
block|}
block|}
annotation|@
name|Override
specifier|public
name|HorizontalAlignmentConstant
name|getCellAlignment
parameter_list|()
block|{
return|return
name|HasHorizontalAlignment
operator|.
name|ALIGN_RIGHT
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|TitleCell
extends|extends
name|HTML
implements|implements
name|HasColSpan
block|{
specifier|public
name|TitleCell
parameter_list|(
name|String
name|title
parameter_list|)
block|{
name|super
argument_list|(
name|title
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getColSpan
parameter_list|()
block|{
return|return
literal|2
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|AvailableCell
extends|extends
name|HTML
implements|implements
name|HasCellAlignment
block|{
name|Integer
name|iAvailable
decl_stmt|,
name|iEnrollment
decl_stmt|,
name|iLimit
decl_stmt|,
name|iReserved
decl_stmt|,
name|iOther
decl_stmt|;
specifier|public
name|AvailableCell
parameter_list|(
name|EnrollmentInfo
name|e
parameter_list|)
block|{
name|super
argument_list|()
expr_stmt|;
name|iAvailable
operator|=
name|e
operator|.
name|getAvailable
argument_list|()
expr_stmt|;
name|iEnrollment
operator|=
name|e
operator|.
name|getTotalEnrollment
argument_list|()
expr_stmt|;
name|iLimit
operator|=
name|e
operator|.
name|getLimit
argument_list|()
expr_stmt|;
name|iReserved
operator|=
name|e
operator|.
name|getTotalReservation
argument_list|()
expr_stmt|;
name|iOther
operator|=
operator|(
name|e
operator|.
name|getOther
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e
operator|.
name|getOther
argument_list|()
operator|)
expr_stmt|;
if|if
condition|(
name|iLimit
operator|==
literal|null
condition|)
block|{
name|setHTML
argument_list|(
literal|"-"
argument_list|)
expr_stmt|;
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableNoLimit
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|iLimit
operator|<
literal|0
condition|)
block|{
if|if
condition|(
name|iAvailable
operator|!=
literal|null
operator|&&
name|iAvailable
operator|==
literal|0
condition|)
block|{
name|setHTML
argument_list|(
literal|"&infin;"
operator|+
name|MESSAGES
operator|.
name|htmlReservationSign
argument_list|()
argument_list|)
expr_stmt|;
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableUnlimitedWithReservation
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|setHTML
argument_list|(
literal|"&infin;"
argument_list|)
expr_stmt|;
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableUnlimited
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|iAvailable
operator|==
name|iLimit
operator|-
name|iEnrollment
operator|-
name|iOther
condition|)
block|{
name|setHTML
argument_list|(
name|iAvailable
operator|+
literal|" / "
operator|+
name|iLimit
argument_list|)
expr_stmt|;
if|if
condition|(
name|iAvailable
operator|==
literal|0
condition|)
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableNot
argument_list|(
name|iLimit
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|available
argument_list|(
name|iAvailable
argument_list|,
name|iLimit
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|iAvailable
operator|==
literal|0
operator|&&
name|iLimit
operator|>
name|iEnrollment
operator|+
name|iOther
condition|)
block|{
name|setHTML
argument_list|(
operator|(
name|iLimit
operator|-
name|iEnrollment
operator|-
name|iOther
operator|)
operator|+
name|MESSAGES
operator|.
name|htmlReservationSign
argument_list|()
operator|+
literal|" / "
operator|+
name|iLimit
argument_list|)
expr_stmt|;
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableWithReservation
argument_list|(
name|iLimit
operator|-
name|iEnrollment
operator|-
name|iOther
argument_list|,
name|iLimit
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|setHTML
argument_list|(
name|iAvailable
operator|+
literal|" + "
operator|+
operator|(
name|iLimit
operator|-
name|iEnrollment
operator|-
name|iAvailable
operator|-
name|iOther
operator|)
operator|+
name|MESSAGES
operator|.
name|htmlReservationSign
argument_list|()
operator|+
literal|" / "
operator|+
name|iLimit
argument_list|)
expr_stmt|;
name|setTitle
argument_list|(
name|MESSAGES
operator|.
name|availableSomeReservation
argument_list|(
name|iAvailable
argument_list|,
name|iLimit
argument_list|,
name|iLimit
operator|-
name|iEnrollment
operator|-
name|iAvailable
operator|-
name|iOther
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
annotation|@
name|Override
specifier|public
name|HorizontalAlignmentConstant
name|getCellAlignment
parameter_list|()
block|{
return|return
name|HasHorizontalAlignment
operator|.
name|ALIGN_RIGHT
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|EnrollmentComparator
implements|implements
name|Comparator
argument_list|<
name|EnrollmentInfo
argument_list|>
block|{
specifier|public
enum|enum
name|SortBy
block|{
name|SUBJECT
block|,
name|COURSE
block|,
name|TITLE
block|,
name|CONSENT
block|,
name|LIMIT
block|,
name|PROJECTION
block|,
name|ENROLLMENT
block|,
name|WAITLIST
block|,
name|RESERVATION
block|,
name|NBR_CONSENT
block|}
specifier|private
name|SortBy
name|iSortBy
decl_stmt|;
specifier|public
name|EnrollmentComparator
parameter_list|(
name|SortBy
name|sortBy
parameter_list|)
block|{
name|iSortBy
operator|=
name|sortBy
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|compare
parameter_list|(
name|EnrollmentInfo
name|e1
parameter_list|,
name|EnrollmentInfo
name|e2
parameter_list|)
block|{
comment|// Totals line is always last
if|if
condition|(
name|e1
operator|.
name|getCourseId
argument_list|()
operator|==
literal|null
condition|)
return|return
literal|1
return|;
if|if
condition|(
name|e2
operator|.
name|getCourseId
argument_list|()
operator|==
literal|null
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|e1
operator|.
name|getCourseId
argument_list|()
operator|.
name|equals
argument_list|(
name|e2
operator|.
name|getCourseId
argument_list|()
argument_list|)
condition|)
block|{
comment|// Same course
comment|// Course line first
if|if
condition|(
name|e1
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|e2
operator|.
name|getConfigId
argument_list|()
operator|==
literal|null
condition|)
return|return
operator|-
literal|1
return|;
return|return
name|compareClasses
argument_list|(
name|e1
argument_list|,
name|e2
argument_list|)
return|;
block|}
else|else
block|{
comment|// Different course
return|return
name|compareCourses
argument_list|(
name|e1
argument_list|,
name|e2
argument_list|)
return|;
block|}
block|}
specifier|private
name|int
name|compareClasses
parameter_list|(
name|EnrollmentInfo
name|e1
parameter_list|,
name|EnrollmentInfo
name|e2
parameter_list|)
block|{
return|return
literal|0
return|;
block|}
specifier|private
name|int
name|compareCourses
parameter_list|(
name|EnrollmentInfo
name|e1
parameter_list|,
name|EnrollmentInfo
name|e2
parameter_list|)
block|{
name|int
name|cmp
decl_stmt|;
switch|switch
condition|(
name|iSortBy
condition|)
block|{
case|case
name|SUBJECT
case|:
break|break;
case|case
name|COURSE
case|:
name|cmp
operator|=
name|e1
operator|.
name|getCourseNbr
argument_list|()
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getCourseNbr
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
break|break;
case|case
name|TITLE
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getTitle
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e1
operator|.
name|getTitle
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getTitle
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e2
operator|.
name|getTitle
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
break|break;
case|case
name|CONSENT
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getConsent
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e1
operator|.
name|getConsent
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getConsent
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e2
operator|.
name|getConsent
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
break|break;
case|case
name|LIMIT
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getAvailable
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getAvailable
argument_list|()
operator|<
literal|0
condition|?
operator|new
name|Integer
argument_list|(
name|Integer
operator|.
name|MAX_VALUE
argument_list|)
else|:
name|e1
operator|.
name|getAvailable
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getAvailable
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getAvailable
argument_list|()
operator|<
literal|0
condition|?
name|Integer
operator|.
name|MAX_VALUE
else|:
name|e2
operator|.
name|getAvailable
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getLimit
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getLimit
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getLimit
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getLimit
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
break|break;
case|case
name|PROJECTION
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getProjection
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getProjection
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getProjection
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getProjection
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
break|break;
case|case
name|ENROLLMENT
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getEnrollment
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getEnrollment
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getTotalEnrollment
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getTotalEnrollment
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getTotalEnrollment
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getTotalEnrollment
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
break|break;
case|case
name|WAITLIST
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getWaitlist
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getWaitlist
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getWaitlist
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getWaitlist
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getTotalWaitlist
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getTotalWaitlist
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getTotalWaitlist
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getTotalWaitlist
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
break|break;
case|case
name|RESERVATION
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getReservation
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getReservation
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getReservation
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getReservation
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getTotalReservation
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
name|e1
operator|.
name|getTotalReservation
argument_list|()
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getTotalReservation
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getTotalReservation
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
break|break;
case|case
name|NBR_CONSENT
case|:
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getConsentNeeded
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
operator|new
name|Integer
argument_list|(
name|e1
operator|.
name|getConsentNeeded
argument_list|()
operator|+
name|e1
operator|.
name|getConsentApproved
argument_list|()
argument_list|)
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getConsentNeeded
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getConsentNeeded
argument_list|()
operator|+
name|e2
operator|.
name|getConsentApproved
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
name|cmp
operator|=
operator|(
name|e1
operator|.
name|getTotalConsentNeeded
argument_list|()
operator|==
literal|null
condition|?
operator|new
name|Integer
argument_list|(
literal|0
argument_list|)
else|:
operator|new
name|Integer
argument_list|(
name|e1
operator|.
name|getTotalConsentNeeded
argument_list|()
operator|+
name|e1
operator|.
name|getTotalConsentApproved
argument_list|()
argument_list|)
operator|)
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getTotalConsentNeeded
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|e2
operator|.
name|getTotalConsentNeeded
argument_list|()
operator|+
name|e2
operator|.
name|getTotalConsentApproved
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
operator|-
name|cmp
return|;
break|break;
block|}
comment|// Default sort
name|cmp
operator|=
name|e1
operator|.
name|getSubject
argument_list|()
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getSubject
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
name|cmp
operator|=
name|e1
operator|.
name|getCourseNbr
argument_list|()
operator|.
name|compareTo
argument_list|(
name|e2
operator|.
name|getCourseNbr
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
return|return
literal|0
return|;
block|}
block|}
block|}
end_class

end_unit

