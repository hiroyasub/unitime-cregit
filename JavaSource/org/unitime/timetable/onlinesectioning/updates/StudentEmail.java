begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to The Apereo Foundation under one or more contributor license  * agreements. See the NOTICE file distributed with this work for  * additional information regarding copyright ownership.  *  * The Apereo Foundation licenses this file to you under the Apache License,  * Version 2.0 (the "License"); you may not use this file except in  * compliance with the License. You may obtain a copy of the License at:  *  * http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  *  * See the License for the specific language governing permissions and  * limitations under the License.  *  */
end_comment

begin_package
package|package
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|updates
package|;
end_package

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|BasicStroke
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Color
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Font
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Graphics2D
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|RenderingHints
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Stroke
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|image
operator|.
name|BufferedImage
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|ByteArrayInputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|ByteArrayOutputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|InputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|OutputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|PrintWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|StringWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|net
operator|.
name|URL
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collection
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Date
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Enumeration
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Hashtable
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|StringTokenizer
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|TreeSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Matcher
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Pattern
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|activation
operator|.
name|DataSource
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|imageio
operator|.
name|ImageIO
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|mail
operator|.
name|internet
operator|.
name|AddressException
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|mail
operator|.
name|internet
operator|.
name|InternetAddress
import|;
end_import

begin_import
import|import
name|org
operator|.
name|cpsolver
operator|.
name|ifs
operator|.
name|util
operator|.
name|ToolBox
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|Email
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|localization
operator|.
name|impl
operator|.
name|Localization
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|defaults
operator|.
name|ApplicationProperty
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|GwtMessages
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|StudentSectioningConstants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|resources
operator|.
name|StudentSectioningMessages
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|server
operator|.
name|DayCode
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|SectioningException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|CheckCoursesResponse
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|FreeTime
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|Preference
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|Request
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|RequestedCourse
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|CourseRequestInterface
operator|.
name|RequestedCourseStatus
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|OnlineSectioningInterface
operator|.
name|AdvisingStudentDetails
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|gwt
operator|.
name|shared
operator|.
name|OnlineSectioningInterface
operator|.
name|StudentStatusInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Advisor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|AdvisorCourseRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|StudentSectioningStatus
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|TimetableManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|StudentDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|AcademicSessionInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|OnlineSectioningAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|OnlineSectioningHelper
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|OnlineSectioningLog
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|OnlineSectioningServer
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|OnlineSectioningServer
operator|.
name|Lock
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|advisors
operator|.
name|AdvisorConfirmationPDF
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|advisors
operator|.
name|AdvisorGetCourseRequests
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|basic
operator|.
name|GetRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|custom
operator|.
name|CourseUrlProvider
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XCourse
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XCourseId
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XCourseRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XEnrollment
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XFreeTimeRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XInstructor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XOffering
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XRequest
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XRoom
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XSection
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XStudent
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XSubpart
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|model
operator|.
name|XTime
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|server
operator|.
name|CheckMaster
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|onlinesectioning
operator|.
name|server
operator|.
name|CheckMaster
operator|.
name|Master
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Constants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Formats
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|NameFormat
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Formats
operator|.
name|Format
import|;
end_import

begin_import
import|import
name|freemarker
operator|.
name|template
operator|.
name|Configuration
import|;
end_import

begin_import
import|import
name|freemarker
operator|.
name|template
operator|.
name|Template
import|;
end_import

begin_import
import|import
name|freemarker
operator|.
name|template
operator|.
name|TemplateException
import|;
end_import

begin_comment
comment|/**  * @author Tomas Muller  */
end_comment

begin_class
annotation|@
name|CheckMaster
argument_list|(
name|Master
operator|.
name|REQUIRED
argument_list|)
specifier|public
class|class
name|StudentEmail
implements|implements
name|OnlineSectioningAction
argument_list|<
name|Boolean
argument_list|>
block|{
specifier|private
specifier|static
specifier|final
name|long
name|serialVersionUID
init|=
literal|1L
decl_stmt|;
specifier|private
specifier|static
name|StudentSectioningMessages
name|MSG
init|=
name|Localization
operator|.
name|create
argument_list|(
name|StudentSectioningMessages
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|private
specifier|static
name|StudentSectioningConstants
name|CONST
init|=
name|Localization
operator|.
name|create
argument_list|(
name|StudentSectioningConstants
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|private
specifier|static
name|GwtMessages
name|GWT
init|=
name|Localization
operator|.
name|create
argument_list|(
name|GwtMessages
operator|.
name|class
argument_list|)
decl_stmt|;
specifier|private
name|Date
name|iTimeStamp
init|=
operator|new
name|Date
argument_list|()
decl_stmt|;
specifier|private
specifier|static
name|Format
argument_list|<
name|Date
argument_list|>
name|sTimeStampFormat
init|=
name|Formats
operator|.
name|getDateFormat
argument_list|(
name|Formats
operator|.
name|Pattern
operator|.
name|DATE_TIME_STAMP
argument_list|)
decl_stmt|;
specifier|private
specifier|static
name|Format
argument_list|<
name|Date
argument_list|>
name|sConsentApprovalDateFormat
init|=
name|Formats
operator|.
name|getDateFormat
argument_list|(
name|Formats
operator|.
name|Pattern
operator|.
name|DATE_REQUEST
argument_list|)
decl_stmt|;
specifier|private
name|String
name|iSubject
init|=
name|MSG
operator|.
name|emailDeafultSubject
argument_list|()
decl_stmt|,
name|iSubjectExt
init|=
literal|null
decl_stmt|,
name|iMessage
init|=
literal|null
decl_stmt|,
name|iCC
init|=
literal|null
decl_stmt|;
specifier|private
specifier|static
name|Hashtable
argument_list|<
name|Long
argument_list|,
name|String
argument_list|>
name|sLastMessage
init|=
operator|new
name|Hashtable
argument_list|<
name|Long
argument_list|,
name|String
argument_list|>
argument_list|()
decl_stmt|;
specifier|private
name|byte
index|[]
name|iTimetableImage
init|=
literal|null
decl_stmt|;
specifier|private
name|byte
index|[]
name|iAdvisorRequestsPDF
init|=
literal|null
decl_stmt|;
specifier|private
name|Long
name|iStudentId
decl_stmt|;
specifier|private
name|XOffering
name|iOldOffering
decl_stmt|;
specifier|private
name|XCourseId
name|iOldCourseId
decl_stmt|;
specifier|private
name|XEnrollment
name|iOldEnrollment
decl_stmt|;
specifier|private
name|XStudent
name|iOldStudent
decl_stmt|;
specifier|private
name|XStudent
name|iStudent
decl_stmt|;
specifier|private
name|CourseUrlProvider
name|iCourseUrlProvider
init|=
literal|null
decl_stmt|;
specifier|private
name|boolean
name|iPermisionCheck
init|=
literal|true
decl_stmt|;
specifier|private
name|boolean
name|iIncludeCourseRequests
init|=
literal|true
decl_stmt|;
specifier|private
name|boolean
name|iIncludeClassSchedule
init|=
literal|true
decl_stmt|;
specifier|private
name|boolean
name|iIncludeAdvisorRequests
init|=
literal|false
decl_stmt|;
specifier|private
name|boolean
name|iIncludeAdvisorRequestsPDF
init|=
literal|false
decl_stmt|;
specifier|public
name|StudentEmail
name|forStudent
parameter_list|(
name|Long
name|studentId
parameter_list|)
block|{
name|iStudentId
operator|=
name|studentId
expr_stmt|;
return|return
name|this
return|;
block|}
specifier|public
name|StudentEmail
name|oldEnrollment
parameter_list|(
name|XOffering
name|oldOffering
parameter_list|,
name|XCourseId
name|oldCourseId
parameter_list|,
name|XEnrollment
name|oldEnrollment
parameter_list|)
block|{
name|iOldOffering
operator|=
name|oldOffering
expr_stmt|;
name|iOldCourseId
operator|=
name|oldCourseId
expr_stmt|;
name|iOldEnrollment
operator|=
name|oldEnrollment
expr_stmt|;
return|return
name|this
return|;
block|}
specifier|public
name|StudentEmail
name|oldStudent
parameter_list|(
name|XStudent
name|oldStudent
parameter_list|)
block|{
name|iOldStudent
operator|=
name|oldStudent
expr_stmt|;
return|return
name|this
return|;
block|}
specifier|public
name|StudentEmail
name|overridePermissions
parameter_list|(
name|boolean
name|courseRequests
parameter_list|,
name|boolean
name|classSchedule
parameter_list|,
name|boolean
name|advisorRequests
parameter_list|)
block|{
name|iPermisionCheck
operator|=
literal|false
expr_stmt|;
name|iIncludeCourseRequests
operator|=
name|courseRequests
expr_stmt|;
name|iIncludeClassSchedule
operator|=
name|classSchedule
expr_stmt|;
name|iIncludeAdvisorRequests
operator|=
name|advisorRequests
expr_stmt|;
return|return
name|this
return|;
block|}
specifier|public
name|StudentEmail
name|includeAdvisorRequestsPDF
parameter_list|()
block|{
name|iIncludeAdvisorRequestsPDF
operator|=
literal|true
expr_stmt|;
return|return
name|this
return|;
block|}
specifier|public
name|Long
name|getStudentId
parameter_list|()
block|{
return|return
name|iStudentId
return|;
block|}
specifier|public
name|Date
name|getTimeStamp
parameter_list|()
block|{
return|return
name|iTimeStamp
return|;
block|}
specifier|private
name|String
name|getSubject
parameter_list|()
block|{
return|return
name|iSubject
return|;
block|}
specifier|private
name|void
name|setSubject
parameter_list|(
name|String
name|subject
parameter_list|)
block|{
name|iSubject
operator|=
name|subject
expr_stmt|;
block|}
specifier|public
name|String
name|getEmailSubject
parameter_list|()
block|{
return|return
name|iSubjectExt
return|;
block|}
specifier|public
name|void
name|setEmailSubject
parameter_list|(
name|String
name|subject
parameter_list|)
block|{
name|iSubjectExt
operator|=
name|subject
expr_stmt|;
block|}
specifier|public
name|String
name|getMessage
parameter_list|()
block|{
return|return
name|iMessage
return|;
block|}
specifier|public
name|void
name|setMessage
parameter_list|(
name|String
name|message
parameter_list|)
block|{
name|iMessage
operator|=
name|message
expr_stmt|;
block|}
specifier|public
name|String
name|getCC
parameter_list|()
block|{
return|return
name|iCC
return|;
block|}
specifier|public
name|void
name|setCC
parameter_list|(
name|String
name|cc
parameter_list|)
block|{
name|iCC
operator|=
name|cc
expr_stmt|;
block|}
specifier|public
name|XEnrollment
name|getOldEnrollment
parameter_list|()
block|{
return|return
name|iOldEnrollment
return|;
block|}
specifier|public
name|XOffering
name|getOldOffering
parameter_list|()
block|{
return|return
name|iOldOffering
return|;
block|}
specifier|public
name|XCourse
name|getOldCourse
parameter_list|()
block|{
return|return
operator|(
name|iOldOffering
operator|==
literal|null
operator|||
name|iOldCourseId
operator|==
literal|null
condition|?
literal|null
else|:
name|iOldOffering
operator|.
name|getCourse
argument_list|(
name|iOldCourseId
argument_list|)
operator|)
return|;
block|}
specifier|public
name|XStudent
name|getOldStudent
parameter_list|()
block|{
return|return
name|iOldStudent
return|;
block|}
specifier|public
name|XStudent
name|getStudent
parameter_list|()
block|{
return|return
name|iStudent
return|;
block|}
specifier|public
name|void
name|setStudent
parameter_list|(
name|XStudent
name|student
parameter_list|)
block|{
name|iStudent
operator|=
name|student
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|Boolean
name|execute
parameter_list|(
specifier|final
name|OnlineSectioningServer
name|server
parameter_list|,
specifier|final
name|OnlineSectioningHelper
name|helper
parameter_list|)
block|{
try|try
block|{
name|String
name|providerClass
init|=
name|ApplicationProperty
operator|.
name|CustomizationCourseLink
operator|.
name|value
argument_list|()
decl_stmt|;
if|if
condition|(
name|providerClass
operator|!=
literal|null
condition|)
name|iCourseUrlProvider
operator|=
operator|(
name|CourseUrlProvider
operator|)
name|Class
operator|.
name|forName
argument_list|(
name|providerClass
argument_list|)
operator|.
name|newInstance
argument_list|()
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
block|}
name|Lock
name|lock
init|=
name|server
operator|.
name|lockStudent
argument_list|(
name|getStudentId
argument_list|()
argument_list|,
literal|null
argument_list|,
name|name
argument_list|()
argument_list|)
decl_stmt|;
try|try
block|{
name|OnlineSectioningLog
operator|.
name|Action
operator|.
name|Builder
name|action
init|=
name|helper
operator|.
name|getAction
argument_list|()
decl_stmt|;
name|action
operator|.
name|setStudent
argument_list|(
name|OnlineSectioningLog
operator|.
name|Entity
operator|.
name|newBuilder
argument_list|()
operator|.
name|setUniqueId
argument_list|(
name|getStudentId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|getOldEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|Builder
name|enrollment
init|=
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|newBuilder
argument_list|()
decl_stmt|;
name|enrollment
operator|.
name|setType
argument_list|(
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|EnrollmentType
operator|.
name|PREVIOUS
argument_list|)
expr_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|getOldOffering
argument_list|()
operator|.
name|getSections
argument_list|(
name|getOldEnrollment
argument_list|()
argument_list|)
control|)
name|enrollment
operator|.
name|addSection
argument_list|(
name|OnlineSectioningHelper
operator|.
name|toProto
argument_list|(
name|section
argument_list|,
name|getOldEnrollment
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|action
operator|.
name|addEnrollment
argument_list|(
name|enrollment
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|getOldStudent
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|Builder
name|enrollment
init|=
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|newBuilder
argument_list|()
decl_stmt|;
name|enrollment
operator|.
name|setType
argument_list|(
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|EnrollmentType
operator|.
name|PREVIOUS
argument_list|)
expr_stmt|;
for|for
control|(
name|XRequest
name|r
range|:
name|getOldStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
name|XEnrollment
name|e
init|=
operator|(
name|r
operator|instanceof
name|XCourseRequest
condition|?
operator|(
operator|(
name|XCourseRequest
operator|)
name|r
operator|)
operator|.
name|getEnrollment
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
if|if
condition|(
name|e
operator|!=
literal|null
condition|)
for|for
control|(
name|XSection
name|section
range|:
name|server
operator|.
name|getOffering
argument_list|(
name|e
operator|.
name|getOfferingId
argument_list|()
argument_list|)
operator|.
name|getSections
argument_list|(
name|e
argument_list|)
control|)
name|enrollment
operator|.
name|addSection
argument_list|(
name|OnlineSectioningHelper
operator|.
name|toProto
argument_list|(
name|section
argument_list|,
name|e
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|action
operator|.
name|addEnrollment
argument_list|(
name|enrollment
argument_list|)
expr_stmt|;
block|}
specifier|final
name|XStudent
name|student
init|=
name|server
operator|.
name|getStudent
argument_list|(
name|getStudentId
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|student
operator|==
literal|null
condition|)
return|return
literal|false
return|;
name|setStudent
argument_list|(
name|student
argument_list|)
expr_stmt|;
name|action
operator|.
name|getStudentBuilder
argument_list|()
operator|.
name|setUniqueId
argument_list|(
name|student
operator|.
name|getStudentId
argument_list|()
argument_list|)
operator|.
name|setExternalId
argument_list|(
name|student
operator|.
name|getExternalId
argument_list|()
argument_list|)
operator|.
name|setName
argument_list|(
name|student
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|Builder
name|enrollment
init|=
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|newBuilder
argument_list|()
decl_stmt|;
name|enrollment
operator|.
name|setType
argument_list|(
name|OnlineSectioningLog
operator|.
name|Enrollment
operator|.
name|EnrollmentType
operator|.
name|STORED
argument_list|)
expr_stmt|;
for|for
control|(
name|XRequest
name|r
range|:
name|student
operator|.
name|getRequests
argument_list|()
control|)
block|{
name|action
operator|.
name|addRequest
argument_list|(
name|OnlineSectioningHelper
operator|.
name|toProto
argument_list|(
name|r
argument_list|)
argument_list|)
expr_stmt|;
name|XEnrollment
name|e
init|=
operator|(
name|r
operator|instanceof
name|XCourseRequest
condition|?
operator|(
operator|(
name|XCourseRequest
operator|)
name|r
operator|)
operator|.
name|getEnrollment
argument_list|()
else|:
literal|null
operator|)
decl_stmt|;
if|if
condition|(
name|e
operator|!=
literal|null
condition|)
for|for
control|(
name|XSection
name|section
range|:
name|server
operator|.
name|getOffering
argument_list|(
name|e
operator|.
name|getOfferingId
argument_list|()
argument_list|)
operator|.
name|getSections
argument_list|(
name|e
argument_list|)
control|)
name|enrollment
operator|.
name|addSection
argument_list|(
name|OnlineSectioningHelper
operator|.
name|toProto
argument_list|(
name|section
argument_list|,
name|e
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|action
operator|.
name|addEnrollment
argument_list|(
name|enrollment
argument_list|)
expr_stmt|;
name|boolean
name|ret
init|=
literal|false
decl_stmt|;
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
name|dbStudent
init|=
name|StudentDAO
operator|.
name|getInstance
argument_list|()
operator|.
name|get
argument_list|(
name|getStudentId
argument_list|()
argument_list|,
name|helper
operator|.
name|getHibSession
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|dbStudent
operator|!=
literal|null
operator|&&
name|dbStudent
operator|.
name|getEmail
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|dbStudent
operator|.
name|getEmail
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|action
operator|.
name|getStudentBuilder
argument_list|()
operator|.
name|setName
argument_list|(
name|dbStudent
operator|.
name|getEmail
argument_list|()
argument_list|)
expr_stmt|;
name|boolean
name|emailEnabled
init|=
literal|true
decl_stmt|;
if|if
condition|(
name|iPermisionCheck
condition|)
block|{
name|StudentSectioningStatus
name|status
init|=
name|dbStudent
operator|.
name|getEffectiveStatus
argument_list|()
decl_stmt|;
if|if
condition|(
name|status
operator|!=
literal|null
operator|&&
operator|!
name|status
operator|.
name|hasOption
argument_list|(
name|StudentSectioningStatus
operator|.
name|Option
operator|.
name|email
argument_list|)
condition|)
block|{
name|emailEnabled
operator|=
literal|false
expr_stmt|;
block|}
if|if
condition|(
name|iIncludeClassSchedule
operator|&&
name|status
operator|!=
literal|null
operator|&&
operator|!
name|status
operator|.
name|hasOption
argument_list|(
name|StudentSectioningStatus
operator|.
name|Option
operator|.
name|enabled
argument_list|)
condition|)
name|iIncludeClassSchedule
operator|=
literal|false
expr_stmt|;
if|if
condition|(
name|iIncludeCourseRequests
operator|&&
name|status
operator|!=
literal|null
operator|&&
operator|!
name|status
operator|.
name|hasOption
argument_list|(
name|StudentSectioningStatus
operator|.
name|Option
operator|.
name|registration
argument_list|)
condition|)
name|iIncludeCourseRequests
operator|=
literal|false
expr_stmt|;
block|}
else|else
block|{
name|emailEnabled
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|emailEnabled
condition|)
block|{
specifier|final
name|String
name|html
init|=
name|generateMessage
argument_list|(
name|dbStudent
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
decl_stmt|;
if|if
condition|(
name|html
operator|!=
literal|null
condition|)
block|{
name|Email
name|email
init|=
name|Email
operator|.
name|createEmail
argument_list|()
decl_stmt|;
name|email
operator|.
name|addRecipient
argument_list|(
name|dbStudent
operator|.
name|getEmail
argument_list|()
argument_list|,
name|helper
operator|.
name|getStudentNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|dbStudent
argument_list|)
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"recipient"
argument_list|,
name|dbStudent
operator|.
name|getEmail
argument_list|()
argument_list|)
expr_stmt|;
name|String
name|firstCarbonCopy
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|getCC
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|getCC
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|String
name|suffix
init|=
name|ApplicationProperty
operator|.
name|EmailDefaultAddressSuffix
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|StringTokenizer
name|s
init|=
operator|new
name|StringTokenizer
argument_list|(
name|getCC
argument_list|()
argument_list|,
literal|",;\n"
argument_list|)
init|;
name|s
operator|.
name|hasMoreTokens
argument_list|()
condition|;
control|)
block|{
name|String
name|address
init|=
name|s
operator|.
name|nextToken
argument_list|()
operator|.
name|trim
argument_list|()
decl_stmt|;
if|if
condition|(
name|address
operator|.
name|isEmpty
argument_list|()
condition|)
continue|continue;
if|if
condition|(
name|suffix
operator|!=
literal|null
operator|&&
name|address
operator|.
name|indexOf
argument_list|(
literal|'@'
argument_list|)
operator|<
literal|0
condition|)
name|address
operator|+=
name|suffix
expr_stmt|;
try|try
block|{
operator|new
name|InternetAddress
argument_list|(
name|address
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|AddressException
name|e
parameter_list|)
block|{
name|helper
operator|.
name|warn
argument_list|(
name|GWT
operator|.
name|badEmailAddress
argument_list|(
name|address
argument_list|,
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|email
operator|.
name|addRecipientCC
argument_list|(
name|address
argument_list|,
literal|null
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"cc"
argument_list|,
name|address
argument_list|)
expr_stmt|;
if|if
condition|(
name|firstCarbonCopy
operator|==
literal|null
condition|)
name|firstCarbonCopy
operator|=
name|address
expr_stmt|;
block|}
block|}
if|if
condition|(
name|getEmailSubject
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|getEmailSubject
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|email
operator|.
name|setSubject
argument_list|(
name|getEmailSubject
argument_list|()
operator|.
name|replace
argument_list|(
literal|"%session%"
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"subject"
argument_list|,
name|getEmailSubject
argument_list|()
operator|.
name|replace
argument_list|(
literal|"%session%"
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|email
operator|.
name|setSubject
argument_list|(
name|getSubject
argument_list|()
operator|.
name|replace
argument_list|(
literal|"%session%"
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|getMessage
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|getMessage
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|helper
operator|.
name|logOption
argument_list|(
literal|"message"
argument_list|,
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|helper
operator|.
name|getUser
argument_list|()
operator|!=
literal|null
operator|&&
name|getOldEnrollment
argument_list|()
operator|==
literal|null
operator|&&
name|getOldStudent
argument_list|()
operator|==
literal|null
condition|)
block|{
name|TimetableManager
name|manager
init|=
operator|(
name|TimetableManager
operator|)
name|helper
operator|.
name|getHibSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"from TimetableManager where externalUniqueId = :id"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"id"
argument_list|,
name|helper
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalId
argument_list|()
argument_list|)
operator|.
name|uniqueResult
argument_list|()
decl_stmt|;
name|Advisor
name|advisor
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|manager
operator|==
literal|null
operator|||
name|manager
operator|.
name|getEmailAddress
argument_list|()
operator|==
literal|null
condition|)
name|advisor
operator|=
operator|(
name|Advisor
operator|)
name|helper
operator|.
name|getHibSession
argument_list|()
operator|.
name|createQuery
argument_list|(
literal|"from Advisor where externalUniqueId = :externalId and session.uniqueId = :sessionId"
argument_list|)
operator|.
name|setString
argument_list|(
literal|"externalId"
argument_list|,
name|helper
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalId
argument_list|()
argument_list|)
operator|.
name|setLong
argument_list|(
literal|"sessionId"
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|setMaxResults
argument_list|(
literal|1
argument_list|)
operator|.
name|uniqueResult
argument_list|()
expr_stmt|;
if|if
condition|(
name|manager
operator|!=
literal|null
operator|&&
name|manager
operator|.
name|getEmailAddress
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|email
operator|.
name|setReplyTo
argument_list|(
name|manager
operator|.
name|getEmailAddress
argument_list|()
argument_list|,
name|helper
operator|.
name|getInstructorNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|manager
argument_list|)
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"reply-to"
argument_list|,
name|helper
operator|.
name|getInstructorNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|manager
argument_list|)
operator|+
literal|"<"
operator|+
name|manager
operator|.
name|getEmailAddress
argument_list|()
operator|+
literal|">"
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|advisor
operator|!=
literal|null
operator|&&
name|advisor
operator|.
name|getEmail
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|email
operator|.
name|setReplyTo
argument_list|(
name|advisor
operator|.
name|getEmail
argument_list|()
argument_list|,
name|helper
operator|.
name|getInstructorNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|advisor
argument_list|)
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"reply-to"
argument_list|,
name|helper
operator|.
name|getInstructorNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|advisor
argument_list|)
operator|+
literal|"<"
operator|+
name|advisor
operator|.
name|getEmail
argument_list|()
operator|+
literal|">"
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|firstCarbonCopy
operator|!=
literal|null
condition|)
block|{
name|email
operator|.
name|setReplyTo
argument_list|(
name|firstCarbonCopy
argument_list|,
literal|null
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"reply-to"
argument_list|,
name|firstCarbonCopy
argument_list|)
expr_stmt|;
block|}
block|}
name|String
name|additionalCC
init|=
name|ApplicationProperty
operator|.
name|OnlineSchedulingEmailCarbonCopy
operator|.
name|value
argument_list|()
decl_stmt|;
if|if
condition|(
name|additionalCC
operator|!=
literal|null
condition|)
block|{
name|String
name|suffix
init|=
name|ApplicationProperty
operator|.
name|EmailDefaultAddressSuffix
operator|.
name|value
argument_list|()
decl_stmt|;
for|for
control|(
name|String
name|address
range|:
name|additionalCC
operator|.
name|split
argument_list|(
literal|"[\n,]"
argument_list|)
control|)
block|{
name|String
name|cc
init|=
name|address
operator|.
name|trim
argument_list|()
decl_stmt|;
if|if
condition|(
name|cc
operator|.
name|isEmpty
argument_list|()
condition|)
continue|continue;
if|if
condition|(
name|suffix
operator|!=
literal|null
operator|&&
name|cc
operator|.
name|indexOf
argument_list|(
literal|'@'
argument_list|)
operator|<
literal|0
condition|)
name|cc
operator|+=
name|suffix
expr_stmt|;
name|email
operator|.
name|addRecipientCC
argument_list|(
name|cc
argument_list|,
literal|null
argument_list|)
expr_stmt|;
block|}
block|}
specifier|final
name|StringWriter
name|buffer
init|=
operator|new
name|StringWriter
argument_list|()
decl_stmt|;
if|if
condition|(
name|ApplicationProperty
operator|.
name|OnlineSchedulingEmailIncludeMessage
operator|.
name|isTrue
argument_list|()
condition|)
block|{
name|PrintWriter
name|out
init|=
operator|new
name|PrintWriter
argument_list|(
name|buffer
argument_list|)
decl_stmt|;
name|generateTimetable
argument_list|(
name|out
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
expr_stmt|;
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
name|email
operator|.
name|addAttachment
argument_list|(
operator|new
name|DataSource
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|OutputStream
name|getOutputStream
parameter_list|()
throws|throws
name|IOException
block|{
throw|throw
operator|new
name|IOException
argument_list|(
literal|"No output stream."
argument_list|)
throw|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|"message.html"
return|;
block|}
annotation|@
name|Override
specifier|public
name|InputStream
name|getInputStream
parameter_list|()
throws|throws
name|IOException
block|{
return|return
operator|new
name|ByteArrayInputStream
argument_list|(
name|html
operator|.
name|replace
argument_list|(
literal|"<img src='cid:timetable.png' border='0' alt='Timetable Grid'/>"
argument_list|,
name|buffer
operator|.
name|toString
argument_list|()
argument_list|)
operator|.
name|getBytes
argument_list|(
literal|"UTF-8"
argument_list|)
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getContentType
parameter_list|()
block|{
return|return
literal|"text/html; charset=UTF-8"
return|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iTimetableImage
operator|!=
literal|null
condition|)
block|{
name|email
operator|.
name|addAttachment
argument_list|(
operator|new
name|DataSource
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|OutputStream
name|getOutputStream
parameter_list|()
throws|throws
name|IOException
block|{
throw|throw
operator|new
name|IOException
argument_list|(
literal|"No output stream."
argument_list|)
throw|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|"timetable.png"
return|;
block|}
annotation|@
name|Override
specifier|public
name|InputStream
name|getInputStream
parameter_list|()
throws|throws
name|IOException
block|{
return|return
operator|new
name|ByteArrayInputStream
argument_list|(
name|iTimetableImage
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getContentType
parameter_list|()
block|{
return|return
literal|"image/png"
return|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iAdvisorRequestsPDF
operator|!=
literal|null
condition|)
block|{
name|email
operator|.
name|addAttachment
argument_list|(
operator|new
name|DataSource
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|OutputStream
name|getOutputStream
parameter_list|()
throws|throws
name|IOException
block|{
throw|throw
operator|new
name|IOException
argument_list|(
literal|"No output stream."
argument_list|)
throw|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|"recommendations-"
operator|+
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getTerm
argument_list|()
operator|+
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getYear
argument_list|()
operator|+
literal|"-"
operator|+
name|student
operator|.
name|getName
argument_list|()
operator|.
name|replaceAll
argument_list|(
literal|"[&$\\+,/:;=\\?@<>\\[\\]\\{\\}\\|\\^\\~%#`\\t\\s\\n\\r \\\\]"
argument_list|,
literal|""
argument_list|)
operator|+
literal|".pdf"
return|;
block|}
annotation|@
name|Override
specifier|public
name|InputStream
name|getInputStream
parameter_list|()
throws|throws
name|IOException
block|{
return|return
operator|new
name|ByteArrayInputStream
argument_list|(
name|iAdvisorRequestsPDF
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getContentType
parameter_list|()
block|{
return|return
literal|"application/pdf"
return|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ApplicationProperty
operator|.
name|OnlineSchedulingEmailICalendar
operator|.
name|isTrue
argument_list|()
operator|&&
name|iIncludeClassSchedule
condition|)
block|{
try|try
block|{
specifier|final
name|String
name|calendar
init|=
name|CalendarExport
operator|.
name|getCalendar
argument_list|(
name|server
argument_list|,
name|helper
argument_list|,
name|student
argument_list|)
decl_stmt|;
if|if
condition|(
name|calendar
operator|!=
literal|null
condition|)
name|email
operator|.
name|addAttachment
argument_list|(
operator|new
name|DataSource
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|OutputStream
name|getOutputStream
parameter_list|()
throws|throws
name|IOException
block|{
throw|throw
operator|new
name|IOException
argument_list|(
literal|"No output stream."
argument_list|)
throw|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|"timetable.ics"
return|;
block|}
annotation|@
name|Override
specifier|public
name|InputStream
name|getInputStream
parameter_list|()
throws|throws
name|IOException
block|{
return|return
operator|new
name|ByteArrayInputStream
argument_list|(
name|calendar
operator|.
name|getBytes
argument_list|(
literal|"UTF-8"
argument_list|)
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getContentType
parameter_list|()
block|{
return|return
literal|"text/calendar; charset=UTF-8"
return|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|IOException
name|e
parameter_list|)
block|{
name|helper
operator|.
name|warn
argument_list|(
literal|"Unable to create calendar for student "
operator|+
name|student
operator|.
name|getStudentId
argument_list|()
operator|+
literal|":"
operator|+
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
name|String
name|lastMessageId
init|=
name|sLastMessage
operator|.
name|get
argument_list|(
name|student
operator|.
name|getStudentId
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|lastMessageId
operator|!=
literal|null
condition|)
name|email
operator|.
name|setInReplyTo
argument_list|(
name|lastMessageId
argument_list|)
expr_stmt|;
name|email
operator|.
name|setHTML
argument_list|(
name|html
argument_list|)
expr_stmt|;
name|helper
operator|.
name|logOption
argument_list|(
literal|"email"
argument_list|,
name|html
operator|.
name|replace
argument_list|(
literal|"<img src='cid:timetable.png' border='0' alt='Timetable Image'/>"
argument_list|,
name|buffer
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|email
operator|.
name|send
argument_list|()
expr_stmt|;
name|String
name|messageId
init|=
name|email
operator|.
name|getMessageId
argument_list|()
decl_stmt|;
if|if
condition|(
name|messageId
operator|!=
literal|null
condition|)
name|sLastMessage
operator|.
name|put
argument_list|(
name|student
operator|.
name|getStudentId
argument_list|()
argument_list|,
name|messageId
argument_list|)
expr_stmt|;
name|Date
name|ts
init|=
operator|new
name|Date
argument_list|()
decl_stmt|;
name|dbStudent
operator|.
name|setScheduleEmailedDate
argument_list|(
name|ts
argument_list|)
expr_stmt|;
name|student
operator|.
name|setEmailTimeStamp
argument_list|(
name|ts
argument_list|)
expr_stmt|;
name|helper
operator|.
name|getHibSession
argument_list|()
operator|.
name|saveOrUpdate
argument_list|(
name|dbStudent
argument_list|)
expr_stmt|;
name|helper
operator|.
name|getHibSession
argument_list|()
operator|.
name|flush
argument_list|()
expr_stmt|;
name|server
operator|.
name|update
argument_list|(
name|student
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|ret
operator|=
literal|true
expr_stmt|;
block|}
else|else
block|{
name|helper
operator|.
name|debug
argument_list|(
literal|"Email notification failed to generate for student "
operator|+
name|student
operator|.
name|getName
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|helper
operator|.
name|debug
argument_list|(
literal|"Email notification is disabled for student "
operator|+
name|student
operator|.
name|getName
argument_list|()
operator|+
literal|"."
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|helper
operator|.
name|debug
argument_list|(
literal|"Student "
operator|+
name|student
operator|.
name|getName
argument_list|()
operator|+
literal|" has no email address on file."
argument_list|)
expr_stmt|;
block|}
return|return
name|ret
return|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
if|if
condition|(
name|e
operator|instanceof
name|SectioningException
condition|)
throw|throw
operator|(
name|SectioningException
operator|)
name|e
throw|;
throw|throw
operator|new
name|SectioningException
argument_list|(
name|MSG
operator|.
name|exceptionUnknown
argument_list|(
name|e
operator|.
name|getMessage
argument_list|()
argument_list|)
argument_list|,
name|e
argument_list|)
throw|;
block|}
finally|finally
block|{
name|lock
operator|.
name|release
argument_list|()
expr_stmt|;
block|}
block|}
annotation|@
name|Override
specifier|public
name|String
name|name
parameter_list|()
block|{
return|return
literal|"student-email"
return|;
block|}
specifier|private
specifier|static
name|String
index|[]
name|sColor1
init|=
operator|new
name|String
index|[]
block|{
literal|"2952A3"
block|,
comment|//"A32929",
literal|"B1365F"
block|,
literal|"7A367A"
block|,
literal|"5229A3"
block|,
literal|"29527A"
block|,
literal|"1B887A"
block|,
literal|"28754E"
block|,
literal|"0D7813"
block|,
literal|"528800"
block|,
literal|"88880E"
block|,
literal|"AB8B00"
block|,
literal|"BE6D00"
block|,
literal|"B1440E"
block|,
literal|"865A5A"
block|,
literal|"705770"
block|,
literal|"4E5D6C"
block|,
literal|"5A6986"
block|,
literal|"4A716C"
block|,
literal|"6E6E41"
block|,
literal|"8D6F47"
block|}
decl_stmt|;
specifier|private
specifier|static
name|String
index|[]
name|sColor2
init|=
operator|new
name|String
index|[]
block|{
literal|"668CD9"
block|,
comment|//"D96666",
literal|"E67399"
block|,
literal|"B373B3"
block|,
literal|"8C66D9"
block|,
literal|"668CB3"
block|,
literal|"59BFB3"
block|,
literal|"65AD89"
block|,
literal|"4CB052"
block|,
literal|"8CBF40"
block|,
literal|"BFBF4D"
block|,
literal|"E0C240"
block|,
literal|"F2A640"
block|,
literal|"E6804D"
block|,
literal|"BE9494"
block|,
literal|"A992A9"
block|,
literal|"8997A5"
block|,
literal|"94A2bE"
block|,
literal|"85AAA5"
block|,
literal|"A7A77D"
block|,
literal|"C4A883"
block|}
decl_stmt|;
specifier|protected
name|URL
name|getCourseUrl
parameter_list|(
name|AcademicSessionInfo
name|session
parameter_list|,
name|XCourse
name|course
parameter_list|)
block|{
if|if
condition|(
name|iCourseUrlProvider
operator|==
literal|null
condition|)
return|return
literal|null
return|;
return|return
name|iCourseUrlProvider
operator|.
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
return|;
block|}
specifier|private
name|String
name|generateMessage
parameter_list|(
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
name|student
parameter_list|,
name|OnlineSectioningServer
name|server
parameter_list|,
name|OnlineSectioningHelper
name|helper
parameter_list|)
throws|throws
name|IOException
throws|,
name|TemplateException
block|{
name|Configuration
name|cfg
init|=
operator|new
name|Configuration
argument_list|(
name|Configuration
operator|.
name|VERSION_2_3_0
argument_list|)
decl_stmt|;
name|cfg
operator|.
name|setClassForTemplateLoading
argument_list|(
name|StudentEmail
operator|.
name|class
argument_list|,
literal|"/"
argument_list|)
expr_stmt|;
name|cfg
operator|.
name|setLocale
argument_list|(
name|Localization
operator|.
name|getJavaLocale
argument_list|()
argument_list|)
expr_stmt|;
name|cfg
operator|.
name|setOutputEncoding
argument_list|(
literal|"utf-8"
argument_list|)
expr_stmt|;
name|Template
name|template
init|=
name|cfg
operator|.
name|getTemplate
argument_list|(
name|ApplicationProperty
operator|.
name|OnlineSchedulingEmailTemplate
operator|.
name|value
argument_list|()
argument_list|)
decl_stmt|;
name|Map
argument_list|<
name|String
argument_list|,
name|Object
argument_list|>
name|input
init|=
operator|new
name|HashMap
argument_list|<
name|String
argument_list|,
name|Object
argument_list|>
argument_list|()
decl_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"msg"
argument_list|,
name|MSG
argument_list|)
expr_stmt|;
if|if
condition|(
name|getEmailSubject
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|getEmailSubject
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|input
operator|.
name|put
argument_list|(
literal|"subject"
argument_list|,
name|getEmailSubject
argument_list|()
operator|.
name|replace
argument_list|(
literal|"%session%"
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"student"
argument_list|,
name|getStudent
argument_list|()
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"name"
argument_list|,
name|helper
operator|.
name|getStudentNameFormat
argument_list|()
operator|.
name|format
argument_list|(
name|student
argument_list|)
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"server"
argument_list|,
name|server
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"helper"
argument_list|,
name|helper
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"message"
argument_list|,
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"dfConsentApproval"
argument_list|,
name|sConsentApprovalDateFormat
argument_list|)
expr_stmt|;
name|StudentSectioningStatus
name|status
init|=
name|student
operator|.
name|getEffectiveStatus
argument_list|()
decl_stmt|;
if|if
condition|(
name|iIncludeCourseRequests
condition|)
block|{
name|CourseRequestInterface
name|requests
init|=
name|server
operator|.
name|createAction
argument_list|(
name|GetRequest
operator|.
name|class
argument_list|)
operator|.
name|forStudent
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|withCustomValidation
argument_list|(
name|status
operator|!=
literal|null
operator|&&
name|status
operator|.
name|hasOption
argument_list|(
name|StudentSectioningStatus
operator|.
name|Option
operator|.
name|reqval
argument_list|)
argument_list|)
operator|.
name|execute
argument_list|(
name|server
argument_list|,
name|helper
argument_list|)
decl_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"requests"
argument_list|,
name|generateCourseRequests
argument_list|(
name|student
argument_list|,
name|requests
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iIncludeAdvisorRequests
condition|)
block|{
name|CourseRequestInterface
name|requests
init|=
name|server
operator|.
name|createAction
argument_list|(
name|AdvisorGetCourseRequests
operator|.
name|class
argument_list|)
operator|.
name|forStudent
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
operator|.
name|checkDemands
argument_list|(
literal|false
argument_list|)
operator|.
name|execute
argument_list|(
name|server
argument_list|,
name|helper
argument_list|)
decl_stmt|;
if|if
condition|(
name|requests
operator|!=
literal|null
operator|&&
operator|(
operator|!
name|requests
operator|.
name|isEmpty
argument_list|()
operator|||
name|requests
operator|.
name|hasCreditNote
argument_list|()
operator|)
condition|)
block|{
name|input
operator|.
name|put
argument_list|(
literal|"advisor"
argument_list|,
name|generateAdvisorRequests
argument_list|(
name|student
argument_list|,
name|requests
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|disclaimer
init|=
name|ApplicationProperty
operator|.
name|AdvisorCourseRequestsPDFDisclaimer
operator|.
name|value
argument_list|()
decl_stmt|;
if|if
condition|(
name|disclaimer
operator|!=
literal|null
operator|&&
operator|!
name|disclaimer
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|input
operator|.
name|put
argument_list|(
literal|"disclaimer"
argument_list|,
name|disclaimer
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iIncludeAdvisorRequestsPDF
condition|)
block|{
name|AdvisingStudentDetails
name|details
init|=
operator|new
name|AdvisingStudentDetails
argument_list|()
decl_stmt|;
name|details
operator|.
name|setSessionId
argument_list|(
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|details
operator|.
name|setStudentId
argument_list|(
name|student
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|details
operator|.
name|setStudentName
argument_list|(
name|student
operator|.
name|getName
argument_list|(
name|NameFormat
operator|.
name|LAST_FIRST_MIDDLE
operator|.
name|reference
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|details
operator|.
name|setSessionName
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
expr_stmt|;
name|Advisor
name|advisor
init|=
name|Advisor
operator|.
name|findByExternalId
argument_list|(
name|helper
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalId
argument_list|()
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|advisor
operator|!=
literal|null
condition|)
name|details
operator|.
name|setAdvisorEmail
argument_list|(
name|advisor
operator|.
name|getEmail
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|details
operator|.
name|hasAdvisorEmail
argument_list|()
condition|)
block|{
name|AdvisorCourseRequest
name|lastAcr
init|=
literal|null
decl_stmt|;
for|for
control|(
name|AdvisorCourseRequest
name|acr
range|:
name|student
operator|.
name|getAdvisorCourseRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|lastAcr
operator|==
literal|null
operator|||
name|lastAcr
operator|.
name|getTimestamp
argument_list|()
operator|.
name|before
argument_list|(
name|acr
operator|.
name|getTimestamp
argument_list|()
argument_list|)
condition|)
name|lastAcr
operator|=
name|acr
expr_stmt|;
block|}
if|if
condition|(
name|lastAcr
operator|!=
literal|null
condition|)
block|{
name|advisor
operator|=
name|Advisor
operator|.
name|findByExternalId
argument_list|(
name|lastAcr
operator|.
name|getChangedBy
argument_list|()
argument_list|,
name|server
operator|.
name|getAcademicSession
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|advisor
operator|!=
literal|null
condition|)
name|details
operator|.
name|setAdvisorEmail
argument_list|(
name|advisor
operator|.
name|getEmail
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|details
operator|.
name|hasAdvisorEmail
argument_list|()
condition|)
block|{
name|String
name|email
init|=
literal|null
decl_stmt|;
for|for
control|(
name|Advisor
name|a
range|:
name|student
operator|.
name|getAdvisors
argument_list|()
control|)
block|{
if|if
condition|(
name|a
operator|.
name|getEmail
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|a
operator|.
name|getEmail
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|email
operator|=
operator|(
name|email
operator|==
literal|null
condition|?
literal|""
else|:
name|email
operator|+
literal|"\n"
operator|)
operator|+
name|a
operator|.
name|getEmail
argument_list|()
expr_stmt|;
block|}
block|}
name|details
operator|.
name|setAdvisorEmail
argument_list|(
name|email
argument_list|)
expr_stmt|;
empty_stmt|;
block|}
if|if
condition|(
operator|!
name|details
operator|.
name|hasAdvisorEmail
argument_list|()
condition|)
block|{
name|TimetableManager
name|manager
init|=
name|TimetableManager
operator|.
name|findByExternalId
argument_list|(
name|helper
operator|.
name|getUser
argument_list|()
operator|.
name|getExternalId
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|manager
operator|!=
literal|null
condition|)
name|details
operator|.
name|setAdvisorEmail
argument_list|(
name|manager
operator|.
name|getEmailAddress
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|student
operator|.
name|getSectioningStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|StudentStatusInfo
name|info
init|=
operator|new
name|StudentStatusInfo
argument_list|()
decl_stmt|;
name|info
operator|.
name|setUniqueId
argument_list|(
name|student
operator|.
name|getSectioningStatus
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|info
operator|.
name|setReference
argument_list|(
name|student
operator|.
name|getSectioningStatus
argument_list|()
operator|.
name|getReference
argument_list|()
argument_list|)
expr_stmt|;
name|info
operator|.
name|setLabel
argument_list|(
name|student
operator|.
name|getSectioningStatus
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
expr_stmt|;
name|details
operator|.
name|setStatus
argument_list|(
name|info
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getDefaultSectioningStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|StudentStatusInfo
name|info
init|=
operator|new
name|StudentStatusInfo
argument_list|()
decl_stmt|;
name|info
operator|.
name|setUniqueId
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|info
operator|.
name|setReference
argument_list|(
literal|""
argument_list|)
expr_stmt|;
name|info
operator|.
name|setLabel
argument_list|(
name|MSG
operator|.
name|studentStatusSessionDefault
argument_list|(
name|student
operator|.
name|getSession
argument_list|()
operator|.
name|getDefaultSectioningStatus
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|info
operator|.
name|setEffectiveStart
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|info
operator|.
name|setEffectiveStop
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|details
operator|.
name|setStatus
argument_list|(
name|info
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|StudentStatusInfo
name|info
init|=
operator|new
name|StudentStatusInfo
argument_list|()
decl_stmt|;
name|info
operator|.
name|setReference
argument_list|(
literal|""
argument_list|)
expr_stmt|;
name|info
operator|.
name|setLabel
argument_list|(
name|MSG
operator|.
name|studentStatusSystemDefault
argument_list|()
argument_list|)
expr_stmt|;
name|info
operator|.
name|setAllEnabled
argument_list|()
expr_stmt|;
name|details
operator|.
name|setStatus
argument_list|(
name|info
argument_list|)
expr_stmt|;
block|}
name|details
operator|.
name|setRequest
argument_list|(
name|requests
argument_list|)
expr_stmt|;
try|try
block|{
name|ByteArrayOutputStream
name|bytes
init|=
operator|new
name|ByteArrayOutputStream
argument_list|()
decl_stmt|;
operator|new
name|AdvisorConfirmationPDF
argument_list|(
name|details
argument_list|)
operator|.
name|generatePdfConfirmation
argument_list|(
name|bytes
argument_list|)
expr_stmt|;
name|bytes
operator|.
name|flush
argument_list|()
expr_stmt|;
name|bytes
operator|.
name|close
argument_list|()
expr_stmt|;
name|iAdvisorRequestsPDF
operator|=
name|bytes
operator|.
name|toByteArray
argument_list|()
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|helper
operator|.
name|error
argument_list|(
literal|"Failed to generate PDF confirmation: "
operator|+
name|e
operator|.
name|getMessage
argument_list|()
argument_list|,
name|e
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
if|if
condition|(
name|iIncludeClassSchedule
condition|)
block|{
name|Table
name|classes
init|=
name|generateListOfClasses
argument_list|(
name|student
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
decl_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"classes"
argument_list|,
name|classes
argument_list|)
expr_stmt|;
comment|// Total credit
name|float
name|totalCredit
init|=
literal|0f
decl_stmt|;
name|Pattern
name|pattern
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|"\\d+\\.?\\d*"
argument_list|)
decl_stmt|;
for|for
control|(
name|TableLine
name|line
range|:
name|classes
control|)
block|{
name|String
name|credit
init|=
name|line
operator|.
name|getCredit
argument_list|()
decl_stmt|;
if|if
condition|(
name|credit
operator|==
literal|null
condition|)
continue|continue;
name|Matcher
name|m
init|=
name|pattern
operator|.
name|matcher
argument_list|(
name|credit
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|.
name|find
argument_list|()
condition|)
name|totalCredit
operator|+=
name|Float
operator|.
name|parseFloat
argument_list|(
name|m
operator|.
name|group
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|input
operator|.
name|put
argument_list|(
literal|"credit"
argument_list|,
name|totalCredit
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
operator|.
name|isEmpty
argument_list|()
operator|&&
name|ApplicationProperty
operator|.
name|OnlineSchedulingEmailIncludeImage
operator|.
name|isTrue
argument_list|()
condition|)
block|{
try|try
block|{
name|iTimetableImage
operator|=
name|generateTimetableImage
argument_list|(
name|server
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|helper
operator|.
name|error
argument_list|(
literal|"Unable to create timetable image: "
operator|+
name|e
operator|.
name|getMessage
argument_list|()
argument_list|,
name|e
argument_list|)
expr_stmt|;
name|StringWriter
name|buffer
init|=
operator|new
name|StringWriter
argument_list|()
decl_stmt|;
name|PrintWriter
name|out
init|=
operator|new
name|PrintWriter
argument_list|(
name|buffer
argument_list|)
decl_stmt|;
name|generateTimetable
argument_list|(
name|out
argument_list|,
name|server
argument_list|,
name|helper
argument_list|)
expr_stmt|;
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"timetable"
argument_list|,
name|buffer
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iTimetableImage
operator|!=
literal|null
condition|)
name|input
operator|.
name|put
argument_list|(
literal|"timetable"
argument_list|,
literal|"<img src='cid:timetable.png' border='0' alt='Timetable Grid'/>"
argument_list|)
expr_stmt|;
block|}
block|}
name|AcademicSessionInfo
name|session
init|=
name|server
operator|.
name|getAcademicSession
argument_list|()
decl_stmt|;
if|if
condition|(
name|getOldOffering
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|Table
name|listOfChanges
init|=
operator|new
name|Table
argument_list|()
decl_stmt|;
name|XCourseRequest
name|newRequest
init|=
literal|null
decl_stmt|;
name|XOffering
name|newOffering
init|=
literal|null
decl_stmt|;
name|XCourse
name|course
init|=
operator|(
name|getOldEnrollment
argument_list|()
operator|!=
literal|null
condition|?
name|getOldOffering
argument_list|()
operator|.
name|getCourse
argument_list|(
name|getOldEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
else|:
name|getOldCourse
argument_list|()
operator|)
decl_stmt|;
for|for
control|(
name|XRequest
name|r
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|r
operator|instanceof
name|XCourseRequest
operator|&&
operator|(
operator|(
name|getOldCourse
argument_list|()
operator|==
literal|null
operator|&&
operator|(
operator|(
name|XCourseRequest
operator|)
name|r
operator|)
operator|.
name|getCourseIdByOfferingId
argument_list|(
name|getOldOffering
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
operator|!=
literal|null
operator|)
operator|||
operator|(
name|getOldCourse
argument_list|()
operator|!=
literal|null
operator|&&
operator|(
operator|(
name|XCourseRequest
operator|)
name|r
operator|)
operator|.
name|hasCourse
argument_list|(
name|getOldCourse
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
operator|)
operator|)
condition|)
block|{
name|newRequest
operator|=
operator|(
name|XCourseRequest
operator|)
name|r
expr_stmt|;
name|newOffering
operator|=
name|server
operator|.
name|getOffering
argument_list|(
name|getOldOffering
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|newRequest
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
name|course
operator|=
name|newOffering
operator|.
name|getCourse
argument_list|(
name|newRequest
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|input
operator|.
name|put
argument_list|(
literal|"changedCourse"
argument_list|,
name|course
argument_list|)
expr_stmt|;
if|if
condition|(
name|getOldEnrollment
argument_list|()
operator|==
literal|null
operator|&&
name|newRequest
operator|!=
literal|null
operator|&&
name|newRequest
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|setSubject
argument_list|(
name|MSG
operator|.
name|emailEnrollmentNew
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|XEnrollment
name|enrollment
init|=
name|newRequest
operator|.
name|getEnrollment
argument_list|()
decl_stmt|;
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|enrollment
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|newOffering
operator|.
name|getSections
argument_list|(
name|enrollment
argument_list|)
control|)
block|{
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|newOffering
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|XSubpart
name|subpart
init|=
name|newOffering
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|newRequest
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|input
operator|.
name|put
argument_list|(
literal|"changes"
argument_list|,
name|listOfChanges
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|getOldEnrollment
argument_list|()
operator|!=
literal|null
operator|&&
name|newRequest
operator|!=
literal|null
operator|&&
name|newRequest
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|setSubject
argument_list|(
name|MSG
operator|.
name|emailEnrollmentChanged
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|newRequest
operator|.
name|getEnrollment
argument_list|()
argument_list|)
decl_stmt|;
name|sections
label|:
for|for
control|(
name|XSection
name|section
range|:
name|newOffering
operator|.
name|getSections
argument_list|(
name|newRequest
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|newOffering
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|XSubpart
name|subpart
init|=
name|newOffering
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|old
range|:
name|getOldOffering
argument_list|()
operator|.
name|getSections
argument_list|(
name|getOldEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|old
operator|.
name|getSubpartId
argument_list|()
operator|.
name|equals
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
condition|)
block|{
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|XSubpart
name|oldSubpart
init|=
name|getOldOffering
argument_list|()
operator|.
name|getSubpart
argument_list|(
name|old
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|oldParent
init|=
operator|(
name|old
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|getOldOffering
argument_list|()
operator|.
name|getSection
argument_list|(
name|old
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|oldRequires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|oldParent
operator|!=
literal|null
condition|)
name|oldRequires
operator|=
name|oldParent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|oldRequires
operator|==
literal|null
operator|&&
name|requires
operator|==
literal|null
condition|)
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|oldRequires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionModifiedLine
argument_list|(
name|newRequest
argument_list|,
name|course
argument_list|,
name|oldSubpart
argument_list|,
name|subpart
argument_list|,
name|old
argument_list|,
name|section
argument_list|,
name|oldRequires
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue
name|sections
continue|;
block|}
block|}
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|newRequest
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|sections
label|:
for|for
control|(
name|XSection
name|old
range|:
name|getOldOffering
argument_list|()
operator|.
name|getSections
argument_list|(
name|getOldEnrollment
argument_list|()
argument_list|)
control|)
block|{
for|for
control|(
name|XSection
name|section
range|:
name|newOffering
operator|.
name|getSections
argument_list|(
name|newRequest
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
if|if
condition|(
name|old
operator|.
name|getSubpartId
argument_list|()
operator|.
name|equals
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
condition|)
continue|continue
name|sections
continue|;
name|XSubpart
name|subpart
init|=
name|getOldOffering
argument_list|()
operator|.
name|getSubpart
argument_list|(
name|old
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|old
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|getOldOffering
argument_list|()
operator|.
name|getSection
argument_list|(
name|old
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionDeletedLine
argument_list|(
name|newRequest
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|old
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|input
operator|.
name|put
argument_list|(
literal|"changes"
argument_list|,
name|listOfChanges
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|getOldEnrollment
argument_list|()
operator|!=
literal|null
operator|&&
operator|(
name|newRequest
operator|==
literal|null
operator|||
name|newRequest
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
operator|)
condition|)
block|{
name|setSubject
argument_list|(
name|newRequest
operator|==
literal|null
condition|?
name|MSG
operator|.
name|emailCourseDropReject
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
else|:
name|MSG
operator|.
name|emailCourseDropChange
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|newRequest
operator|!=
literal|null
operator|&&
name|getStudent
argument_list|()
operator|.
name|canAssign
argument_list|(
name|newRequest
argument_list|)
condition|)
block|{
name|input
operator|.
name|put
argument_list|(
literal|"changeMessage"
argument_list|,
operator|(
name|newRequest
operator|.
name|isAlternative
argument_list|()
condition|?
name|newRequest
operator|.
name|isWaitlist
argument_list|()
condition|?
name|MSG
operator|.
name|emailCourseWaitListedAlternative
argument_list|()
else|:
name|MSG
operator|.
name|emailCourseNotEnrolledAlternative
argument_list|()
else|:
name|newRequest
operator|.
name|isWaitlist
argument_list|()
condition|?
name|MSG
operator|.
name|emailCourseWaitListed
argument_list|()
else|:
name|MSG
operator|.
name|emailCourseNotEnrolled
argument_list|()
operator|)
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|newRequest
operator|==
literal|null
operator|&&
name|course
operator|.
name|getConsentLabel
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|input
operator|.
name|put
argument_list|(
literal|"changeMessage"
argument_list|,
name|MSG
operator|.
name|emailConsentRejected
argument_list|(
name|course
operator|.
name|getConsentLabel
argument_list|()
operator|.
name|toLowerCase
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|else if
condition|(
name|getOldStudent
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|getOldStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|boolean
name|somethingWasAssigned
init|=
literal|false
decl_stmt|;
for|for
control|(
name|XRequest
name|or
range|:
name|getOldStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|or
operator|instanceof
name|XCourseRequest
operator|&&
operator|(
operator|(
name|XCourseRequest
operator|)
name|or
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|somethingWasAssigned
operator|=
literal|true
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|somethingWasAssigned
condition|)
block|{
name|Table
name|listOfChanges
init|=
operator|new
name|Table
argument_list|()
decl_stmt|;
name|requests
label|:
for|for
control|(
name|XRequest
name|nr
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|nr
operator|instanceof
name|XFreeTimeRequest
condition|)
continue|continue;
name|XCourseRequest
name|ncr
init|=
operator|(
name|XCourseRequest
operator|)
name|nr
decl_stmt|;
for|for
control|(
name|XRequest
name|or
range|:
name|getOldStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|or
operator|instanceof
name|XFreeTimeRequest
condition|)
continue|continue;
name|XCourseRequest
name|ocr
init|=
operator|(
name|XCourseRequest
operator|)
name|or
decl_stmt|;
if|if
condition|(
name|or
operator|.
name|getRequestId
argument_list|()
operator|.
name|equals
argument_list|(
name|nr
operator|.
name|getRequestId
argument_list|()
argument_list|)
condition|)
block|{
if|if
condition|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|)
block|{
if|if
condition|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
comment|// both unassigned
comment|// was assigned
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
decl_stmt|;
name|XOffering
name|no
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|no
operator|.
name|getCourse
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|no
operator|.
name|getSections
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
name|XSubpart
name|subpart
init|=
name|no
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|no
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|ncr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|)
block|{
name|XOffering
name|oo
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|oo
operator|.
name|getCourse
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
comment|// was un-assigned
for|for
control|(
name|XSection
name|section
range|:
name|oo
operator|.
name|getSections
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
name|XSubpart
name|subpart
init|=
name|oo
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|oo
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionDeletedLine
argument_list|(
name|ncr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|XOffering
name|no
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XOffering
name|oo
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
comment|// both assigned
name|XCourse
name|course
init|=
name|no
operator|.
name|getCourse
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
decl_stmt|;
name|sections
label|:
for|for
control|(
name|XSection
name|section
range|:
name|no
operator|.
name|getSections
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
for|for
control|(
name|XSection
name|old
range|:
name|oo
operator|.
name|getSections
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|old
operator|.
name|getSubpartId
argument_list|()
operator|.
name|equals
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
condition|)
block|{
if|if
condition|(
name|equals
argument_list|(
name|section
argument_list|,
name|old
argument_list|)
condition|)
continue|continue
name|sections
continue|;
name|XSubpart
name|subpart
init|=
name|no
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|no
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|XSubpart
name|oldSubpart
init|=
name|oo
operator|.
name|getSubpart
argument_list|(
name|old
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|oldParent
init|=
operator|(
name|old
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|oo
operator|.
name|getSection
argument_list|(
name|old
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|oldRequires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|oldParent
operator|!=
literal|null
condition|)
name|oldRequires
operator|=
name|oldParent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|oldRequires
operator|==
literal|null
operator|&&
name|requires
operator|==
literal|null
condition|)
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|oldRequires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionModifiedLine
argument_list|(
name|ncr
argument_list|,
name|course
argument_list|,
name|oldSubpart
argument_list|,
name|subpart
argument_list|,
name|old
argument_list|,
name|section
argument_list|,
name|oldRequires
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue
name|sections
continue|;
block|}
block|}
name|XSubpart
name|subpart
init|=
name|no
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|no
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|ncr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|course
operator|=
name|oo
operator|.
name|getCourse
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|sections
label|:
for|for
control|(
name|XSection
name|old
range|:
name|oo
operator|.
name|getSections
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
for|for
control|(
name|XSection
name|section
range|:
name|no
operator|.
name|getSections
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
if|if
condition|(
name|old
operator|.
name|getSubpartId
argument_list|()
operator|.
name|equals
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
condition|)
continue|continue
name|sections
continue|;
name|XSubpart
name|subpart
init|=
name|oo
operator|.
name|getSubpart
argument_list|(
name|old
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|old
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|oo
operator|.
name|getSection
argument_list|(
name|old
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionDeletedLine
argument_list|(
name|ocr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|old
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
continue|continue
name|requests
continue|;
block|}
block|}
comment|// old request not found
if|if
condition|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|XOffering
name|no
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|no
operator|.
name|getCourse
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|no
operator|.
name|getSections
argument_list|(
name|ncr
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
name|XSubpart
name|subpart
init|=
name|no
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|no
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|ncr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|requests
label|:
for|for
control|(
name|XRequest
name|or
range|:
name|getOldStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|or
operator|instanceof
name|XFreeTimeRequest
operator|||
operator|(
operator|(
name|XCourseRequest
operator|)
name|or
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|XRequest
name|nr
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|or
operator|instanceof
name|XFreeTimeRequest
condition|)
continue|continue;
if|if
condition|(
name|or
operator|.
name|getRequestId
argument_list|()
operator|.
name|equals
argument_list|(
name|nr
operator|.
name|getRequestId
argument_list|()
argument_list|)
condition|)
continue|continue
name|requests
continue|;
block|}
comment|// new request not found
name|XCourseRequest
name|ocr
init|=
operator|(
name|XCourseRequest
operator|)
name|or
decl_stmt|;
name|XOffering
name|oo
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|oo
operator|.
name|getCourse
argument_list|(
name|ocr
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|oo
operator|.
name|getSections
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|or
operator|)
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
name|XSubpart
name|subpart
init|=
name|oo
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|oo
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
name|listOfChanges
operator|.
name|add
argument_list|(
operator|new
name|TableSectionDeletedLine
argument_list|(
name|ocr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|input
operator|.
name|put
argument_list|(
literal|"changes"
argument_list|,
name|listOfChanges
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|setSubject
argument_list|(
name|MSG
operator|.
name|emailSubjectNotification
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|setSubject
argument_list|(
name|MSG
operator|.
name|emailSubjectNotification
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|input
operator|.
name|put
argument_list|(
literal|"manager"
argument_list|,
operator|!
name|iPermisionCheck
operator|||
operator|(
name|helper
operator|.
name|getUser
argument_list|()
operator|!=
literal|null
operator|&&
name|helper
operator|.
name|getUser
argument_list|()
operator|.
name|getType
argument_list|()
operator|==
name|OnlineSectioningLog
operator|.
name|Entity
operator|.
name|EntityType
operator|.
name|MANAGER
operator|)
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"changed"
argument_list|,
name|getOldEnrollment
argument_list|()
operator|!=
literal|null
operator|||
name|getOldStudent
argument_list|()
operator|!=
literal|null
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"version"
argument_list|,
name|GWT
operator|.
name|pageVersion
argument_list|(
name|Constants
operator|.
name|getVersion
argument_list|()
argument_list|,
name|Constants
operator|.
name|getReleaseDate
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"copyright"
argument_list|,
name|GWT
operator|.
name|pageCopyright
argument_list|()
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"ts"
argument_list|,
name|sTimeStampFormat
operator|.
name|format
argument_list|(
name|getTimeStamp
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|input
operator|.
name|put
argument_list|(
literal|"link"
argument_list|,
name|ApplicationProperty
operator|.
name|UniTimeUrl
operator|.
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|StringWriter
name|s
init|=
operator|new
name|StringWriter
argument_list|()
decl_stmt|;
name|template
operator|.
name|process
argument_list|(
name|input
argument_list|,
operator|new
name|PrintWriter
argument_list|(
name|s
argument_list|)
argument_list|)
expr_stmt|;
name|s
operator|.
name|flush
argument_list|()
expr_stmt|;
name|s
operator|.
name|close
argument_list|()
expr_stmt|;
return|return
name|s
operator|.
name|toString
argument_list|()
return|;
block|}
name|CourseRequestsTable
name|generateCourseRequests
parameter_list|(
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
name|student
parameter_list|,
name|CourseRequestInterface
name|requests
parameter_list|,
name|OnlineSectioningServer
name|server
parameter_list|,
name|OnlineSectioningHelper
name|helper
parameter_list|)
block|{
name|CourseRequestsTable
name|courseRequests
init|=
operator|new
name|CourseRequestsTable
argument_list|()
decl_stmt|;
name|Format
argument_list|<
name|Number
argument_list|>
name|df
init|=
name|Formats
operator|.
name|getNumberFormat
argument_list|(
literal|"0.#"
argument_list|)
decl_stmt|;
name|CheckCoursesResponse
name|check
init|=
operator|new
name|CheckCoursesResponse
argument_list|(
name|requests
operator|.
name|getConfirmations
argument_list|()
argument_list|)
decl_stmt|;
name|courseRequests
operator|.
name|hasWarn
operator|=
name|requests
operator|.
name|hasConfirmations
argument_list|()
expr_stmt|;
name|int
name|priority
init|=
literal|1
decl_stmt|;
for|for
control|(
name|Request
name|request
range|:
name|requests
operator|.
name|getCourses
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|request
operator|.
name|hasRequestedCourse
argument_list|()
condition|)
continue|continue;
name|boolean
name|first
init|=
literal|true
decl_stmt|;
if|if
condition|(
name|request
operator|.
name|isWaitList
argument_list|()
condition|)
name|courseRequests
operator|.
name|hasWait
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|RequestedCourse
name|rc
range|:
name|request
operator|.
name|getRequestedCourse
argument_list|()
control|)
block|{
if|if
condition|(
name|rc
operator|.
name|isCourse
argument_list|()
condition|)
block|{
name|String
name|icon
init|=
literal|null
decl_stmt|;
name|String
name|iconText
init|=
literal|null
decl_stmt|;
name|String
name|msg
init|=
name|check
operator|.
name|getMessage
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|,
literal|"\n"
argument_list|,
literal|"CREDIT"
argument_list|)
decl_stmt|;
if|if
condition|(
name|check
operator|.
name|isError
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|&&
operator|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|==
literal|null
operator|||
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
name|RequestedCourseStatus
operator|.
name|OVERRIDE_REJECTED
operator|)
condition|)
block|{
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|msg
operator|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
switch|switch
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
condition|)
block|{
case|case
name|ENROLLED
case|:
name|icon
operator|=
literal|"login.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|MSG
operator|.
name|enrolled
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_NEEDED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|MSG
operator|.
name|overrideNeeded
argument_list|(
name|msg
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|SAVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|requested
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_REJECTED
case|:
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideRejected
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_PENDING
case|:
name|icon
operator|=
literal|"time.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overridePending
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_CANCELLED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideCancelled
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_APPROVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideApproved
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
default|default:
if|if
condition|(
name|check
operator|.
name|isError
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
condition|)
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|msg
operator|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|rc
operator|.
name|hasStatusNote
argument_list|()
condition|)
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|overrideNote
argument_list|(
name|rc
operator|.
name|getStatusNote
argument_list|()
argument_list|)
expr_stmt|;
name|Collection
argument_list|<
name|Preference
argument_list|>
name|prefs
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasSelectedIntructionalMethods
argument_list|()
condition|)
block|{
if|if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|ArrayList
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
operator|.
name|size
argument_list|()
operator|+
name|rc
operator|.
name|getSelectedClasses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|String
name|status
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
switch|switch
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
condition|)
block|{
case|case
name|ENROLLED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusEnrolled
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_APPROVED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusApproved
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_CANCELLED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusCancelled
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_PENDING
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusPending
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_REJECTED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusRejected
argument_list|()
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|status
operator|.
name|isEmpty
argument_list|()
condition|)
name|status
operator|=
name|MSG
operator|.
name|reqStatusRegistered
argument_list|()
expr_stmt|;
if|if
condition|(
name|prefs
operator|!=
literal|null
condition|)
name|courseRequests
operator|.
name|hasPref
operator|=
literal|true
expr_stmt|;
name|String
name|credit
init|=
operator|(
name|rc
operator|.
name|hasCredit
argument_list|()
condition|?
operator|(
name|rc
operator|.
name|getCreditMin
argument_list|()
operator|.
name|equals
argument_list|(
name|rc
operator|.
name|getCreditMax
argument_list|()
argument_list|)
condition|?
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMin
argument_list|()
argument_list|)
else|:
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMin
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMax
argument_list|()
argument_list|)
operator|)
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|check
operator|!=
literal|null
condition|)
name|note
operator|=
name|check
operator|.
name|getMessage
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|,
literal|"\n"
argument_list|,
literal|"CREDIT"
argument_list|)
expr_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasStatusNote
argument_list|()
condition|)
name|note
operator|=
operator|(
name|note
operator|==
literal|null
condition|?
literal|""
else|:
name|note
operator|+
literal|"\n"
operator|)
operator|+
name|rc
operator|.
name|getStatusNote
argument_list|()
expr_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsPriority
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|rc
operator|.
name|getCourseName
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
operator|(
name|rc
operator|.
name|hasCourseTitle
argument_list|()
condition|?
name|rc
operator|.
name|getCourseTitle
argument_list|()
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
name|toString
argument_list|(
name|prefs
argument_list|)
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|icon
operator|=
name|icon
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
name|iconText
expr_stmt|;
name|line
operator|.
name|status
operator|=
name|status
expr_stmt|;
name|line
operator|.
name|waitlist
operator|=
operator|(
name|first
operator|&&
name|request
operator|.
name|isWaitList
argument_list|()
operator|)
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|&&
name|first
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|isFreeTime
argument_list|()
condition|)
block|{
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|String
name|free
init|=
literal|""
decl_stmt|;
for|for
control|(
name|FreeTime
name|ft
range|:
name|rc
operator|.
name|getFreeTime
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|free
operator|.
name|isEmpty
argument_list|()
condition|)
name|free
operator|+=
literal|", "
expr_stmt|;
name|free
operator|+=
name|ft
operator|.
name|toString
argument_list|(
name|CONST
operator|.
name|shortDays
argument_list|()
argument_list|,
name|CONST
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsPriority
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|CONST
operator|.
name|freePrefix
argument_list|()
operator|+
name|free
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
name|MSG
operator|.
name|requested
argument_list|(
name|free
argument_list|)
expr_stmt|;
name|line
operator|.
name|status
operator|=
name|MSG
operator|.
name|reqStatusRegistered
argument_list|()
expr_stmt|;
name|line
operator|.
name|waitlist
operator|=
literal|false
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|&&
name|first
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|first
operator|=
literal|false
expr_stmt|;
block|}
name|priority
operator|++
expr_stmt|;
block|}
name|priority
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|Request
name|request
range|:
name|requests
operator|.
name|getAlternatives
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|request
operator|.
name|hasRequestedCourse
argument_list|()
condition|)
continue|continue;
name|boolean
name|first
init|=
literal|true
decl_stmt|;
if|if
condition|(
name|request
operator|.
name|isWaitList
argument_list|()
condition|)
name|courseRequests
operator|.
name|hasWait
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|RequestedCourse
name|rc
range|:
name|request
operator|.
name|getRequestedCourse
argument_list|()
control|)
block|{
if|if
condition|(
name|rc
operator|.
name|isCourse
argument_list|()
condition|)
block|{
name|String
name|icon
init|=
literal|null
decl_stmt|;
name|String
name|iconText
init|=
literal|null
decl_stmt|;
name|String
name|msg
init|=
name|check
operator|.
name|getMessage
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|,
literal|"\n"
argument_list|,
literal|"CREDIT"
argument_list|)
decl_stmt|;
if|if
condition|(
name|check
operator|.
name|isError
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|&&
operator|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|==
literal|null
operator|||
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
name|RequestedCourseStatus
operator|.
name|OVERRIDE_REJECTED
operator|)
condition|)
block|{
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|msg
operator|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
switch|switch
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
condition|)
block|{
case|case
name|ENROLLED
case|:
name|icon
operator|=
literal|"login.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|MSG
operator|.
name|enrolled
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_NEEDED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|MSG
operator|.
name|overrideNeeded
argument_list|(
name|msg
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|SAVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|requested
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_REJECTED
case|:
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideRejected
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_PENDING
case|:
name|icon
operator|=
literal|"time.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overridePending
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_CANCELLED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideCancelled
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|OVERRIDE_APPROVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|iconText
operator|=
operator|(
operator|(
name|msg
operator|==
literal|null
condition|?
literal|""
else|:
name|MSG
operator|.
name|requestWarnings
argument_list|(
name|msg
argument_list|)
operator|+
literal|"\n\n"
operator|)
operator|+
name|MSG
operator|.
name|overrideApproved
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
operator|)
expr_stmt|;
break|break;
default|default:
if|if
condition|(
name|check
operator|.
name|isError
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|)
condition|)
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|iconText
operator|=
operator|(
name|msg
operator|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|rc
operator|.
name|hasStatusNote
argument_list|()
condition|)
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|overrideNote
argument_list|(
name|rc
operator|.
name|getStatusNote
argument_list|()
argument_list|)
expr_stmt|;
name|Collection
argument_list|<
name|Preference
argument_list|>
name|prefs
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasSelectedIntructionalMethods
argument_list|()
condition|)
block|{
if|if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|ArrayList
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
operator|.
name|size
argument_list|()
operator|+
name|rc
operator|.
name|getSelectedClasses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|String
name|status
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
switch|switch
condition|(
name|rc
operator|.
name|getStatus
argument_list|()
condition|)
block|{
case|case
name|ENROLLED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusEnrolled
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_APPROVED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusApproved
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_CANCELLED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusCancelled
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_PENDING
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusPending
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_REJECTED
case|:
name|status
operator|=
name|MSG
operator|.
name|reqStatusRejected
argument_list|()
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|status
operator|.
name|isEmpty
argument_list|()
condition|)
name|status
operator|=
name|MSG
operator|.
name|reqStatusRegistered
argument_list|()
expr_stmt|;
if|if
condition|(
name|prefs
operator|!=
literal|null
condition|)
name|courseRequests
operator|.
name|hasPref
operator|=
literal|true
expr_stmt|;
name|String
name|credit
init|=
operator|(
name|rc
operator|.
name|hasCredit
argument_list|()
condition|?
operator|(
name|rc
operator|.
name|getCreditMin
argument_list|()
operator|.
name|equals
argument_list|(
name|rc
operator|.
name|getCreditMax
argument_list|()
argument_list|)
condition|?
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMin
argument_list|()
argument_list|)
else|:
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMin
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|df
operator|.
name|format
argument_list|(
name|rc
operator|.
name|getCreditMax
argument_list|()
argument_list|)
operator|)
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|check
operator|!=
literal|null
condition|)
name|note
operator|=
name|check
operator|.
name|getMessage
argument_list|(
name|rc
operator|.
name|getCourseName
argument_list|()
argument_list|,
literal|"\n"
argument_list|,
literal|"CREDIT"
argument_list|)
expr_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasStatusNote
argument_list|()
condition|)
name|note
operator|=
operator|(
name|note
operator|==
literal|null
condition|?
literal|""
else|:
name|note
operator|+
literal|"\n"
operator|)
operator|+
name|rc
operator|.
name|getStatusNote
argument_list|()
expr_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsAlternate
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|rc
operator|.
name|getCourseName
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
operator|(
name|rc
operator|.
name|hasCourseTitle
argument_list|()
condition|?
name|rc
operator|.
name|getCourseTitle
argument_list|()
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
name|toString
argument_list|(
name|prefs
argument_list|)
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|icon
operator|=
name|icon
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
name|iconText
expr_stmt|;
name|line
operator|.
name|status
operator|=
name|status
expr_stmt|;
name|line
operator|.
name|waitlist
operator|=
operator|(
name|first
operator|&&
name|request
operator|.
name|isWaitList
argument_list|()
operator|)
expr_stmt|;
name|line
operator|.
name|first
operator|=
name|first
expr_stmt|;
name|line
operator|.
name|firstalt
operator|=
operator|(
name|first
operator|&&
name|priority
operator|==
literal|1
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|isFreeTime
argument_list|()
condition|)
block|{
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|String
name|free
init|=
literal|""
decl_stmt|;
for|for
control|(
name|FreeTime
name|ft
range|:
name|rc
operator|.
name|getFreeTime
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|free
operator|.
name|isEmpty
argument_list|()
condition|)
name|free
operator|+=
literal|", "
expr_stmt|;
name|free
operator|+=
name|ft
operator|.
name|toString
argument_list|(
name|CONST
operator|.
name|shortDays
argument_list|()
argument_list|,
name|CONST
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsAlternate
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|CONST
operator|.
name|freePrefix
argument_list|()
operator|+
name|free
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
name|MSG
operator|.
name|requested
argument_list|(
name|free
argument_list|)
expr_stmt|;
name|line
operator|.
name|status
operator|=
name|MSG
operator|.
name|reqStatusRegistered
argument_list|()
expr_stmt|;
name|line
operator|.
name|waitlist
operator|=
literal|false
expr_stmt|;
name|line
operator|.
name|first
operator|=
name|first
expr_stmt|;
name|line
operator|.
name|firstalt
operator|=
operator|(
name|first
operator|&&
name|priority
operator|==
literal|1
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|first
operator|=
literal|false
expr_stmt|;
block|}
name|priority
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|requests
operator|.
name|getMaxCreditOverrideStatus
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|String
name|icon
init|=
literal|null
decl_stmt|;
name|String
name|status
init|=
literal|""
decl_stmt|;
name|String
name|note
init|=
literal|null
decl_stmt|;
name|String
name|iconText
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|requests
operator|.
name|hasCreditWarning
argument_list|()
condition|)
block|{
name|note
operator|=
name|requests
operator|.
name|getCreditWarning
argument_list|()
expr_stmt|;
name|iconText
operator|=
name|requests
operator|.
name|getCreditWarning
argument_list|()
expr_stmt|;
name|courseRequests
operator|.
name|hasWarn
operator|=
literal|true
expr_stmt|;
block|}
switch|switch
condition|(
name|requests
operator|.
name|getMaxCreditOverrideStatus
argument_list|()
condition|)
block|{
case|case
name|CREDIT_HIGH
case|:
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusRejected
argument_list|()
expr_stmt|;
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|creditStatusTooHigh
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_REJECTED
case|:
name|icon
operator|=
literal|"stop.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusRejected
argument_list|()
expr_stmt|;
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|creditStatusDenied
argument_list|()
expr_stmt|;
break|break;
case|case
name|CREDIT_LOW
case|:
case|case
name|OVERRIDE_NEEDED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusWarning
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_CANCELLED
case|:
name|icon
operator|=
literal|"attention.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusCancelled
argument_list|()
expr_stmt|;
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|creditStatusCancelled
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_PENDING
case|:
name|icon
operator|=
literal|"time.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusPending
argument_list|()
expr_stmt|;
name|iconText
operator|+=
literal|"\n"
operator|+
name|MSG
operator|.
name|creditStatusPending
argument_list|()
expr_stmt|;
break|break;
case|case
name|OVERRIDE_APPROVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusApproved
argument_list|()
expr_stmt|;
name|iconText
operator|+=
operator|(
name|iconText
operator|==
literal|null
condition|?
literal|""
else|:
name|iconText
operator|+
literal|"\n"
operator|)
operator|+
name|MSG
operator|.
name|creditStatusApproved
argument_list|()
expr_stmt|;
break|break;
case|case
name|SAVED
case|:
name|icon
operator|=
literal|"action_check.png"
expr_stmt|;
name|status
operator|=
name|MSG
operator|.
name|reqStatusRegistered
argument_list|()
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|requests
operator|.
name|hasCreditNote
argument_list|()
condition|)
block|{
name|note
operator|=
operator|(
name|note
operator|==
literal|null
condition|?
literal|""
else|:
name|note
operator|+
literal|"\n"
operator|)
operator|+
name|requests
operator|.
name|getCreditNote
argument_list|()
expr_stmt|;
name|courseRequests
operator|.
name|hasWarn
operator|=
literal|true
expr_stmt|;
block|}
name|float
index|[]
name|range
init|=
name|requests
operator|.
name|getCreditRange
argument_list|()
decl_stmt|;
name|String
name|credit
init|=
operator|(
name|range
operator|!=
literal|null
condition|?
name|range
index|[
literal|0
index|]
operator|<
name|range
index|[
literal|1
index|]
condition|?
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|0
index|]
argument_list|)
operator|+
literal|" - "
operator|+
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|1
index|]
argument_list|)
else|:
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|0
index|]
argument_list|)
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|MSG
operator|.
name|rowRequestedCredit
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|icon
operator|=
name|icon
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
name|iconText
expr_stmt|;
name|line
operator|.
name|status
operator|=
name|status
expr_stmt|;
name|line
operator|.
name|last
operator|=
literal|true
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|float
index|[]
name|range
init|=
name|requests
operator|.
name|getCreditRange
argument_list|()
decl_stmt|;
if|if
condition|(
name|range
operator|!=
literal|null
operator|&&
name|range
index|[
literal|1
index|]
operator|>
literal|0f
condition|)
block|{
name|String
name|credit
init|=
operator|(
name|range
operator|!=
literal|null
condition|?
name|range
index|[
literal|0
index|]
operator|<
name|range
index|[
literal|1
index|]
condition|?
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|0
index|]
argument_list|)
operator|+
literal|" - "
operator|+
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|1
index|]
argument_list|)
else|:
name|df
operator|.
name|format
argument_list|(
name|range
index|[
literal|0
index|]
argument_list|)
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|MSG
operator|.
name|rowRequestedCredit
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|note
operator|=
literal|null
expr_stmt|;
name|line
operator|.
name|icon
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|iconText
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|status
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|last
operator|=
literal|true
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|courseRequests
return|;
block|}
name|CourseRequestsTable
name|generateAdvisorRequests
parameter_list|(
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
name|student
parameter_list|,
name|CourseRequestInterface
name|requests
parameter_list|,
name|OnlineSectioningServer
name|server
parameter_list|,
name|OnlineSectioningHelper
name|helper
parameter_list|)
block|{
name|CourseRequestsTable
name|courseRequests
init|=
operator|new
name|CourseRequestsTable
argument_list|()
decl_stmt|;
name|Format
argument_list|<
name|Number
argument_list|>
name|df
init|=
name|Formats
operator|.
name|getNumberFormat
argument_list|(
literal|"0.#"
argument_list|)
decl_stmt|;
name|int
name|priority
init|=
literal|1
decl_stmt|;
for|for
control|(
name|Request
name|request
range|:
name|requests
operator|.
name|getCourses
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|.
name|hasRequestedCourse
argument_list|()
condition|)
block|{
name|boolean
name|first
init|=
literal|true
decl_stmt|;
for|for
control|(
name|RequestedCourse
name|rc
range|:
name|request
operator|.
name|getRequestedCourse
argument_list|()
control|)
block|{
if|if
condition|(
name|rc
operator|.
name|isCourse
argument_list|()
condition|)
block|{
name|Collection
argument_list|<
name|Preference
argument_list|>
name|prefs
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasSelectedIntructionalMethods
argument_list|()
condition|)
block|{
if|if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|ArrayList
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
operator|.
name|size
argument_list|()
operator|+
name|rc
operator|.
name|getSelectedClasses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefs
operator|!=
literal|null
condition|)
name|courseRequests
operator|.
name|hasPref
operator|=
literal|true
expr_stmt|;
name|String
name|credit
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsPriority
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|rc
operator|.
name|getCourseName
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
operator|(
name|rc
operator|.
name|hasCourseTitle
argument_list|()
condition|?
name|rc
operator|.
name|getCourseTitle
argument_list|()
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
name|toString
argument_list|(
name|prefs
argument_list|)
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|&&
name|first
operator|)
expr_stmt|;
name|line
operator|.
name|rows
operator|=
operator|(
name|first
condition|?
name|request
operator|.
name|getRequestedCourse
argument_list|()
operator|.
name|size
argument_list|()
else|:
literal|0
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|isFreeTime
argument_list|()
condition|)
block|{
name|String
name|free
init|=
literal|""
decl_stmt|;
for|for
control|(
name|FreeTime
name|ft
range|:
name|rc
operator|.
name|getFreeTime
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|free
operator|.
name|isEmpty
argument_list|()
condition|)
name|free
operator|+=
literal|", "
expr_stmt|;
name|free
operator|+=
name|ft
operator|.
name|toString
argument_list|(
name|CONST
operator|.
name|shortDays
argument_list|()
argument_list|,
name|CONST
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|String
name|credit
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsPriority
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|CONST
operator|.
name|freePrefix
argument_list|()
operator|+
name|free
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|&&
name|first
operator|)
expr_stmt|;
name|line
operator|.
name|rows
operator|=
operator|(
name|first
condition|?
name|request
operator|.
name|getRequestedCourse
argument_list|()
operator|.
name|size
argument_list|()
else|:
literal|0
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|first
operator|=
literal|false
expr_stmt|;
block|}
block|}
else|else
block|{
name|String
name|credit
init|=
operator|(
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
name|MSG
operator|.
name|courseRequestsPriority
argument_list|(
name|priority
argument_list|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|priority
operator|++
expr_stmt|;
block|}
name|priority
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|Request
name|request
range|:
name|requests
operator|.
name|getAlternatives
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|.
name|hasRequestedCourse
argument_list|()
condition|)
block|{
name|boolean
name|first
init|=
literal|true
decl_stmt|;
if|if
condition|(
name|request
operator|.
name|isWaitList
argument_list|()
condition|)
name|courseRequests
operator|.
name|hasWait
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|RequestedCourse
name|rc
range|:
name|request
operator|.
name|getRequestedCourse
argument_list|()
control|)
block|{
if|if
condition|(
name|rc
operator|.
name|isCourse
argument_list|()
condition|)
block|{
name|Collection
argument_list|<
name|Preference
argument_list|>
name|prefs
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|rc
operator|.
name|hasSelectedIntructionalMethods
argument_list|()
condition|)
block|{
if|if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|ArrayList
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
operator|.
name|size
argument_list|()
operator|+
name|rc
operator|.
name|getSelectedClasses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|addAll
argument_list|(
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedIntructionalMethods
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|rc
operator|.
name|hasSelectedClasses
argument_list|()
condition|)
block|{
name|prefs
operator|=
operator|new
name|TreeSet
argument_list|<
name|Preference
argument_list|>
argument_list|(
name|rc
operator|.
name|getSelectedClasses
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefs
operator|!=
literal|null
condition|)
name|courseRequests
operator|.
name|hasPref
operator|=
literal|true
expr_stmt|;
name|String
name|credit
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsAlternate
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|rc
operator|.
name|getCourseName
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
operator|(
name|rc
operator|.
name|hasCourseTitle
argument_list|()
condition|?
name|rc
operator|.
name|getCourseTitle
argument_list|()
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
name|toString
argument_list|(
name|prefs
argument_list|)
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|first
operator|=
name|first
expr_stmt|;
name|line
operator|.
name|firstalt
operator|=
operator|(
name|first
operator|&&
name|priority
operator|==
literal|1
operator|)
expr_stmt|;
name|line
operator|.
name|rows
operator|=
operator|(
name|first
condition|?
name|request
operator|.
name|getRequestedCourse
argument_list|()
operator|.
name|size
argument_list|()
else|:
literal|0
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
if|else if
condition|(
name|rc
operator|.
name|isFreeTime
argument_list|()
condition|)
block|{
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|String
name|free
init|=
literal|""
decl_stmt|;
for|for
control|(
name|FreeTime
name|ft
range|:
name|rc
operator|.
name|getFreeTime
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|free
operator|.
name|isEmpty
argument_list|()
condition|)
name|free
operator|+=
literal|", "
expr_stmt|;
name|free
operator|+=
name|ft
operator|.
name|toString
argument_list|(
name|CONST
operator|.
name|shortDays
argument_list|()
argument_list|,
name|CONST
operator|.
name|useAmPm
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|String
name|credit
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|first
operator|&&
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|line
operator|.
name|priority
operator|=
operator|(
name|first
condition|?
name|MSG
operator|.
name|courseRequestsAlternate
argument_list|(
name|priority
argument_list|)
else|:
literal|""
operator|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|CONST
operator|.
name|freePrefix
argument_list|()
operator|+
name|free
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|first
operator|=
name|first
expr_stmt|;
name|line
operator|.
name|firstalt
operator|=
operator|(
name|first
operator|&&
name|priority
operator|==
literal|1
operator|)
expr_stmt|;
name|line
operator|.
name|rows
operator|=
operator|(
name|first
condition|?
name|request
operator|.
name|getRequestedCourse
argument_list|()
operator|.
name|size
argument_list|()
else|:
literal|0
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|first
operator|=
literal|false
expr_stmt|;
block|}
block|}
else|else
block|{
name|String
name|credit
init|=
operator|(
name|request
operator|.
name|hasAdvisorCredit
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorCredit
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|note
init|=
operator|(
name|request
operator|.
name|hasAdvisorNote
argument_list|()
condition|?
name|request
operator|.
name|getAdvisorNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
name|MSG
operator|.
name|courseRequestsAlternate
argument_list|(
name|priority
argument_list|)
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|first
operator|=
operator|(
name|priority
operator|>
literal|1
operator|)
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
name|priority
operator|++
expr_stmt|;
block|}
name|float
name|min
init|=
literal|0
decl_stmt|,
name|max
init|=
literal|0
decl_stmt|;
for|for
control|(
name|Request
name|request
range|:
name|requests
operator|.
name|getCourses
argument_list|()
control|)
block|{
name|min
operator|+=
name|request
operator|.
name|getAdvisorCreditMin
argument_list|()
expr_stmt|;
name|max
operator|+=
name|request
operator|.
name|getAdvisorCreditMax
argument_list|()
expr_stmt|;
block|}
name|String
name|note
init|=
operator|(
name|requests
operator|.
name|hasCreditNote
argument_list|()
condition|?
name|requests
operator|.
name|getCreditNote
argument_list|()
else|:
literal|""
operator|)
decl_stmt|;
name|String
name|credit
init|=
operator|(
name|min
operator|<
name|max
condition|?
name|df
operator|.
name|format
argument_list|(
name|min
argument_list|)
operator|+
literal|" - "
operator|+
name|df
operator|.
name|format
argument_list|(
name|max
argument_list|)
else|:
name|df
operator|.
name|format
argument_list|(
name|min
argument_list|)
operator|)
decl_stmt|;
name|CourseRequestLine
name|line
init|=
operator|new
name|CourseRequestLine
argument_list|()
decl_stmt|;
name|line
operator|.
name|priority
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|courseName
operator|=
name|MSG
operator|.
name|rowTotalPriorityCreditHours
argument_list|()
expr_stmt|;
name|line
operator|.
name|courseTitle
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|credit
operator|=
name|credit
expr_stmt|;
name|line
operator|.
name|prefs
operator|=
literal|""
expr_stmt|;
name|line
operator|.
name|note
operator|=
name|note
expr_stmt|;
name|line
operator|.
name|last
operator|=
literal|true
expr_stmt|;
name|courseRequests
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
return|return
name|courseRequests
return|;
block|}
name|Table
name|generateListOfClasses
parameter_list|(
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Student
name|student
parameter_list|,
name|OnlineSectioningServer
name|server
parameter_list|,
name|OnlineSectioningHelper
name|helper
parameter_list|)
block|{
name|Table
name|listOfClasses
init|=
operator|new
name|Table
argument_list|()
decl_stmt|;
name|AcademicSessionInfo
name|session
init|=
name|server
operator|.
name|getAcademicSession
argument_list|()
decl_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XCourseRequest
condition|)
block|{
name|XCourseRequest
name|cr
init|=
operator|(
name|XCourseRequest
operator|)
name|request
decl_stmt|;
name|XEnrollment
name|enrollment
init|=
name|cr
operator|.
name|getEnrollment
argument_list|()
decl_stmt|;
if|if
condition|(
name|enrollment
operator|==
literal|null
condition|)
block|{
if|if
condition|(
operator|!
name|getStudent
argument_list|()
operator|.
name|canAssign
argument_list|(
name|cr
argument_list|)
condition|)
continue|continue;
name|XCourse
name|course
init|=
name|server
operator|.
name|getCourse
argument_list|(
name|cr
operator|.
name|getCourseIds
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
name|listOfClasses
operator|.
name|add
argument_list|(
operator|new
name|TableCourseLine
argument_list|(
name|cr
argument_list|,
name|course
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|XOffering
name|offering
init|=
name|server
operator|.
name|getOffering
argument_list|(
name|enrollment
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|offering
operator|.
name|getCourse
argument_list|(
name|enrollment
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|consent
init|=
name|consent
argument_list|(
name|server
argument_list|,
name|enrollment
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|offering
operator|.
name|getSections
argument_list|(
name|enrollment
argument_list|)
control|)
block|{
name|XSection
name|parent
init|=
operator|(
name|section
operator|.
name|getParentId
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|offering
operator|.
name|getSection
argument_list|(
name|section
operator|.
name|getParentId
argument_list|()
argument_list|)
operator|)
decl_stmt|;
name|XSubpart
name|subpart
init|=
name|offering
operator|.
name|getSubpart
argument_list|(
name|section
operator|.
name|getSubpartId
argument_list|()
argument_list|)
decl_stmt|;
name|String
name|requires
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|parent
operator|!=
literal|null
condition|)
block|{
name|requires
operator|=
name|parent
operator|.
name|getName
argument_list|(
name|course
operator|.
name|getCourseId
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|requires
operator|=
name|consent
expr_stmt|;
name|consent
operator|=
literal|null
expr_stmt|;
block|}
name|listOfClasses
operator|.
name|add
argument_list|(
operator|new
name|TableSectionLine
argument_list|(
name|cr
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|getCourseUrl
argument_list|(
name|session
argument_list|,
name|course
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|listOfClasses
operator|.
name|add
argument_list|(
operator|new
name|TableLineFreeTime
argument_list|(
operator|(
name|XFreeTimeRequest
operator|)
name|request
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|listOfClasses
return|;
block|}
specifier|public
specifier|static
name|boolean
name|equals
parameter_list|(
name|XSection
name|a
parameter_list|,
name|XSection
name|b
parameter_list|)
block|{
return|return
name|ToolBox
operator|.
name|equals
argument_list|(
name|a
operator|.
name|getName
argument_list|()
argument_list|,
name|b
operator|.
name|getName
argument_list|()
argument_list|)
operator|&&
name|ToolBox
operator|.
name|equals
argument_list|(
name|a
operator|.
name|getTime
argument_list|()
argument_list|,
name|b
operator|.
name|getTime
argument_list|()
argument_list|)
operator|&&
name|ToolBox
operator|.
name|equals
argument_list|(
name|a
operator|.
name|getRooms
argument_list|()
argument_list|,
name|b
operator|.
name|getRooms
argument_list|()
argument_list|)
operator|&&
name|ToolBox
operator|.
name|equals
argument_list|(
name|a
operator|.
name|getInstructors
argument_list|()
argument_list|,
name|b
operator|.
name|getInstructors
argument_list|()
argument_list|)
operator|&&
name|ToolBox
operator|.
name|equals
argument_list|(
name|a
operator|.
name|getParentId
argument_list|()
argument_list|,
name|b
operator|.
name|getParentId
argument_list|()
argument_list|)
return|;
block|}
specifier|private
specifier|static
name|String
name|startTime
parameter_list|(
name|XTime
name|time
parameter_list|)
block|{
return|return
name|OnlineSectioningHelper
operator|.
name|getTimeString
argument_list|(
name|time
operator|.
name|getSlot
argument_list|()
argument_list|)
return|;
block|}
specifier|private
specifier|static
name|String
name|endTime
parameter_list|(
name|XTime
name|time
parameter_list|)
block|{
return|return
name|OnlineSectioningHelper
operator|.
name|getTimeString
argument_list|(
name|time
operator|.
name|getSlot
argument_list|()
operator|+
name|time
operator|.
name|getLength
argument_list|()
argument_list|,
name|time
operator|.
name|getBreakTime
argument_list|()
argument_list|)
return|;
block|}
specifier|private
name|String
name|consent
parameter_list|(
name|OnlineSectioningServer
name|server
parameter_list|,
name|XEnrollment
name|enrollment
parameter_list|)
block|{
if|if
condition|(
name|enrollment
operator|==
literal|null
operator|||
name|enrollment
operator|.
name|getCourseId
argument_list|()
operator|==
literal|null
condition|)
return|return
literal|null
return|;
name|XCourse
name|info
init|=
name|server
operator|.
name|getCourse
argument_list|(
name|enrollment
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|info
operator|==
literal|null
operator|||
name|info
operator|.
name|getConsentLabel
argument_list|()
operator|==
literal|null
condition|)
return|return
literal|null
return|;
if|if
condition|(
name|enrollment
operator|.
name|getApproval
argument_list|()
operator|==
literal|null
condition|)
return|return
name|MSG
operator|.
name|consentWaiting
argument_list|(
name|info
operator|.
name|getConsentLabel
argument_list|()
operator|.
name|toLowerCase
argument_list|()
argument_list|)
return|;
else|else
return|return
name|MSG
operator|.
name|consentApproved
argument_list|(
name|sConsentApprovalDateFormat
operator|.
name|format
argument_list|(
name|enrollment
operator|.
name|getApproval
argument_list|()
operator|.
name|getTimeStamp
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
specifier|public
name|void
name|generateTimetable
parameter_list|(
name|PrintWriter
name|out
parameter_list|,
name|OnlineSectioningServer
name|server
parameter_list|,
name|OnlineSectioningHelper
name|helper
parameter_list|)
block|{
name|int
name|nrDays
init|=
literal|5
decl_stmt|,
name|firstHour
init|=
literal|7
decl_stmt|,
name|lastHour
init|=
literal|18
decl_stmt|;
name|boolean
name|hasSat
init|=
literal|false
decl_stmt|,
name|hasSun
init|=
literal|false
decl_stmt|;
name|List
argument_list|<
name|XSection
argument_list|>
name|table
index|[]
index|[]
init|=
operator|new
name|List
index|[
name|Constants
operator|.
name|NR_DAYS
index|]
index|[
name|Constants
operator|.
name|SLOTS_PER_DAY
index|]
decl_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|XFreeTimeRequest
name|ft
init|=
operator|(
name|XFreeTimeRequest
operator|)
name|request
decl_stmt|;
name|int
name|dayCode
init|=
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
decl_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SAT
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSat
operator|=
literal|true
expr_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SUN
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSun
operator|=
literal|true
expr_stmt|;
name|int
name|startHour
init|=
operator|(
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|startHour
operator|<
name|firstHour
condition|)
name|firstHour
operator|=
name|startHour
expr_stmt|;
name|int
name|endHour
init|=
operator|(
operator|(
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|)
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
literal|59
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|endHour
operator|>
name|lastHour
condition|)
name|lastHour
operator|=
name|endHour
expr_stmt|;
block|}
if|else if
condition|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|XOffering
name|offering
init|=
name|server
operator|.
name|getOffering
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|offering
operator|.
name|getSections
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
name|int
name|dayCode
init|=
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
decl_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SAT
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSat
operator|=
literal|true
expr_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SUN
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSun
operator|=
literal|true
expr_stmt|;
name|int
name|startHour
init|=
operator|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|startHour
operator|<
name|firstHour
condition|)
name|firstHour
operator|=
name|startHour
expr_stmt|;
name|int
name|endHour
init|=
operator|(
operator|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|)
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
literal|59
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|endHour
operator|>
name|lastHour
condition|)
name|lastHour
operator|=
name|endHour
expr_stmt|;
for|for
control|(
name|Enumeration
argument_list|<
name|Integer
argument_list|>
name|e
init|=
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlots
argument_list|()
init|;
name|e
operator|.
name|hasMoreElements
argument_list|()
condition|;
control|)
block|{
name|int
name|slot
init|=
name|e
operator|.
name|nextElement
argument_list|()
decl_stmt|;
name|int
name|day
init|=
name|slot
operator|/
name|Constants
operator|.
name|SLOTS_PER_DAY
decl_stmt|;
name|int
name|time
init|=
name|slot
operator|%
name|Constants
operator|.
name|SLOTS_PER_DAY
decl_stmt|;
if|if
condition|(
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|==
literal|null
condition|)
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|=
operator|new
name|ArrayList
argument_list|<
name|XSection
argument_list|>
argument_list|()
expr_stmt|;
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|.
name|add
argument_list|(
name|section
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
if|if
condition|(
name|hasSat
condition|)
name|nrDays
operator|=
literal|6
expr_stmt|;
if|if
condition|(
name|hasSun
condition|)
name|nrDays
operator|=
literal|7
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<table cellspacing='0' cellpadding='0'>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<tr><td align='left' style='vertical-align: top;'><table cellspacing='0' cellpadding='0'><tr>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<td align='left' style='vertical-align: top;'><div style='font-size: x-small; text-align: center; color: #6991CE; display: block; width: 30px;'></div></td>"
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|nrDays
condition|;
name|i
operator|++
control|)
block|{
name|out
operator|.
name|println
argument_list|(
literal|"<td align='center' style='vertical-align: top;'><div style='font-size: x-small; text-align: center; color: #6991CE; display: block; width: 180px; '>"
operator|+
name|DayCode
operator|.
name|values
argument_list|()
index|[
name|i
index|]
operator|.
name|getName
argument_list|()
operator|+
literal|"</div></td>"
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"</tr></table></td></tr>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<tr><td align='left' style='vertical-align: top;'><div style='width: "
operator|+
operator|(
literal|35
operator|+
literal|180
operator|*
name|nrDays
operator|)
operator|+
literal|"px; '>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<table cellspacing='0' cellpadding='0'><tr>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<td align='left' style='vertical-align: top; '><div style='position: relative; overflow-x: hidden; overflow-y: hidden; width: 30px; height: "
operator|+
operator|(
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
operator|)
operator|+
literal|"px; '>"
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|h
init|=
name|firstHour
init|;
name|h
operator|<
name|lastHour
condition|;
name|h
operator|++
control|)
block|{
name|int
name|top
init|=
literal|50
operator|*
operator|(
name|h
operator|-
name|firstHour
operator|)
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='font-size: x-small; text-align: center; padding-right: 2px; color: #6991CE; display: block; border-top: 1px solid transparent; height: 100%; width: 28px; white-space: nowrap; "
operator|+
literal|"position: absolute; left: 0px; top: "
operator|+
name|top
operator|+
literal|"px;'>"
operator|+
operator|(
name|CONST
operator|.
name|useAmPm
argument_list|()
condition|?
operator|(
name|h
operator|>
literal|12
condition|?
name|h
operator|-
literal|12
else|:
name|h
operator|)
operator|+
operator|(
name|h
operator|<
literal|12
condition|?
literal|"am"
else|:
literal|"pm"
operator|)
else|:
name|String
operator|.
name|valueOf
argument_list|(
name|h
argument_list|)
operator|)
operator|+
literal|"</div>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='font-size: x-small; text-align: center; padding-right: 2px; color: #6991CE; display: block; border-top: 1px solid transparent; height: 100%; width: 28px;"
operator|+
literal|"position: absolute; left: 0px; top: "
operator|+
operator|(
literal|25
operator|+
name|top
operator|)
operator|+
literal|"px; '></div>"
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"</div></td>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<td align='left' style='vertical-align: top; '>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='border-bottom: 1px solid #DDDDDD; position: relative; overflow-x: hidden; overflow-y: hidden; width: "
operator|+
operator|(
literal|5
operator|+
literal|180
operator|*
name|nrDays
operator|)
operator|+
literal|"px; height: "
operator|+
operator|(
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
operator|)
operator|+
literal|"px; '>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='position: relative; overflow-x: hidden; overflow-y: hidden; width: 100%; height: 100%; '>"
argument_list|)
expr_stmt|;
comment|// working hours
name|out
operator|.
name|println
argument_list|(
literal|"<div style='background: #FFFDDD; width: "
operator|+
operator|(
literal|2
operator|+
literal|180
operator|*
name|nrDays
operator|)
operator|+
literal|"px; height: 500px; position: absolute; left: 0px; top: "
operator|+
operator|(
literal|25
operator|+
literal|50
operator|*
operator|(
literal|7
operator|-
name|firstHour
operator|)
operator|)
operator|+
literal|"px;'></div>"
argument_list|)
expr_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|XFreeTimeRequest
name|fr
init|=
operator|(
name|XFreeTimeRequest
operator|)
name|request
decl_stmt|;
for|for
control|(
name|DayCode
name|dow
range|:
name|DayCode
operator|.
name|toDayCodes
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|dow
operator|.
name|getIndex
argument_list|()
operator|>=
name|nrDays
condition|)
continue|continue;
if|if
condition|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|<
literal|12
operator|*
name|firstHour
condition|)
continue|continue;
if|if
condition|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|>
literal|12
operator|*
name|lastHour
condition|)
continue|continue;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='background: #FFE1DD; width: 100%; color: #BA5353; font-size: x-small; text-align: left; white-space: nowrap; overflow: hidden;"
operator|+
literal|"width: 183px; height: "
operator|+
operator|(
literal|125
operator|*
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|/
literal|30
operator|)
operator|+
literal|"px; "
operator|+
literal|"position: absolute; left: "
operator|+
operator|(
literal|180
operator|*
name|dow
operator|.
name|getIndex
argument_list|()
operator|)
operator|+
literal|"px;"
operator|+
literal|"top: "
operator|+
operator|(
literal|125
operator|*
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|/
literal|30
operator|-
literal|50
operator|*
name|firstHour
operator|)
operator|+
literal|"px; '>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='padding-left: 5px; white-space: nowrap; '>Free "
operator|+
name|DayCode
operator|.
name|toString
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|startTime
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|endTime
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
argument_list|)
operator|+
literal|"</div>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"</div>"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
for|for
control|(
name|int
name|h
init|=
name|firstHour
init|;
name|h
operator|<
name|lastHour
condition|;
name|h
operator|++
control|)
block|{
name|int
name|top
init|=
literal|50
operator|*
operator|(
name|h
operator|-
name|firstHour
operator|)
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='display: block; border-top: 1px solid #DDDDDD; width: 100%; position: absolute; left: 0px; top: "
operator|+
name|top
operator|+
literal|"px; '></div>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='display: block; border-top: 1px dotted #DDDDDD; width: 100%; position: absolute; left: 0px; top: "
operator|+
operator|(
literal|25
operator|+
name|top
operator|)
operator|+
literal|"px; '></div>"
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<=
name|nrDays
condition|;
name|i
operator|++
control|)
block|{
name|int
name|left
init|=
literal|180
operator|*
name|i
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='height: 100%; position: absolute; top: 0px; left: 0%; border-left: 1px solid #DDDDDD; border-right: 1px solid #DDDDDD; width: 2px; "
operator|+
literal|"position: absolute; left: "
operator|+
name|left
operator|+
literal|"px; top: 0px; '></div>"
argument_list|)
expr_stmt|;
block|}
name|out
operator|.
name|println
argument_list|(
literal|"</div>"
argument_list|)
expr_stmt|;
name|int
name|color
init|=
literal|0
decl_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XCourseRequest
operator|&&
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|XOffering
name|offering
init|=
name|server
operator|.
name|getOffering
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|offering
operator|.
name|getCourse
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|offering
operator|.
name|getSections
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|DayCode
name|dow
range|:
name|DayCode
operator|.
name|toDayCodes
argument_list|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
control|)
block|{
name|int
name|col
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|col
operator|=
name|Math
operator|.
name|max
argument_list|(
name|col
argument_list|,
name|table
index|[
name|dow
operator|.
name|getIndex
argument_list|()
index|]
index|[
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|i
index|]
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|index
operator|=
name|Math
operator|.
name|max
argument_list|(
name|index
argument_list|,
name|table
index|[
name|dow
operator|.
name|getIndex
argument_list|()
index|]
index|[
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|i
index|]
operator|.
name|indexOf
argument_list|(
name|section
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|int
name|w
init|=
literal|174
operator|/
name|col
operator|+
operator|(
name|index
operator|+
literal|1
operator|!=
name|col
operator|&&
name|col
operator|>
literal|1
condition|?
operator|-
literal|3
else|:
literal|0
operator|)
decl_stmt|;
name|int
name|h
init|=
literal|125
operator|*
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|/
literal|30
operator|-
literal|3
decl_stmt|;
name|int
name|l
init|=
literal|4
operator|+
literal|180
operator|*
name|dow
operator|.
name|getIndex
argument_list|()
operator|+
name|index
operator|*
literal|174
operator|/
name|col
decl_stmt|;
name|int
name|t
init|=
literal|1
operator|+
literal|125
operator|*
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|/
literal|30
operator|-
literal|50
operator|*
name|firstHour
decl_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='overflow-x: hidden; overflow-y: hidden; width: "
operator|+
name|w
operator|+
literal|"px; height: "
operator|+
name|h
operator|+
literal|"px; position: absolute; left: "
operator|+
name|l
operator|+
literal|"px; top: "
operator|+
name|t
operator|+
literal|"px; "
operator|+
literal|"position: absolute; font-size: x-small; font-family: arial; overflow: hidden; -webkit-border-radius: 6px; -moz-border-radius: 6px; color: #FFFFFF; "
operator|+
literal|"border: 1px solid #"
operator|+
name|sColor1
index|[
name|color
index|]
operator|+
literal|"; background: #"
operator|+
name|sColor2
index|[
name|color
index|]
operator|+
literal|";'>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<table cellspacing='0' cellpadding='0' style='padding-left: 4px; padding-right: 4px; padding-bottom: 2px; padding-top: 2px; width: 100%; -webkit-border-top-left-radius: 5px; -webkit-border-top-right-radius: 5px; -moz-border-radius-topleft: 5px; -moz-border-radius-topright: 5px;"
operator|+
literal|"background: #"
operator|+
name|sColor1
index|[
name|color
index|]
operator|+
literal|";'><tr><td align='left' style='vertical-align: top; '>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='padding-left: 2px; width: 100%; font-size: x-small; white-space: nowrap; overflow: hidden; color: #FFFFFF;'>"
operator|+
name|MSG
operator|.
name|course
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|section
operator|.
name|getSubpartName
argument_list|()
operator|+
literal|"</div></td></tr></tbody></table>"
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"<div style='font-size: x-small; padding-left: 4px; white-space: wrap; -webkit-border-bottom-left-radius: 5px; -webkit-border-bottom-right-radius: 5px; -moz-border-radius-bottomleft: 5px; -moz-border-radius-bottomright: 5px;'>"
argument_list|)
expr_stmt|;
if|if
condition|(
name|section
operator|.
name|getRooms
argument_list|()
operator|!=
literal|null
condition|)
for|for
control|(
name|XRoom
name|room
range|:
name|section
operator|.
name|getRooms
argument_list|()
control|)
block|{
name|out
operator|.
name|println
argument_list|(
literal|"<span style='white-space: nowrap'>"
operator|+
name|room
operator|.
name|getName
argument_list|()
operator|+
literal|",</span>"
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|XInstructor
name|instructor
range|:
name|section
operator|.
name|getInstructors
argument_list|()
control|)
block|{
name|out
operator|.
name|println
argument_list|(
literal|"<span style='white-space: nowrap'>"
operator|+
name|instructor
operator|.
name|getName
argument_list|()
operator|+
literal|",</span>"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|out
operator|.
name|println
argument_list|(
literal|"<span style='white-space: nowrap'>"
operator|+
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
operator|+
literal|"</span>"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|course
operator|.
name|getNote
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|course
operator|.
name|getNote
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|out
operator|.
name|println
argument_list|(
literal|"<br>"
operator|+
name|course
operator|.
name|getNote
argument_list|()
operator|.
name|replace
argument_list|(
literal|"\n"
argument_list|,
literal|"<br>"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|section
operator|.
name|getNote
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|section
operator|.
name|getNote
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|out
operator|.
name|println
argument_list|(
literal|"<br>"
operator|+
name|section
operator|.
name|getNote
argument_list|()
operator|.
name|replace
argument_list|(
literal|"\n"
argument_list|,
literal|"<br>"
argument_list|)
argument_list|)
expr_stmt|;
name|out
operator|.
name|println
argument_list|(
literal|"</div></div>"
argument_list|)
expr_stmt|;
block|}
block|}
name|color
operator|=
operator|(
literal|1
operator|+
name|color
operator|)
operator|%
name|sColor1
operator|.
name|length
expr_stmt|;
block|}
block|}
name|out
operator|.
name|println
argument_list|(
literal|"</div></td></tr></table></div></td></tr>"
argument_list|)
expr_stmt|;
comment|/* 		out.println("<tr><td style=\"font-size: 9pt; font-style: italic; color: #9CB0CE; text-align: right; margin-top: -2px; white-space: nowrap;\">"); 		out.println("		If the timetable is not displayed correctly, please check out the attached file."); 		out.println("</td></tr>"); 		 */
name|out
operator|.
name|println
argument_list|(
literal|"</table>"
argument_list|)
expr_stmt|;
block|}
specifier|public
name|byte
index|[]
name|generateTimetableImage
parameter_list|(
name|OnlineSectioningServer
name|server
parameter_list|)
throws|throws
name|IOException
block|{
name|int
name|nrDays
init|=
literal|5
decl_stmt|,
name|firstHour
init|=
literal|7
decl_stmt|,
name|lastHour
init|=
literal|18
decl_stmt|;
name|boolean
name|hasSat
init|=
literal|false
decl_stmt|,
name|hasSun
init|=
literal|false
decl_stmt|;
name|List
argument_list|<
name|XSection
argument_list|>
name|table
index|[]
index|[]
init|=
operator|new
name|List
index|[
name|Constants
operator|.
name|NR_DAYS
index|]
index|[
name|Constants
operator|.
name|SLOTS_PER_DAY
index|]
decl_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|XFreeTimeRequest
name|ft
init|=
operator|(
name|XFreeTimeRequest
operator|)
name|request
decl_stmt|;
name|int
name|dayCode
init|=
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
decl_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SAT
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSat
operator|=
literal|true
expr_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SUN
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSun
operator|=
literal|true
expr_stmt|;
name|int
name|startHour
init|=
operator|(
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|startHour
operator|<
name|firstHour
condition|)
name|firstHour
operator|=
name|startHour
expr_stmt|;
name|int
name|endHour
init|=
operator|(
operator|(
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|ft
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|)
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
literal|59
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|endHour
operator|>
name|lastHour
condition|)
name|lastHour
operator|=
name|endHour
expr_stmt|;
block|}
if|else if
condition|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|XOffering
name|offering
init|=
name|server
operator|.
name|getOffering
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|offering
operator|.
name|getSections
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
name|int
name|dayCode
init|=
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
decl_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SAT
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSat
operator|=
literal|true
expr_stmt|;
if|if
condition|(
operator|(
name|dayCode
operator|&
name|Constants
operator|.
name|DAY_CODES
index|[
name|Constants
operator|.
name|DAY_SUN
index|]
operator|)
operator|!=
literal|0
condition|)
name|hasSun
operator|=
literal|true
expr_stmt|;
name|int
name|startHour
init|=
operator|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|startHour
operator|<
name|firstHour
condition|)
name|firstHour
operator|=
name|startHour
expr_stmt|;
name|int
name|endHour
init|=
operator|(
operator|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|)
operator|*
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
literal|59
operator|)
operator|/
literal|60
decl_stmt|;
if|if
condition|(
name|endHour
operator|>
name|lastHour
condition|)
name|lastHour
operator|=
name|endHour
expr_stmt|;
for|for
control|(
name|Enumeration
argument_list|<
name|Integer
argument_list|>
name|e
init|=
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlots
argument_list|()
init|;
name|e
operator|.
name|hasMoreElements
argument_list|()
condition|;
control|)
block|{
name|int
name|slot
init|=
name|e
operator|.
name|nextElement
argument_list|()
decl_stmt|;
name|int
name|day
init|=
name|slot
operator|/
name|Constants
operator|.
name|SLOTS_PER_DAY
decl_stmt|;
name|int
name|time
init|=
name|slot
operator|%
name|Constants
operator|.
name|SLOTS_PER_DAY
decl_stmt|;
if|if
condition|(
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|==
literal|null
condition|)
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|=
operator|new
name|ArrayList
argument_list|<
name|XSection
argument_list|>
argument_list|()
expr_stmt|;
name|table
index|[
name|day
index|]
index|[
name|time
index|]
operator|.
name|add
argument_list|(
name|section
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
if|if
condition|(
name|hasSat
condition|)
name|nrDays
operator|=
literal|6
expr_stmt|;
if|if
condition|(
name|hasSun
condition|)
name|nrDays
operator|=
literal|7
expr_stmt|;
name|BufferedImage
name|image
init|=
operator|new
name|BufferedImage
argument_list|(
literal|39
operator|+
literal|180
operator|*
name|nrDays
argument_list|,
literal|21
operator|+
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
argument_list|,
name|BufferedImage
operator|.
name|TYPE_INT_RGB
argument_list|)
decl_stmt|;
name|Graphics2D
name|g
init|=
name|image
operator|.
name|createGraphics
argument_list|()
decl_stmt|;
name|g
operator|.
name|setFont
argument_list|(
operator|new
name|Font
argument_list|(
literal|"Sans Serif"
argument_list|,
name|Font
operator|.
name|TRUETYPE_FONT
argument_list|,
literal|11
argument_list|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|setRenderingHint
argument_list|(
name|RenderingHints
operator|.
name|KEY_ANTIALIASING
argument_list|,
name|RenderingHints
operator|.
name|VALUE_ANTIALIAS_ON
argument_list|)
expr_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xff
argument_list|,
literal|0xff
argument_list|,
literal|0xff
argument_list|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|fillRect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|image
operator|.
name|getWidth
argument_list|()
argument_list|,
name|image
operator|.
name|getHeight
argument_list|()
argument_list|)
expr_stmt|;
name|int
name|fh
init|=
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|getHeight
argument_list|()
decl_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0x69
argument_list|,
literal|0x91
argument_list|,
literal|0xce
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|nrDays
condition|;
name|i
operator|++
control|)
block|{
name|g
operator|.
name|drawString
argument_list|(
name|DayCode
operator|.
name|values
argument_list|()
index|[
name|i
index|]
operator|.
name|getName
argument_list|()
argument_list|,
literal|40
operator|+
name|i
operator|*
literal|180
argument_list|,
literal|17
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|int
name|h
init|=
name|firstHour
init|;
name|h
operator|<
name|lastHour
condition|;
name|h
operator|++
control|)
block|{
name|int
name|top
init|=
literal|20
operator|+
literal|50
operator|*
operator|(
name|h
operator|-
name|firstHour
operator|)
decl_stmt|;
name|g
operator|.
name|drawString
argument_list|(
name|CONST
operator|.
name|useAmPm
argument_list|()
condition|?
operator|(
name|h
operator|>
literal|12
condition|?
name|h
operator|-
literal|12
else|:
name|h
operator|)
operator|+
operator|(
name|h
operator|<
literal|12
condition|?
literal|"am"
else|:
literal|"pm"
operator|)
else|:
name|String
operator|.
name|valueOf
argument_list|(
name|h
argument_list|)
argument_list|,
literal|2
argument_list|,
name|top
operator|+
name|fh
argument_list|)
expr_stmt|;
block|}
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xff
argument_list|,
literal|0xfd
argument_list|,
literal|0xdd
argument_list|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|fillRect
argument_list|(
literal|35
argument_list|,
literal|20
operator|+
literal|25
operator|+
literal|50
operator|*
operator|(
literal|7
operator|-
name|firstHour
operator|)
argument_list|,
literal|5
operator|+
literal|180
operator|*
name|nrDays
argument_list|,
literal|501
argument_list|)
expr_stmt|;
name|Stroke
name|noStroke
init|=
name|g
operator|.
name|getStroke
argument_list|()
decl_stmt|;
name|Stroke
name|dotted
init|=
operator|new
name|BasicStroke
argument_list|(
literal|1f
argument_list|,
name|BasicStroke
operator|.
name|CAP_SQUARE
argument_list|,
name|BasicStroke
operator|.
name|JOIN_MITER
argument_list|,
literal|1f
argument_list|,
operator|new
name|float
index|[]
block|{
literal|2f
block|,
literal|2f
block|}
argument_list|,
literal|0f
argument_list|)
decl_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xdd
argument_list|,
literal|0xdd
argument_list|,
literal|0xdd
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|h
init|=
name|firstHour
init|;
name|h
operator|<
name|lastHour
condition|;
name|h
operator|++
control|)
block|{
name|int
name|top
init|=
literal|20
operator|+
literal|50
operator|*
operator|(
name|h
operator|-
name|firstHour
operator|)
decl_stmt|;
name|g
operator|.
name|setStroke
argument_list|(
name|noStroke
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawLine
argument_list|(
literal|35
argument_list|,
name|top
argument_list|,
operator|(
literal|39
operator|+
literal|180
operator|*
name|nrDays
operator|)
argument_list|,
name|top
argument_list|)
expr_stmt|;
name|g
operator|.
name|setStroke
argument_list|(
name|dotted
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawLine
argument_list|(
literal|35
argument_list|,
name|top
operator|+
literal|25
argument_list|,
operator|(
literal|39
operator|+
literal|180
operator|*
name|nrDays
operator|)
argument_list|,
name|top
operator|+
literal|25
argument_list|)
expr_stmt|;
block|}
name|g
operator|.
name|setStroke
argument_list|(
name|noStroke
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawLine
argument_list|(
literal|35
argument_list|,
literal|20
operator|+
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
argument_list|,
operator|(
literal|39
operator|+
literal|180
operator|*
name|nrDays
operator|)
argument_list|,
literal|20
operator|+
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xff
argument_list|,
literal|0xe1
argument_list|,
literal|0xdd
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|XFreeTimeRequest
name|fr
init|=
operator|(
name|XFreeTimeRequest
operator|)
name|request
decl_stmt|;
for|for
control|(
name|DayCode
name|dow
range|:
name|DayCode
operator|.
name|toDayCodes
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
control|)
block|{
name|g
operator|.
name|fillRect
argument_list|(
literal|36
operator|+
literal|180
operator|*
name|dow
operator|.
name|getIndex
argument_list|()
argument_list|,
literal|21
operator|+
literal|125
operator|*
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|/
literal|30
operator|-
literal|50
operator|*
name|firstHour
argument_list|,
literal|182
argument_list|,
literal|125
operator|*
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|/
literal|30
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xdd
argument_list|,
literal|0xdd
argument_list|,
literal|0xdd
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<=
name|nrDays
condition|;
name|i
operator|++
control|)
block|{
name|g
operator|.
name|drawLine
argument_list|(
literal|35
operator|+
literal|180
operator|*
name|i
argument_list|,
literal|20
argument_list|,
literal|35
operator|+
literal|180
operator|*
name|i
argument_list|,
literal|20
operator|+
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawLine
argument_list|(
literal|38
operator|+
literal|180
operator|*
name|i
argument_list|,
literal|20
argument_list|,
literal|38
operator|+
literal|180
operator|*
name|i
argument_list|,
literal|20
operator|+
literal|50
operator|*
operator|(
name|lastHour
operator|-
name|firstHour
operator|)
argument_list|)
expr_stmt|;
block|}
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xba
argument_list|,
literal|0x53
argument_list|,
literal|0x53
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XFreeTimeRequest
condition|)
block|{
name|XFreeTimeRequest
name|fr
init|=
operator|(
name|XFreeTimeRequest
operator|)
name|request
decl_stmt|;
for|for
control|(
name|DayCode
name|dow
range|:
name|DayCode
operator|.
name|toDayCodes
argument_list|(
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
control|)
block|{
name|g
operator|.
name|drawString
argument_list|(
name|OnlineSectioningHelper
operator|.
name|toString
argument_list|(
name|fr
argument_list|)
argument_list|,
literal|42
operator|+
literal|180
operator|*
name|dow
operator|.
name|getIndex
argument_list|()
argument_list|,
literal|20
operator|+
literal|125
operator|*
name|fr
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|/
literal|30
operator|-
literal|50
operator|*
name|firstHour
operator|+
name|fh
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|int
name|color
init|=
literal|0
decl_stmt|;
for|for
control|(
name|XRequest
name|request
range|:
name|getStudent
argument_list|()
operator|.
name|getRequests
argument_list|()
control|)
block|{
if|if
condition|(
name|request
operator|instanceof
name|XCourseRequest
operator|&&
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|XOffering
name|offering
init|=
name|server
operator|.
name|getOffering
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getOfferingId
argument_list|()
argument_list|)
decl_stmt|;
name|XCourse
name|course
init|=
name|offering
operator|.
name|getCourse
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
operator|.
name|getCourseId
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|XSection
name|section
range|:
name|offering
operator|.
name|getSections
argument_list|(
operator|(
operator|(
name|XCourseRequest
operator|)
name|request
operator|)
operator|.
name|getEnrollment
argument_list|()
argument_list|)
control|)
block|{
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|==
literal|null
condition|)
continue|continue;
for|for
control|(
name|DayCode
name|dow
range|:
name|DayCode
operator|.
name|toDayCodes
argument_list|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
control|)
block|{
name|int
name|col
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|col
operator|=
name|Math
operator|.
name|max
argument_list|(
name|col
argument_list|,
name|table
index|[
name|dow
operator|.
name|getIndex
argument_list|()
index|]
index|[
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|i
index|]
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|index
operator|=
name|Math
operator|.
name|max
argument_list|(
name|index
argument_list|,
name|table
index|[
name|dow
operator|.
name|getIndex
argument_list|()
index|]
index|[
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|+
name|i
index|]
operator|.
name|indexOf
argument_list|(
name|section
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|int
name|w
init|=
literal|176
operator|/
name|col
operator|+
operator|(
name|index
operator|+
literal|1
operator|<
name|col
condition|?
operator|-
literal|2
else|:
literal|0
operator|)
decl_stmt|;
name|int
name|h
init|=
literal|125
operator|*
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getLength
argument_list|()
operator|/
literal|30
operator|-
literal|1
decl_stmt|;
name|int
name|l
init|=
literal|39
operator|+
literal|180
operator|*
name|dow
operator|.
name|getIndex
argument_list|()
operator|+
name|index
operator|*
literal|174
operator|/
name|col
decl_stmt|;
name|int
name|t
init|=
literal|21
operator|+
literal|125
operator|*
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getSlot
argument_list|()
operator|/
literal|30
operator|-
literal|50
operator|*
name|firstHour
decl_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|sColor2
index|[
name|color
index|]
argument_list|,
literal|16
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|fillRoundRect
argument_list|(
name|l
argument_list|,
name|t
argument_list|,
name|w
argument_list|,
name|h
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
name|Integer
operator|.
name|valueOf
argument_list|(
name|sColor1
index|[
name|color
index|]
argument_list|,
literal|16
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawRoundRect
argument_list|(
name|l
argument_list|,
name|t
argument_list|,
name|w
argument_list|,
name|h
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|g
operator|.
name|fillRoundRect
argument_list|(
name|l
argument_list|,
name|t
argument_list|,
name|w
argument_list|,
literal|2
operator|+
name|fh
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|g
operator|.
name|fillRect
argument_list|(
name|l
argument_list|,
name|t
operator|+
name|fh
operator|-
literal|2
argument_list|,
name|w
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|g
operator|.
name|setColor
argument_list|(
operator|new
name|Color
argument_list|(
literal|0xff
argument_list|,
literal|0xff
argument_list|,
literal|0xff
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|text
init|=
name|MSG
operator|.
name|course
argument_list|(
name|course
operator|.
name|getSubjectArea
argument_list|()
argument_list|,
name|course
operator|.
name|getCourseNumber
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|section
operator|.
name|getSubpartName
argument_list|()
decl_stmt|;
while|while
condition|(
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|stringWidth
argument_list|(
name|text
argument_list|)
operator|>
name|w
operator|-
literal|10
condition|)
name|text
operator|=
name|text
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
name|text
operator|.
name|length
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g
operator|.
name|drawString
argument_list|(
name|text
argument_list|,
name|l
operator|+
literal|5
argument_list|,
name|t
operator|+
name|fh
operator|-
literal|2
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|String
argument_list|>
name|texts
init|=
operator|new
name|ArrayList
argument_list|<
name|String
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|section
operator|.
name|getRooms
argument_list|()
operator|!=
literal|null
condition|)
for|for
control|(
name|XRoom
name|room
range|:
name|section
operator|.
name|getRooms
argument_list|()
control|)
name|texts
operator|.
name|add
argument_list|(
name|room
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
for|for
control|(
name|XInstructor
name|instructor
range|:
name|section
operator|.
name|getInstructors
argument_list|()
control|)
block|{
name|texts
operator|.
name|add
argument_list|(
name|instructor
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|texts
operator|.
name|add
argument_list|(
name|section
operator|.
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|course
operator|.
name|getNote
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|course
operator|.
name|getNote
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|texts
operator|.
name|add
argument_list|(
name|course
operator|.
name|getNote
argument_list|()
operator|.
name|replace
argument_list|(
literal|"\n"
argument_list|,
literal|"; "
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|section
operator|.
name|getNote
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|section
operator|.
name|getNote
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|texts
operator|.
name|add
argument_list|(
name|section
operator|.
name|getNote
argument_list|()
operator|.
name|replace
argument_list|(
literal|"\n"
argument_list|,
literal|"; "
argument_list|)
argument_list|)
expr_stmt|;
name|int
name|tt
init|=
name|t
operator|+
name|fh
decl_stmt|;
name|String
name|next
init|=
literal|""
decl_stmt|;
name|int
name|idx
init|=
literal|0
decl_stmt|;
while|while
condition|(
name|idx
operator|<
name|texts
operator|.
name|size
argument_list|()
operator|||
operator|!
name|next
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
if|if
condition|(
name|idx
operator|<
name|texts
operator|.
name|size
argument_list|()
condition|)
block|{
name|next
operator|+=
name|texts
operator|.
name|get
argument_list|(
name|idx
operator|++
argument_list|)
expr_stmt|;
if|if
condition|(
name|idx
operator|<
name|texts
operator|.
name|size
argument_list|()
condition|)
name|next
operator|+=
literal|", "
expr_stmt|;
block|}
while|while
condition|(
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|stringWidth
argument_list|(
name|next
operator|.
name|trim
argument_list|()
argument_list|)
operator|<
name|w
operator|-
literal|10
operator|&&
name|idx
operator|<
name|texts
operator|.
name|size
argument_list|()
condition|)
block|{
if|if
condition|(
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|stringWidth
argument_list|(
name|next
operator|+
name|texts
operator|.
name|get
argument_list|(
name|idx
argument_list|)
operator|+
literal|","
argument_list|)
operator|<
name|w
operator|-
literal|10
condition|)
block|{
name|next
operator|+=
name|texts
operator|.
name|get
argument_list|(
name|idx
operator|++
argument_list|)
expr_stmt|;
if|if
condition|(
name|idx
operator|<
name|texts
operator|.
name|size
argument_list|()
condition|)
name|next
operator|+=
literal|", "
expr_stmt|;
block|}
else|else
break|break;
block|}
name|text
operator|=
name|next
expr_stmt|;
name|next
operator|=
literal|""
expr_stmt|;
while|while
condition|(
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|stringWidth
argument_list|(
name|text
operator|.
name|trim
argument_list|()
argument_list|)
operator|>
name|w
operator|-
literal|10
condition|)
block|{
name|int
name|sp
init|=
name|text
operator|.
name|lastIndexOf
argument_list|(
literal|' '
argument_list|)
decl_stmt|;
if|if
condition|(
name|sp
operator|>=
literal|0
operator|&&
name|g
operator|.
name|getFontMetrics
argument_list|()
operator|.
name|stringWidth
argument_list|(
name|text
operator|.
name|substring
argument_list|(
name|sp
argument_list|)
argument_list|)
operator|<
name|w
operator|-
literal|10
condition|)
block|{
name|next
operator|=
name|text
operator|.
name|substring
argument_list|(
name|sp
argument_list|)
expr_stmt|;
name|text
operator|=
name|text
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
name|sp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|next
operator|=
name|text
operator|.
name|substring
argument_list|(
name|text
operator|.
name|length
argument_list|()
operator|-
literal|1
argument_list|,
name|text
operator|.
name|length
argument_list|()
argument_list|)
operator|+
name|next
expr_stmt|;
name|text
operator|=
name|text
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
name|text
operator|.
name|length
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|tt
operator|+
name|fh
operator|-
literal|2
operator|>
name|t
operator|+
name|h
condition|)
break|break;
name|g
operator|.
name|drawString
argument_list|(
name|text
operator|.
name|trim
argument_list|()
argument_list|,
name|l
operator|+
literal|5
argument_list|,
name|tt
operator|+
name|fh
operator|-
literal|2
argument_list|)
expr_stmt|;
name|tt
operator|+=
name|fh
expr_stmt|;
block|}
block|}
block|}
name|color
operator|=
operator|(
literal|1
operator|+
name|color
operator|)
operator|%
name|sColor1
operator|.
name|length
expr_stmt|;
block|}
block|}
name|ByteArrayOutputStream
name|out
init|=
operator|new
name|ByteArrayOutputStream
argument_list|()
decl_stmt|;
name|ImageIO
operator|.
name|write
argument_list|(
name|image
argument_list|,
literal|"png"
argument_list|,
name|out
argument_list|)
expr_stmt|;
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
return|return
name|out
operator|.
name|toByteArray
argument_list|()
return|;
block|}
specifier|public
specifier|static
interface|interface
name|TableLine
block|{
specifier|public
name|XRequest
name|getRequest
parameter_list|()
function_decl|;
specifier|public
name|String
name|getSubject
parameter_list|()
function_decl|;
specifier|public
name|String
name|getCourseNumber
parameter_list|()
function_decl|;
specifier|public
name|String
name|getCourseTitle
parameter_list|()
function_decl|;
specifier|public
name|String
name|getType
parameter_list|()
function_decl|;
specifier|public
name|String
name|getName
parameter_list|()
function_decl|;
specifier|public
name|String
name|getUrl
parameter_list|()
function_decl|;
specifier|public
name|XTime
name|getTime
parameter_list|()
function_decl|;
specifier|public
name|String
name|getRooms
parameter_list|()
function_decl|;
specifier|public
name|String
name|getInstructors
parameter_list|()
function_decl|;
specifier|public
name|boolean
name|isAssigned
parameter_list|()
function_decl|;
specifier|public
name|boolean
name|isFreeTime
parameter_list|()
function_decl|;
specifier|public
name|String
name|getArrangeHours
parameter_list|()
function_decl|;
specifier|public
name|String
name|getDays
parameter_list|()
function_decl|;
specifier|public
name|String
name|getStart
parameter_list|()
function_decl|;
specifier|public
name|String
name|getEnd
parameter_list|()
function_decl|;
specifier|public
name|String
name|getDate
parameter_list|()
function_decl|;
specifier|public
name|String
name|getCredit
parameter_list|()
function_decl|;
specifier|public
name|String
name|getNote
parameter_list|()
function_decl|;
specifier|public
name|String
name|getCourseNote
parameter_list|()
function_decl|;
specifier|public
name|String
name|getRequires
parameter_list|()
function_decl|;
specifier|public
name|void
name|setTable
parameter_list|(
name|Table
name|table
parameter_list|)
function_decl|;
specifier|public
name|boolean
name|isLast
parameter_list|()
function_decl|;
specifier|public
name|boolean
name|isFirst
parameter_list|()
function_decl|;
block|}
specifier|public
specifier|static
class|class
name|TableCourseLine
implements|implements
name|TableLine
block|{
specifier|protected
name|XCourseRequest
name|iRequest
decl_stmt|;
specifier|protected
name|XCourse
name|iCourse
decl_stmt|;
specifier|protected
name|Table
name|iTable
decl_stmt|;
specifier|protected
name|String
name|iUrl
decl_stmt|;
specifier|public
name|TableCourseLine
parameter_list|(
name|XCourseRequest
name|request
parameter_list|,
name|XCourse
name|course
parameter_list|,
name|URL
name|url
parameter_list|)
block|{
name|iRequest
operator|=
name|request
expr_stmt|;
name|iCourse
operator|=
name|course
expr_stmt|;
name|iUrl
operator|=
operator|(
name|url
operator|==
literal|null
condition|?
literal|null
else|:
name|url
operator|.
name|toString
argument_list|()
operator|)
expr_stmt|;
block|}
specifier|public
name|XRequest
name|getRequest
parameter_list|()
block|{
return|return
name|iRequest
return|;
block|}
specifier|public
name|XCourse
name|getCourse
parameter_list|()
block|{
return|return
name|iCourse
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getSubject
parameter_list|()
block|{
return|return
name|getCourse
argument_list|()
operator|.
name|getSubjectArea
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNumber
parameter_list|()
block|{
return|return
name|getCourse
argument_list|()
operator|.
name|getCourseNumber
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseTitle
parameter_list|()
block|{
return|return
name|getCourse
argument_list|()
operator|.
name|getTitle
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getType
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|XTime
name|getTime
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isAssigned
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCredit
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getNote
parameter_list|()
block|{
if|if
condition|(
name|iRequest
operator|.
name|isAlternative
argument_list|()
condition|)
return|return
operator|(
name|iRequest
operator|.
name|isWaitlist
argument_list|()
condition|?
name|MSG
operator|.
name|emailWaitListedAlternativeRequest
argument_list|()
else|:
name|MSG
operator|.
name|emailNotEnrolledAlternativeRequest
argument_list|()
operator|)
return|;
else|else
return|return
operator|(
name|iRequest
operator|.
name|isWaitlist
argument_list|()
condition|?
name|MSG
operator|.
name|emailWaitListedRequest
argument_list|()
else|:
name|MSG
operator|.
name|emailNotEnrolledRequest
argument_list|()
operator|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNote
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRequires
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRooms
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getInstructors
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isFreeTime
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getArrangeHours
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDays
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getStart
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getEnd
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDate
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setTable
parameter_list|(
name|Table
name|table
parameter_list|)
block|{
name|iTable
operator|=
name|table
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isLast
parameter_list|()
block|{
return|return
name|iTable
operator|.
name|isLast
argument_list|(
name|this
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isFirst
parameter_list|()
block|{
return|return
name|iTable
operator|.
name|isFirst
argument_list|(
name|this
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getUrl
parameter_list|()
block|{
return|return
name|iUrl
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|TableSectionLine
extends|extends
name|TableCourseLine
block|{
specifier|protected
name|XSection
name|iSection
decl_stmt|;
specifier|protected
name|XSubpart
name|iSubpart
decl_stmt|;
specifier|protected
name|String
name|iRequires
decl_stmt|;
specifier|public
name|TableSectionLine
parameter_list|(
name|XCourseRequest
name|request
parameter_list|,
name|XCourse
name|course
parameter_list|,
name|XSubpart
name|subpart
parameter_list|,
name|XSection
name|section
parameter_list|,
name|String
name|requires
parameter_list|,
name|URL
name|url
parameter_list|)
block|{
name|super
argument_list|(
name|request
argument_list|,
name|course
argument_list|,
name|url
argument_list|)
expr_stmt|;
name|iCourse
operator|=
name|course
expr_stmt|;
name|iSubpart
operator|=
name|subpart
expr_stmt|;
name|iSection
operator|=
name|section
expr_stmt|;
name|iRequires
operator|=
name|requires
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getType
parameter_list|()
block|{
return|return
name|iSection
operator|.
name|getSubpartName
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|iSection
operator|.
name|getName
argument_list|(
name|iCourse
operator|.
name|getCourseId
argument_list|()
argument_list|)
return|;
block|}
specifier|public
name|XSection
name|getSection
parameter_list|()
block|{
return|return
name|iSection
return|;
block|}
specifier|public
name|XSubpart
name|getSubpart
parameter_list|()
block|{
return|return
name|iSubpart
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRequires
parameter_list|()
block|{
return|return
name|iRequires
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getNote
parameter_list|()
block|{
return|return
name|iSection
operator|.
name|getNote
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNote
parameter_list|()
block|{
return|return
name|iCourse
operator|.
name|getNote
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCredit
parameter_list|()
block|{
return|return
name|iSubpart
operator|==
literal|null
condition|?
literal|null
else|:
name|iSubpart
operator|.
name|getCreditAbbv
argument_list|(
name|iCourse
operator|.
name|getCourseId
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|XTime
name|getTime
parameter_list|()
block|{
return|return
name|iSection
operator|.
name|getTime
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isAssigned
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRooms
parameter_list|()
block|{
name|String
name|rooms
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|iSection
operator|.
name|getRooms
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|iSection
operator|.
name|getRooms
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XRoom
name|room
range|:
name|iSection
operator|.
name|getRooms
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|rooms
operator|.
name|isEmpty
argument_list|()
condition|)
name|rooms
operator|+=
literal|", "
expr_stmt|;
name|rooms
operator|+=
name|room
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
block|}
return|return
name|rooms
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getInstructors
parameter_list|()
block|{
name|String
name|instructors
init|=
literal|""
decl_stmt|;
if|if
condition|(
operator|!
name|iSection
operator|.
name|getInstructors
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XInstructor
name|instructor
range|:
name|iSection
operator|.
name|getInstructors
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|instructors
operator|.
name|isEmpty
argument_list|()
condition|)
name|instructors
operator|+=
literal|", "
expr_stmt|;
if|if
condition|(
name|instructor
operator|.
name|getEmail
argument_list|()
operator|==
literal|null
condition|)
block|{
name|instructors
operator|+=
literal|"<span style='white-space: nowrap;'>"
operator|+
name|instructor
operator|.
name|getName
argument_list|()
operator|+
literal|"</span>"
expr_stmt|;
block|}
else|else
block|{
name|instructors
operator|+=
literal|"<a href='mailto:"
operator|+
name|instructor
operator|.
name|getEmail
argument_list|()
operator|+
literal|"' style=\"color: inherit; background-color : transparent; text-decoration: none; white-space: nowrap;\">"
operator|+
name|instructor
operator|.
name|getName
argument_list|()
operator|+
literal|"</a>"
expr_stmt|;
block|}
block|}
block|}
return|return
name|instructors
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getArrangeHours
parameter_list|()
block|{
return|return
name|MSG
operator|.
name|emailArrangeHours
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDays
parameter_list|()
block|{
return|return
name|DayCode
operator|.
name|toString
argument_list|(
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getStart
parameter_list|()
block|{
return|return
name|startTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getEnd
parameter_list|()
block|{
return|return
name|endTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDate
parameter_list|()
block|{
return|return
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|TableLineFreeTime
implements|implements
name|TableLine
block|{
specifier|private
name|XFreeTimeRequest
name|iRequest
decl_stmt|;
specifier|public
name|TableLineFreeTime
parameter_list|(
name|XFreeTimeRequest
name|request
parameter_list|)
block|{
name|iRequest
operator|=
name|request
expr_stmt|;
block|}
specifier|public
name|XRequest
name|getRequest
parameter_list|()
block|{
return|return
name|iRequest
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getSubject
parameter_list|()
block|{
return|return
name|MSG
operator|.
name|freeTimeCourse
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNumber
parameter_list|()
block|{
return|return
name|MSG
operator|.
name|freeTimeSubject
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseTitle
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getType
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|XTime
name|getTime
parameter_list|()
block|{
return|return
name|iRequest
operator|.
name|getTime
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isAssigned
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCredit
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getNote
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNote
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRequires
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRooms
parameter_list|()
block|{
return|return
literal|""
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getInstructors
parameter_list|()
block|{
return|return
literal|""
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isFreeTime
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getArrangeHours
parameter_list|()
block|{
return|return
name|MSG
operator|.
name|emailArrangeHours
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDays
parameter_list|()
block|{
return|return
name|DayCode
operator|.
name|toString
argument_list|(
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getStart
parameter_list|()
block|{
return|return
name|startTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getEnd
parameter_list|()
block|{
return|return
name|endTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDate
parameter_list|()
block|{
return|return
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setTable
parameter_list|(
name|Table
name|table
parameter_list|)
block|{
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isLast
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isFirst
parameter_list|()
block|{
return|return
literal|true
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getUrl
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|TableSectionDeletedLine
extends|extends
name|TableSectionLine
block|{
specifier|public
name|TableSectionDeletedLine
parameter_list|(
name|XCourseRequest
name|request
parameter_list|,
name|XCourse
name|course
parameter_list|,
name|XSubpart
name|subpart
parameter_list|,
name|XSection
name|section
parameter_list|,
name|String
name|requires
parameter_list|,
name|URL
name|url
parameter_list|)
block|{
name|super
argument_list|(
name|request
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|url
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNote
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
block|}
specifier|public
specifier|static
class|class
name|TableSectionModifiedLine
extends|extends
name|TableSectionLine
block|{
specifier|private
name|XSubpart
name|iOldSubpart
decl_stmt|;
specifier|private
name|XSection
name|iOldSection
decl_stmt|;
specifier|private
name|String
name|iOldRequires
decl_stmt|;
specifier|public
name|TableSectionModifiedLine
parameter_list|(
name|XCourseRequest
name|request
parameter_list|,
name|XCourse
name|course
parameter_list|,
name|XSubpart
name|oldSubpart
parameter_list|,
name|XSubpart
name|subpart
parameter_list|,
name|XSection
name|oldSection
parameter_list|,
name|XSection
name|section
parameter_list|,
name|String
name|oldRequires
parameter_list|,
name|String
name|requires
parameter_list|,
name|URL
name|url
parameter_list|)
block|{
name|super
argument_list|(
name|request
argument_list|,
name|course
argument_list|,
name|subpart
argument_list|,
name|section
argument_list|,
name|requires
argument_list|,
name|url
argument_list|)
expr_stmt|;
name|iOldSection
operator|=
name|oldSection
expr_stmt|;
name|iOldSubpart
operator|=
name|oldSubpart
expr_stmt|;
name|iOldRequires
operator|=
name|oldRequires
expr_stmt|;
block|}
specifier|public
name|XSubpart
name|getOldSubpart
parameter_list|()
block|{
return|return
name|iOldSubpart
return|;
block|}
specifier|public
name|XSection
name|getOldSection
parameter_list|()
block|{
return|return
name|iOldSection
return|;
block|}
specifier|public
name|XTime
name|getOldTime
parameter_list|()
block|{
return|return
name|iOldSection
operator|.
name|getTime
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getName
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|iOldSection
operator|.
name|getName
argument_list|(
name|iCourse
operator|.
name|getCourseId
argument_list|()
argument_list|)
argument_list|,
name|iSection
operator|.
name|getName
argument_list|(
name|iCourse
operator|.
name|getCourseId
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
specifier|public
name|String
name|diff
parameter_list|(
name|String
name|a
parameter_list|,
name|String
name|b
parameter_list|)
block|{
if|if
condition|(
name|a
operator|==
literal|null
operator|||
name|a
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
operator|(
name|b
operator|==
literal|null
operator|||
name|b
operator|.
name|isEmpty
argument_list|()
condition|?
literal|"<span style='text-decoration: none;'>&nbsp;</span>"
else|:
name|b
operator|)
return|;
if|if
condition|(
name|b
operator|==
literal|null
operator|||
name|b
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
literal|"<br><span style='font-style: italic; color: gray; text-decoration: line-through;'>"
operator|+
name|a
operator|+
literal|"</span>"
return|;
if|if
condition|(
name|a
operator|.
name|equals
argument_list|(
name|b
argument_list|)
condition|)
return|return
name|a
return|;
return|return
name|b
operator|+
literal|"<br><span style='font-style: italic; color: gray; text-decoration: line-through;'>"
operator|+
name|a
operator|+
literal|"</span>"
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRequires
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|iOldRequires
argument_list|,
name|iRequires
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getInstructors
parameter_list|()
block|{
name|String
name|oldInstructors
init|=
literal|""
decl_stmt|;
if|if
condition|(
operator|!
name|iOldSection
operator|.
name|getInstructors
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XInstructor
name|instructor
range|:
name|iOldSection
operator|.
name|getInstructors
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|oldInstructors
operator|.
name|isEmpty
argument_list|()
condition|)
name|oldInstructors
operator|+=
literal|", "
expr_stmt|;
if|if
condition|(
name|instructor
operator|.
name|getEmail
argument_list|()
operator|==
literal|null
condition|)
block|{
name|oldInstructors
operator|+=
name|instructor
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|oldInstructors
operator|+=
literal|"<a href='mailto:"
operator|+
name|instructor
operator|.
name|getEmail
argument_list|()
operator|+
literal|"' style=\"color: inherit; background-color : transparent; text-decoration: none;\">"
operator|+
name|instructor
operator|.
name|getName
argument_list|()
operator|+
literal|"</a>"
expr_stmt|;
block|}
block|}
block|}
name|String
name|instructors
init|=
literal|""
decl_stmt|;
if|if
condition|(
operator|!
name|iSection
operator|.
name|getInstructors
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XInstructor
name|instructor
range|:
name|iSection
operator|.
name|getInstructors
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|instructors
operator|.
name|isEmpty
argument_list|()
condition|)
name|instructors
operator|+=
literal|", "
expr_stmt|;
if|if
condition|(
name|instructor
operator|.
name|getEmail
argument_list|()
operator|==
literal|null
condition|)
block|{
name|instructors
operator|+=
name|instructor
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|instructors
operator|+=
literal|"<a href='mailto:"
operator|+
name|instructor
operator|.
name|getEmail
argument_list|()
operator|+
literal|"' style=\"color: inherit; background-color : transparent; text-decoration: none;\">"
operator|+
name|instructor
operator|.
name|getName
argument_list|()
operator|+
literal|"</a>"
expr_stmt|;
block|}
block|}
block|}
return|return
name|diff
argument_list|(
name|oldInstructors
argument_list|,
name|instructors
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getRooms
parameter_list|()
block|{
name|String
name|oldRooms
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|iOldSection
operator|.
name|getRooms
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|iOldSection
operator|.
name|getRooms
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XRoom
name|room
range|:
name|iOldSection
operator|.
name|getRooms
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|oldRooms
operator|.
name|isEmpty
argument_list|()
condition|)
name|oldRooms
operator|+=
literal|", "
expr_stmt|;
name|oldRooms
operator|+=
name|room
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
block|}
name|String
name|rooms
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|iSection
operator|.
name|getRooms
argument_list|()
operator|!=
literal|null
operator|&&
operator|!
name|iSection
operator|.
name|getRooms
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|XRoom
name|room
range|:
name|iSection
operator|.
name|getRooms
argument_list|()
control|)
block|{
if|if
condition|(
operator|!
name|rooms
operator|.
name|isEmpty
argument_list|()
condition|)
name|rooms
operator|+=
literal|", "
expr_stmt|;
name|rooms
operator|+=
name|room
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
block|}
return|return
name|diff
argument_list|(
name|oldRooms
argument_list|,
name|rooms
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getNote
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|iOldSection
operator|.
name|getNote
argument_list|()
argument_list|,
name|iSection
operator|.
name|getNote
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getCourseNote
parameter_list|()
block|{
return|return
literal|null
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getArrangeHours
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|getOldTime
argument_list|()
operator|==
literal|null
condition|?
name|MSG
operator|.
name|emailArrangeHours
argument_list|()
else|:
name|DayCode
operator|.
name|toString
argument_list|(
name|getOldTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
operator|+
literal|" "
operator|+
name|startTime
argument_list|(
name|getOldTime
argument_list|()
argument_list|)
argument_list|,
name|MSG
operator|.
name|emailArrangeHours
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDays
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|getOldTime
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|DayCode
operator|.
name|toString
argument_list|(
name|getOldTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
argument_list|,
name|DayCode
operator|.
name|toString
argument_list|(
name|getTime
argument_list|()
operator|.
name|getDays
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getStart
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|getOldTime
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|startTime
argument_list|(
name|getOldTime
argument_list|()
argument_list|)
argument_list|,
name|startTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getEnd
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|getOldTime
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|endTime
argument_list|(
name|getOldTime
argument_list|()
argument_list|)
argument_list|,
name|endTime
argument_list|(
name|getTime
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|String
name|getDate
parameter_list|()
block|{
return|return
name|diff
argument_list|(
name|getOldTime
argument_list|()
operator|==
literal|null
condition|?
literal|null
else|:
name|getOldTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
argument_list|,
name|getTime
argument_list|()
operator|.
name|getDatePatternName
argument_list|()
argument_list|)
return|;
block|}
block|}
specifier|public
class|class
name|Table
extends|extends
name|ArrayList
argument_list|<
name|TableLine
argument_list|>
block|{
specifier|private
specifier|static
specifier|final
name|long
name|serialVersionUID
init|=
literal|1L
decl_stmt|;
specifier|public
name|boolean
name|sameCourse
parameter_list|(
name|TableLine
name|a
parameter_list|,
name|TableLine
name|b
parameter_list|)
block|{
if|if
condition|(
name|a
operator|instanceof
name|TableCourseLine
operator|&&
name|b
operator|instanceof
name|TableCourseLine
condition|)
block|{
return|return
operator|(
operator|(
name|TableCourseLine
operator|)
name|a
operator|)
operator|.
name|getCourse
argument_list|()
operator|.
name|equals
argument_list|(
operator|(
operator|(
name|TableCourseLine
operator|)
name|b
operator|)
operator|.
name|getCourse
argument_list|()
argument_list|)
return|;
block|}
else|else
block|{
return|return
literal|false
return|;
block|}
block|}
specifier|public
name|boolean
name|isFirst
parameter_list|(
name|TableLine
name|line
parameter_list|)
block|{
name|int
name|index
init|=
name|indexOf
argument_list|(
name|line
argument_list|)
decl_stmt|;
return|return
operator|(
name|index
operator|<=
literal|0
operator|||
operator|!
name|sameCourse
argument_list|(
name|line
argument_list|,
name|get
argument_list|(
name|index
operator|-
literal|1
argument_list|)
argument_list|)
operator|)
return|;
block|}
specifier|public
name|boolean
name|isLast
parameter_list|(
name|TableLine
name|line
parameter_list|)
block|{
name|int
name|index
init|=
name|indexOf
argument_list|(
name|line
argument_list|)
decl_stmt|;
return|return
operator|(
name|index
operator|+
literal|1
operator|>=
name|size
argument_list|()
operator|||
operator|!
name|sameCourse
argument_list|(
name|line
argument_list|,
name|get
argument_list|(
name|index
operator|+
literal|1
argument_list|)
argument_list|)
operator|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|add
parameter_list|(
name|TableLine
name|line
parameter_list|)
block|{
name|line
operator|.
name|setTable
argument_list|(
name|this
argument_list|)
expr_stmt|;
return|return
name|super
operator|.
name|add
argument_list|(
name|line
argument_list|)
return|;
block|}
block|}
specifier|public
specifier|static
name|String
name|toString
parameter_list|(
name|Collection
argument_list|<
name|?
argument_list|>
name|items
parameter_list|)
block|{
if|if
condition|(
name|items
operator|==
literal|null
operator|||
name|items
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
literal|""
return|;
if|if
condition|(
name|items
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|)
return|return
name|items
operator|.
name|iterator
argument_list|()
operator|.
name|next
argument_list|()
operator|.
name|toString
argument_list|()
return|;
if|if
condition|(
name|items
operator|.
name|size
argument_list|()
operator|==
literal|2
condition|)
block|{
name|Iterator
argument_list|<
name|?
argument_list|>
name|i
init|=
name|items
operator|.
name|iterator
argument_list|()
decl_stmt|;
return|return
name|GWT
operator|.
name|itemSeparatorPair
argument_list|(
name|i
operator|.
name|next
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|,
name|i
operator|.
name|next
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
return|;
block|}
else|else
block|{
name|Iterator
argument_list|<
name|?
argument_list|>
name|i
init|=
name|items
operator|.
name|iterator
argument_list|()
decl_stmt|;
name|String
name|list
init|=
name|i
operator|.
name|next
argument_list|()
operator|.
name|toString
argument_list|()
decl_stmt|;
while|while
condition|(
name|i
operator|.
name|hasNext
argument_list|()
condition|)
block|{
name|String
name|item
init|=
name|i
operator|.
name|next
argument_list|()
operator|.
name|toString
argument_list|()
decl_stmt|;
if|if
condition|(
name|i
operator|.
name|hasNext
argument_list|()
condition|)
name|list
operator|=
name|GWT
operator|.
name|itemSeparatorMiddle
argument_list|(
name|list
argument_list|,
name|item
argument_list|)
expr_stmt|;
else|else
name|list
operator|=
name|GWT
operator|.
name|itemSeparatorLast
argument_list|(
name|list
argument_list|,
name|item
argument_list|)
expr_stmt|;
block|}
return|return
name|list
return|;
block|}
block|}
specifier|public
class|class
name|CourseRequestsTable
block|{
name|List
argument_list|<
name|CourseRequestLine
argument_list|>
name|lines
init|=
operator|new
name|ArrayList
argument_list|<
name|CourseRequestLine
argument_list|>
argument_list|()
decl_stmt|;
name|boolean
name|hasPref
init|=
literal|false
decl_stmt|,
name|hasWarn
init|=
literal|false
decl_stmt|,
name|hasWait
init|=
literal|false
decl_stmt|;
name|String
name|credit
init|=
literal|""
decl_stmt|;
name|void
name|add
parameter_list|(
name|CourseRequestLine
name|line
parameter_list|)
block|{
name|lines
operator|.
name|add
argument_list|(
name|line
argument_list|)
expr_stmt|;
block|}
specifier|public
name|List
argument_list|<
name|CourseRequestLine
argument_list|>
name|getLines
parameter_list|()
block|{
return|return
name|lines
return|;
block|}
specifier|public
name|boolean
name|getHasPref
parameter_list|()
block|{
return|return
name|hasPref
return|;
block|}
specifier|public
name|boolean
name|getHasWarn
parameter_list|()
block|{
return|return
name|hasWarn
return|;
block|}
specifier|public
name|boolean
name|getHasWait
parameter_list|()
block|{
return|return
name|hasWait
return|;
block|}
specifier|public
name|String
name|getCredit
parameter_list|()
block|{
return|return
name|credit
return|;
block|}
block|}
specifier|public
class|class
name|CourseRequestLine
block|{
specifier|public
name|String
name|priority
decl_stmt|;
specifier|public
name|String
name|courseName
decl_stmt|;
specifier|public
name|String
name|courseTitle
decl_stmt|;
specifier|public
name|String
name|credit
decl_stmt|;
specifier|public
name|String
name|prefs
decl_stmt|;
specifier|public
name|String
name|note
decl_stmt|;
specifier|public
name|String
name|status
decl_stmt|;
specifier|public
name|String
name|icon
decl_stmt|;
specifier|public
name|String
name|iconText
decl_stmt|;
specifier|public
name|boolean
name|waitlist
init|=
literal|false
decl_stmt|;
specifier|public
name|boolean
name|first
init|=
literal|false
decl_stmt|;
specifier|public
name|boolean
name|firstalt
init|=
literal|false
decl_stmt|;
specifier|public
name|boolean
name|last
init|=
literal|false
decl_stmt|;
specifier|public
name|int
name|rows
init|=
literal|1
decl_stmt|;
specifier|public
name|String
name|getPriority
parameter_list|()
block|{
return|return
name|priority
return|;
block|}
specifier|public
name|String
name|getCourseName
parameter_list|()
block|{
return|return
name|courseName
return|;
block|}
specifier|public
name|String
name|getCourseTitle
parameter_list|()
block|{
return|return
name|courseTitle
return|;
block|}
specifier|public
name|String
name|getCredit
parameter_list|()
block|{
return|return
name|credit
return|;
block|}
specifier|public
name|String
name|getPrefs
parameter_list|()
block|{
return|return
name|prefs
return|;
block|}
specifier|public
name|String
name|getNote
parameter_list|()
block|{
return|return
name|note
return|;
block|}
specifier|public
name|String
name|getStatus
parameter_list|()
block|{
return|return
name|status
return|;
block|}
specifier|public
name|String
name|getIcon
parameter_list|()
block|{
return|return
name|icon
return|;
block|}
specifier|public
name|String
name|getIconText
parameter_list|()
block|{
return|return
name|iconText
return|;
block|}
specifier|public
name|boolean
name|isWaitlist
parameter_list|()
block|{
return|return
name|waitlist
return|;
block|}
specifier|public
name|boolean
name|isFirst
parameter_list|()
block|{
return|return
name|first
return|;
block|}
specifier|public
name|boolean
name|isFirstalt
parameter_list|()
block|{
return|return
name|firstalt
return|;
block|}
specifier|public
name|boolean
name|isLast
parameter_list|()
block|{
return|return
name|last
return|;
block|}
specifier|public
name|int
name|getRows
parameter_list|()
block|{
return|return
name|rows
return|;
block|}
block|}
block|}
end_class

end_unit

