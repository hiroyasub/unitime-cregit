begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_package
package|package
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|webutil
package|;
end_package

begin_import
import|import
name|java
operator|.
name|text
operator|.
name|ParseException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|text
operator|.
name|SimpleDateFormat
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Calendar
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collections
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Comparator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Date
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Locale
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|StringTokenizer
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|TreeSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Pattern
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|PatternSyntaxException
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|servlet
operator|.
name|http
operator|.
name|HttpSession
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|servlet
operator|.
name|jsp
operator|.
name|JspWriter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|hibernate
operator|.
name|Query
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|htmlgen
operator|.
name|TableCell
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|htmlgen
operator|.
name|TableHeaderCell
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|htmlgen
operator|.
name|TableRow
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|commons
operator|.
name|web
operator|.
name|htmlgen
operator|.
name|TableStream
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|form
operator|.
name|EventListForm
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|form
operator|.
name|MeetingListForm
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Event
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Meeting
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|Event
operator|.
name|MultiMeeting
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|model
operator|.
name|dao
operator|.
name|EventDAO
import|;
end_import

begin_import
import|import
name|org
operator|.
name|unitime
operator|.
name|timetable
operator|.
name|util
operator|.
name|Constants
import|;
end_import

begin_class
specifier|public
class|class
name|WebEventTableBuilder
block|{
specifier|public
specifier|static
name|SimpleDateFormat
name|sDateFormat
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"EEE MM/dd, yyyy"
argument_list|,
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
comment|//public static SimpleDateFormat sDateFormatDay = new SimpleDateFormat("EEE", Locale.US);
specifier|public
specifier|static
name|SimpleDateFormat
name|sDateFormatM1
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd"
argument_list|,
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
specifier|public
specifier|static
name|SimpleDateFormat
name|sDateFormatM2
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd, yyyy"
argument_list|,
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
comment|//Colors
specifier|protected
specifier|static
name|String
name|indent
init|=
literal|"&nbsp;&nbsp;&nbsp;&nbsp;"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|oddRowBGColor
init|=
literal|"#DFE7F2"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|oddRowBGColorChild
init|=
literal|"#EFEFEF"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|oddRowMouseOverBGColor
init|=
literal|"#8EACD0"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|evenRowMouseOverBGColor
init|=
literal|"#8EACD0"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|headerBGColor1
init|=
literal|"#E0E0E0"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|headerBGColor2
init|=
literal|"#F4F4F4"
decl_stmt|;
specifier|protected
name|String
name|disabledColor
init|=
literal|"gray"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|formName
init|=
literal|"eventListForm"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|LABEL
init|=
literal|"Name"
decl_stmt|;
specifier|protected
specifier|static
name|String
name|EMPTY
init|=
literal|"&nbsp;"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|EVENT_CAPACITY
init|=
literal|"Capacity"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|EVENT_TYPE
init|=
literal|"Type"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|MAIN_CONTACT
init|=
literal|"Main Contact"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|SPONSORING_ORG
init|=
literal|"Sponsoring Org"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|MEETING_DATE
init|=
literal|"Date"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|MEETING_TIME
init|=
literal|"Time"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|MEETING_LOCATION
init|=
literal|"Location"
decl_stmt|;
specifier|public
specifier|static
specifier|final
name|String
name|APPROVED_DATE
init|=
literal|"Approved"
decl_stmt|;
specifier|public
name|WebEventTableBuilder
parameter_list|()
block|{
name|super
argument_list|()
expr_stmt|;
block|}
specifier|protected
name|String
name|getRowMouseOver
parameter_list|(
name|boolean
name|isHeaderRow
parameter_list|,
name|boolean
name|isControl
parameter_list|)
block|{
return|return
operator|(
literal|"this.style.backgroundColor='"
operator|+
operator|(
name|isHeaderRow
condition|?
name|oddRowMouseOverBGColor
else|:
name|evenRowMouseOverBGColor
operator|)
operator|+
literal|"';this.style.cursor='"
operator|+
operator|(
name|isControl
condition|?
literal|"hand"
else|:
literal|"default"
operator|)
operator|+
literal|"';this.style.cursor='"
operator|+
operator|(
name|isControl
condition|?
literal|"pointer"
else|:
literal|"default"
operator|)
operator|+
literal|"';"
operator|)
return|;
block|}
specifier|protected
name|String
name|getRowMouseOut
parameter_list|(
name|String
name|color
parameter_list|)
block|{
return|return
operator|(
literal|"this.style.backgroundColor='"
operator|+
operator|(
name|color
operator|==
literal|null
condition|?
literal|"transparent"
else|:
name|color
operator|)
operator|+
literal|"';"
operator|)
return|;
block|}
specifier|protected
name|TableRow
name|initRow
parameter_list|(
name|boolean
name|isHeaderRow
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
if|if
condition|(
name|isHeaderRow
condition|)
block|{
name|row
operator|.
name|setBgColor
argument_list|(
name|oddRowBGColor
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|row
operator|)
return|;
block|}
specifier|protected
name|TableHeaderCell
name|headerCell
parameter_list|(
name|String
name|content
parameter_list|,
name|int
name|rowSpan
parameter_list|,
name|int
name|colSpan
parameter_list|)
block|{
name|TableHeaderCell
name|cell
init|=
operator|new
name|TableHeaderCell
argument_list|()
decl_stmt|;
name|cell
operator|.
name|setRowSpan
argument_list|(
name|rowSpan
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setColSpan
argument_list|(
name|colSpan
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setAlign
argument_list|(
literal|"left"
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setValign
argument_list|(
literal|"bottom"
argument_list|)
expr_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"<font size=\"-1\">"
argument_list|)
expr_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|content
argument_list|)
expr_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"</font>"
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|initCell
parameter_list|(
name|boolean
name|isEditable
parameter_list|,
name|String
name|onClick
parameter_list|)
block|{
return|return
operator|(
name|initCell
argument_list|(
name|isEditable
argument_list|,
name|onClick
argument_list|,
literal|1
argument_list|,
literal|false
argument_list|)
operator|)
return|;
block|}
specifier|private
name|TableCell
name|initCell
parameter_list|(
name|boolean
name|isEditable
parameter_list|,
name|String
name|onClick
parameter_list|,
name|int
name|cols
parameter_list|)
block|{
return|return
operator|(
name|initCell
argument_list|(
name|isEditable
argument_list|,
name|onClick
argument_list|,
name|cols
argument_list|,
literal|false
argument_list|)
operator|)
return|;
block|}
specifier|private
name|TableCell
name|initCell
parameter_list|(
name|boolean
name|isEditable
parameter_list|,
name|String
name|onClick
parameter_list|,
name|int
name|cols
parameter_list|,
name|boolean
name|nowrap
parameter_list|)
block|{
name|TableCell
name|cell
init|=
operator|new
name|TableCell
argument_list|()
decl_stmt|;
name|cell
operator|.
name|setValign
argument_list|(
literal|"top"
argument_list|)
expr_stmt|;
if|if
condition|(
name|cols
operator|>
literal|1
condition|)
block|{
name|cell
operator|.
name|setColSpan
argument_list|(
name|cols
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|nowrap
condition|)
block|{
name|cell
operator|.
name|setNoWrap
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|onClick
operator|!=
literal|null
operator|&&
name|onClick
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|cell
operator|.
name|setOnClick
argument_list|(
name|onClick
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|isEditable
condition|)
block|{
name|cell
operator|.
name|addContent
argument_list|(
literal|"<font color="
operator|+
name|disabledColor
operator|+
literal|">"
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|void
name|endCell
parameter_list|(
name|TableCell
name|cell
parameter_list|,
name|boolean
name|isEditable
parameter_list|)
block|{
if|if
condition|(
operator|!
name|isEditable
condition|)
block|{
name|cell
operator|.
name|addContent
argument_list|(
literal|"</font>"
argument_list|)
expr_stmt|;
block|}
block|}
specifier|protected
name|TableCell
name|initNormalCell
parameter_list|(
name|String
name|text
parameter_list|,
name|boolean
name|isEditable
parameter_list|)
block|{
return|return
operator|(
name|initColSpanCell
argument_list|(
name|text
argument_list|,
name|isEditable
argument_list|,
literal|1
argument_list|)
operator|)
return|;
block|}
specifier|private
name|TableCell
name|initColSpanCell
parameter_list|(
name|String
name|text
parameter_list|,
name|boolean
name|isEditable
parameter_list|,
name|int
name|cols
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|initCell
argument_list|(
name|isEditable
argument_list|,
literal|null
argument_list|,
name|cols
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|endCell
argument_list|(
name|cell
argument_list|,
name|isEditable
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|protected
name|void
name|buildTableHeader
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|boolean
name|mainContact
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|row
operator|.
name|setBgColor
argument_list|(
name|headerBGColor1
argument_list|)
expr_stmt|;
name|TableRow
name|row2
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|row2
operator|.
name|setBgColor
argument_list|(
name|headerBGColor2
argument_list|)
expr_stmt|;
name|TableHeaderCell
name|cell
init|=
literal|null
decl_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|LABEL
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|EMPTY
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row2
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|EVENT_CAPACITY
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_DATE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row2
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|SPONSORING_ORG
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_TIME
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row2
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|EVENT_TYPE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_LOCATION
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row2
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
if|if
condition|(
name|mainContact
condition|)
block|{
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MAIN_CONTACT
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|APPROVED_DATE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row2
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
block|}
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
name|table
operator|.
name|addContent
argument_list|(
name|row2
argument_list|)
expr_stmt|;
block|}
specifier|protected
name|void
name|buildMeetingTableHeader
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|boolean
name|mainContact
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|row
operator|.
name|setBgColor
argument_list|(
name|headerBGColor1
argument_list|)
expr_stmt|;
name|TableHeaderCell
name|cell
init|=
literal|null
decl_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|LABEL
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|EVENT_TYPE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|EVENT_CAPACITY
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|SPONSORING_ORG
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_DATE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_TIME
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MEETING_LOCATION
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
if|if
condition|(
name|mainContact
condition|)
block|{
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|MAIN_CONTACT
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|cell
operator|=
name|this
operator|.
name|headerCell
argument_list|(
name|APPROVED_DATE
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"border-bottom: gray 1px solid"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
block|}
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
specifier|private
name|String
name|subjectOnClickAction
parameter_list|(
name|Long
name|eventId
parameter_list|)
block|{
return|return
operator|(
literal|"document.location='eventDetail.do?op=view&id="
operator|+
name|eventId
operator|+
literal|"';"
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEventName
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"<a name='A"
operator|+
name|e
operator|.
name|getUniqueId
argument_list|()
operator|+
literal|"'>"
operator|+
operator|(
name|e
operator|.
name|getEventName
argument_list|()
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
literal|"<b>"
operator|+
name|e
operator|.
name|getEventName
argument_list|()
operator|+
literal|"</b>"
operator|)
operator|+
literal|"</a>"
argument_list|)
expr_stmt|;
name|this
operator|.
name|endCell
argument_list|(
name|cell
argument_list|,
literal|true
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEventCapacity
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|int
name|minCap
init|=
operator|(
name|e
operator|.
name|getMinCapacity
argument_list|()
operator|==
literal|null
condition|?
operator|-
literal|1
else|:
name|e
operator|.
name|getMinCapacity
argument_list|()
operator|)
decl_stmt|;
name|int
name|maxCap
init|=
operator|(
name|e
operator|.
name|getMaxCapacity
argument_list|()
operator|==
literal|null
condition|?
operator|-
literal|1
else|:
name|e
operator|.
name|getMaxCapacity
argument_list|()
operator|)
decl_stmt|;
if|if
condition|(
name|minCap
operator|==
operator|-
literal|1
condition|)
block|{
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|maxCap
operator|!=
operator|-
literal|1
condition|)
block|{
if|if
condition|(
name|maxCap
operator|!=
name|minCap
condition|)
block|{
name|cell
operator|.
name|addContent
argument_list|(
name|minCap
operator|+
literal|"-"
operator|+
name|maxCap
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|cell
operator|.
name|addContent
argument_list|(
name|minCap
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|this
operator|.
name|endCell
argument_list|(
name|cell
argument_list|,
literal|true
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildSponsoringOrg
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|e
operator|.
name|getSponsoringOrganization
argument_list|()
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
name|e
operator|.
name|getSponsoringOrganization
argument_list|()
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEventType
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|e
operator|.
name|getEventTypeLabel
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEventTypeAbbv
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|e
operator|.
name|getEventTypeAbbv
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildMainContactName
parameter_list|(
name|Event
name|e
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
if|if
condition|(
name|e
operator|.
name|getMainContact
argument_list|()
operator|!=
literal|null
condition|)
name|cell
operator|.
name|addContent
argument_list|(
operator|(
name|e
operator|.
name|getMainContact
argument_list|()
operator|.
name|getLastName
argument_list|()
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
operator|(
name|e
operator|.
name|getMainContact
argument_list|()
operator|.
name|getLastName
argument_list|()
operator|+
literal|", "
operator|)
operator|)
operator|+
operator|(
name|e
operator|.
name|getMainContact
argument_list|()
operator|.
name|getFirstName
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|e
operator|.
name|getMainContact
argument_list|()
operator|.
name|getFirstName
argument_list|()
operator|)
argument_list|)
expr_stmt|;
else|else
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEmptyEventInfo
parameter_list|()
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildEmptyMeetingInfo
parameter_list|()
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildDate
parameter_list|(
name|Meeting
name|m
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|sDateFormat
operator|.
name|format
argument_list|(
name|m
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|/*     			+"&nbsp;&nbsp;<font color='gray'><i>("     			+sDateFormatDay.format(m.getMeetingDate())     			+")</i></font>"); //date cannot be null*/
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildDate
parameter_list|(
name|MultiMeeting
name|m
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|Calendar
name|c
init|=
name|Calendar
operator|.
name|getInstance
argument_list|()
decl_stmt|;
name|c
operator|.
name|setTime
argument_list|(
name|m
operator|.
name|getMeetings
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
expr_stmt|;
name|int
name|y1
init|=
name|c
operator|.
name|get
argument_list|(
name|Calendar
operator|.
name|YEAR
argument_list|)
decl_stmt|;
name|c
operator|.
name|setTime
argument_list|(
name|m
operator|.
name|getMeetings
argument_list|()
operator|.
name|last
argument_list|()
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
expr_stmt|;
name|int
name|y2
init|=
name|c
operator|.
name|get
argument_list|(
name|Calendar
operator|.
name|YEAR
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|m
operator|.
name|getDays
argument_list|()
operator|+
literal|" "
operator|+
operator|(
name|y1
operator|==
name|y2
condition|?
name|sDateFormatM1
else|:
name|sDateFormatM2
operator|)
operator|.
name|format
argument_list|(
name|m
operator|.
name|getMeetings
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
operator|+
literal|" - "
operator|+
name|sDateFormatM2
operator|.
name|format
argument_list|(
name|m
operator|.
name|getMeetings
argument_list|()
operator|.
name|last
argument_list|()
operator|.
name|getMeetingDate
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildTime
parameter_list|(
name|Meeting
name|m
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|int
name|start
init|=
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|*
name|m
operator|.
name|getStartPeriod
argument_list|()
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
operator|(
name|m
operator|.
name|getStartOffset
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|m
operator|.
name|getStartOffset
argument_list|()
operator|)
decl_stmt|;
name|int
name|startHour
init|=
name|start
operator|/
literal|60
decl_stmt|;
name|int
name|startMin
init|=
name|start
operator|%
literal|60
decl_stmt|;
name|int
name|end
init|=
name|Constants
operator|.
name|SLOT_LENGTH_MIN
operator|*
name|m
operator|.
name|getStopPeriod
argument_list|()
operator|+
name|Constants
operator|.
name|FIRST_SLOT_TIME_MIN
operator|+
operator|(
name|m
operator|.
name|getStopOffset
argument_list|()
operator|==
literal|null
condition|?
literal|0
else|:
name|m
operator|.
name|getStopOffset
argument_list|()
operator|)
decl_stmt|;
name|int
name|endHour
init|=
name|end
operator|/
literal|60
decl_stmt|;
name|int
name|endMin
init|=
name|end
operator|%
literal|60
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
operator|(
name|startHour
operator|>
literal|12
condition|?
name|startHour
operator|-
literal|12
else|:
name|startHour
operator|)
operator|+
literal|":"
operator|+
operator|(
name|startMin
operator|<
literal|10
condition|?
literal|"0"
else|:
literal|""
operator|)
operator|+
name|startMin
operator|+
operator|(
name|startHour
operator|>=
literal|12
condition|?
literal|"p"
else|:
literal|"a"
operator|)
operator|+
literal|"-"
operator|+
operator|(
name|endHour
operator|>
literal|12
condition|?
name|endHour
operator|-
literal|12
else|:
name|endHour
operator|)
operator|+
literal|":"
operator|+
operator|(
name|endMin
operator|<
literal|10
condition|?
literal|"0"
else|:
literal|""
operator|)
operator|+
name|endMin
operator|+
operator|(
name|endHour
operator|>=
literal|12
condition|?
literal|"p"
else|:
literal|"a"
operator|)
argument_list|)
expr_stmt|;
comment|//time cannot be null
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildLocation
parameter_list|(
name|Meeting
name|m
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|m
operator|.
name|getLocation
argument_list|()
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
name|m
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildApproved
parameter_list|(
name|Meeting
name|m
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|SimpleDateFormat
name|df
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yy"
argument_list|,
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|m
operator|.
name|getApprovedDate
argument_list|()
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
name|df
operator|.
name|format
argument_list|(
name|m
operator|.
name|getApprovedDate
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|TableCell
name|buildApproved
parameter_list|(
name|MultiMeeting
name|mm
parameter_list|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|SimpleDateFormat
name|df
init|=
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yy"
argument_list|,
name|Locale
operator|.
name|US
argument_list|)
decl_stmt|;
name|Date
name|approvalDate
init|=
literal|null
decl_stmt|;
comment|//latest approval date
for|for
control|(
name|Meeting
name|m
range|:
name|mm
operator|.
name|getMeetings
argument_list|()
control|)
if|if
condition|(
name|approvalDate
operator|==
literal|null
operator|||
name|approvalDate
operator|.
name|compareTo
argument_list|(
name|m
operator|.
name|getApprovedDate
argument_list|()
argument_list|)
operator|<
literal|0
condition|)
name|approvalDate
operator|=
name|m
operator|.
name|getApprovedDate
argument_list|()
expr_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
name|approvalDate
operator|==
literal|null
condition|?
literal|"&nbsp;"
else|:
name|df
operator|.
name|format
argument_list|(
name|approvalDate
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|cell
operator|)
return|;
block|}
specifier|private
name|void
name|addEventsRowsToTable
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|Event
name|e
parameter_list|,
name|boolean
name|mainContact
parameter_list|,
name|TreeSet
argument_list|<
name|MultiMeeting
argument_list|>
name|meetings
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|(
name|this
operator|.
name|initRow
argument_list|(
literal|true
argument_list|)
operator|)
decl_stmt|;
name|row
operator|.
name|setOnMouseOver
argument_list|(
name|this
operator|.
name|getRowMouseOver
argument_list|(
literal|true
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnMouseOut
argument_list|(
name|this
operator|.
name|getRowMouseOut
argument_list|(
name|oddRowBGColor
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnClick
argument_list|(
name|subjectOnClickAction
argument_list|(
name|e
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|TableCell
name|cell
init|=
literal|null
decl_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEventName
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEventCapacity
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildSponsoringOrg
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEventType
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mainContact
condition|)
name|row
operator|.
name|addContent
argument_list|(
name|buildMainContactName
argument_list|(
name|e
argument_list|)
argument_list|)
expr_stmt|;
name|boolean
name|allPast
init|=
literal|true
decl_stmt|;
for|for
control|(
name|MultiMeeting
name|meeting
range|:
name|meetings
control|)
block|{
if|if
condition|(
operator|!
name|meeting
operator|.
name|isPast
argument_list|()
condition|)
block|{
name|allPast
operator|=
literal|false
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|allPast
condition|)
name|row
operator|.
name|setStyle
argument_list|(
literal|"font-style:italic;color:gray;"
argument_list|)
expr_stmt|;
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
specifier|private
name|void
name|addMeetingRowsToTable
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|MultiMeeting
name|mm
parameter_list|,
name|boolean
name|mainContact
parameter_list|,
name|boolean
name|printOverlaps
parameter_list|)
block|{
name|Meeting
name|m
init|=
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|first
argument_list|()
decl_stmt|;
name|TableRow
name|row
init|=
operator|(
name|this
operator|.
name|initRow
argument_list|(
literal|false
argument_list|)
operator|)
decl_stmt|;
name|row
operator|.
name|setOnMouseOver
argument_list|(
name|this
operator|.
name|getRowMouseOver
argument_list|(
literal|false
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnClick
argument_list|(
name|subjectOnClickAction
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEmptyMeetingInfo
argument_list|()
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|?
name|buildDate
argument_list|(
name|m
argument_list|)
else|:
name|buildDate
argument_list|(
name|mm
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildTime
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildLocation
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|bgColor
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|mainContact
condition|)
name|row
operator|.
name|addContent
argument_list|(
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|?
name|buildApproved
argument_list|(
name|m
argument_list|)
else|:
name|buildApproved
argument_list|(
name|mm
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mm
operator|.
name|isPast
argument_list|()
condition|)
block|{
name|row
operator|.
name|setStyle
argument_list|(
literal|"font-style:italic;color:gray;"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|m
operator|.
name|isApproved
argument_list|()
condition|)
block|{
comment|//bgColor = "#DDFFDD";
block|}
else|else
block|{
name|bgColor
operator|=
literal|"#FFFFDD"
expr_stmt|;
block|}
block|}
name|row
operator|.
name|setBgColor
argument_list|(
name|bgColor
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnMouseOut
argument_list|(
name|getRowMouseOut
argument_list|(
name|bgColor
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
if|if
condition|(
name|printOverlaps
condition|)
block|{
name|TreeSet
argument_list|<
name|Meeting
argument_list|>
name|overlaps
init|=
operator|new
name|TreeSet
argument_list|()
decl_stmt|;
for|for
control|(
name|Meeting
name|mx
range|:
name|mm
operator|.
name|getMeetings
argument_list|()
control|)
block|{
name|overlaps
operator|.
name|addAll
argument_list|(
name|mx
operator|.
name|getTimeRoomOverlaps
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|overlaps
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|MultiMeeting
name|o
range|:
name|Event
operator|.
name|getMultiMeetings
argument_list|(
name|overlaps
argument_list|)
control|)
name|addOverlappingMeetingToTable
argument_list|(
name|table
argument_list|,
name|o
argument_list|,
name|mainContact
argument_list|)
expr_stmt|;
block|}
block|}
block|}
specifier|private
name|void
name|addOverlappingMeetingToTable
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|MultiMeeting
name|mm
parameter_list|,
name|boolean
name|mainContact
parameter_list|)
block|{
name|Meeting
name|m
init|=
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|first
argument_list|()
decl_stmt|;
name|TableRow
name|row
init|=
operator|(
name|this
operator|.
name|initRow
argument_list|(
literal|false
argument_list|)
operator|)
decl_stmt|;
name|row
operator|.
name|setOnMouseOver
argument_list|(
name|this
operator|.
name|getRowMouseOver
argument_list|(
literal|false
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnClick
argument_list|(
name|subjectOnClickAction
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;&nbsp;&nbsp;Conf/w "
operator|+
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
operator|+
literal|" ("
operator|+
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventTypeAbbv
argument_list|()
operator|+
literal|")"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|?
name|buildDate
argument_list|(
name|m
argument_list|)
else|:
name|buildDate
argument_list|(
name|mm
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildTime
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildLocation
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|bgColor
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|mainContact
condition|)
name|row
operator|.
name|addContent
argument_list|(
name|mm
operator|.
name|getMeetings
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|?
name|buildApproved
argument_list|(
name|m
argument_list|)
else|:
name|buildApproved
argument_list|(
name|mm
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mm
operator|.
name|isPast
argument_list|()
condition|)
block|{
name|row
operator|.
name|setStyle
argument_list|(
literal|"font-style:italic;color:gray;"
argument_list|)
expr_stmt|;
block|}
name|row
operator|.
name|setBgColor
argument_list|(
literal|"#FFD7D7"
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnMouseOut
argument_list|(
name|getRowMouseOut
argument_list|(
literal|"#FFD7D7"
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
specifier|private
name|void
name|addMeetingRowsToTable
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|Meeting
name|m
parameter_list|,
name|boolean
name|mainContact
parameter_list|,
name|Event
name|lastEvent
parameter_list|,
name|Date
name|now
parameter_list|,
name|boolean
name|line
parameter_list|,
name|boolean
name|printOverlaps
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|(
name|this
operator|.
name|initRow
argument_list|(
literal|false
argument_list|)
operator|)
decl_stmt|;
name|row
operator|.
name|setOnMouseOver
argument_list|(
name|this
operator|.
name|getRowMouseOver
argument_list|(
literal|false
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnClick
argument_list|(
name|subjectOnClickAction
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|lastEvent
operator|!=
literal|null
operator|&&
name|lastEvent
operator|.
name|getUniqueId
argument_list|()
operator|.
name|equals
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|row
operator|.
name|addContent
argument_list|(
name|buildEventName
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEventTypeAbbv
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildEventCapacity
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildSponsoringOrg
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|row
operator|.
name|addContent
argument_list|(
name|buildDate
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildTime
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildLocation
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|String
name|bgColor
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|mainContact
condition|)
block|{
if|if
condition|(
name|lastEvent
operator|!=
literal|null
operator|&&
name|lastEvent
operator|.
name|getUniqueId
argument_list|()
operator|.
name|equals
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
block|{
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|1
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|row
operator|.
name|addContent
argument_list|(
name|buildMainContactName
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|row
operator|.
name|addContent
argument_list|(
name|buildApproved
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|m
operator|.
name|getStartTime
argument_list|()
operator|.
name|before
argument_list|(
name|now
argument_list|)
condition|)
block|{
name|row
operator|.
name|setStyle
argument_list|(
literal|"font-style:italic;color:gray;"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|m
operator|.
name|isApproved
argument_list|()
condition|)
block|{
comment|//bgColor = "#DDFFDD";
block|}
else|else
block|{
name|bgColor
operator|=
literal|"#FFFFDD"
expr_stmt|;
block|}
block|}
name|row
operator|.
name|setBgColor
argument_list|(
name|bgColor
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnMouseOut
argument_list|(
name|getRowMouseOut
argument_list|(
name|bgColor
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|line
operator|&&
name|lastEvent
operator|!=
literal|null
operator|&&
operator|!
name|lastEvent
operator|.
name|getUniqueId
argument_list|()
operator|.
name|equals
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
block|{
for|for
control|(
name|Iterator
name|i
init|=
name|row
operator|.
name|getContents
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
operator|(
operator|(
name|TableCell
operator|)
name|i
operator|.
name|next
argument_list|()
operator|)
operator|.
name|setStyle
argument_list|(
literal|"border-top: gray 1px solid;"
argument_list|)
expr_stmt|;
block|}
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
if|if
condition|(
name|printOverlaps
condition|)
block|{
name|TreeSet
argument_list|<
name|Meeting
argument_list|>
name|overlaps
init|=
operator|new
name|TreeSet
argument_list|(
name|m
operator|.
name|getTimeRoomOverlaps
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|overlaps
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
for|for
control|(
name|Meeting
name|o
range|:
name|overlaps
control|)
name|addOverlappingMeetingToTable
argument_list|(
name|table
argument_list|,
name|o
argument_list|,
name|mainContact
argument_list|,
name|now
argument_list|)
expr_stmt|;
block|}
block|}
block|}
specifier|private
name|void
name|addOverlappingMeetingToTable
parameter_list|(
name|TableStream
name|table
parameter_list|,
name|Meeting
name|m
parameter_list|,
name|boolean
name|mainContact
parameter_list|,
name|Date
name|now
parameter_list|)
block|{
name|TableRow
name|row
init|=
operator|(
name|this
operator|.
name|initRow
argument_list|(
literal|false
argument_list|)
operator|)
decl_stmt|;
name|row
operator|.
name|setOnMouseOver
argument_list|(
name|this
operator|.
name|getRowMouseOver
argument_list|(
literal|false
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnClick
argument_list|(
name|subjectOnClickAction
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|TableCell
name|cell
init|=
name|this
operator|.
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"&nbsp;&nbsp;&nbsp;Conf/w "
operator|+
operator|(
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
operator|)
operator|+
literal|" ("
operator|+
name|m
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventTypeAbbv
argument_list|()
operator|+
literal|")"
argument_list|)
expr_stmt|;
name|this
operator|.
name|endCell
argument_list|(
name|cell
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
comment|//row.addContent(buildEventTypeAbbv(m.getEvent()));
name|row
operator|.
name|addContent
argument_list|(
name|buildEventCapacity
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildSponsoringOrg
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildDate
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildTime
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildLocation
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mainContact
condition|)
block|{
name|row
operator|.
name|addContent
argument_list|(
name|buildMainContactName
argument_list|(
name|m
operator|.
name|getEvent
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|buildApproved
argument_list|(
name|m
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|m
operator|.
name|getStartTime
argument_list|()
operator|.
name|before
argument_list|(
name|now
argument_list|)
condition|)
block|{
name|row
operator|.
name|setStyle
argument_list|(
literal|"font-style:italic;color:gray;"
argument_list|)
expr_stmt|;
block|}
name|row
operator|.
name|setBgColor
argument_list|(
literal|"#FFD7D7"
argument_list|)
expr_stmt|;
name|row
operator|.
name|setOnMouseOut
argument_list|(
name|getRowMouseOut
argument_list|(
literal|"#FFD7D7"
argument_list|)
argument_list|)
expr_stmt|;
name|table
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
specifier|protected
name|List
name|loadEvents
parameter_list|(
name|EventListForm
name|form
parameter_list|)
block|{
name|boolean
name|conf
init|=
operator|(
name|form
operator|.
name|getMode
argument_list|()
operator|==
name|EventListForm
operator|.
name|sModeAllConflictingEvents
operator|)
decl_stmt|;
name|String
name|query
init|=
literal|"select distinct e from Event e inner join e.meetings m where e.class in ("
decl_stmt|;
if|if
condition|(
name|conf
condition|)
block|{
name|query
operator|=
literal|"select distinct e from Event e inner join e.meetings m, Meeting mx where "
operator|+
literal|"mx.uniqueId!=m.uniqueId and m.meetingDate=mx.meetingDate and m.startPeriod< mx.stopPeriod and m.stopPeriod> mx.startPeriod and "
operator|+
literal|"m.locationPermanentId = mx.locationPermanentId and e.class in ("
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|form
operator|.
name|getEventTypes
argument_list|()
operator|.
name|length
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|query
operator|+=
literal|","
expr_stmt|;
switch|switch
condition|(
name|form
operator|.
name|getEventTypes
argument_list|()
index|[
name|i
index|]
operator|.
name|intValue
argument_list|()
condition|)
block|{
case|case
name|Event
operator|.
name|sEventTypeClass
case|:
name|query
operator|+=
literal|"ClassEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeFinalExam
case|:
name|query
operator|+=
literal|"FinalExamEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeMidtermExam
case|:
name|query
operator|+=
literal|"MidtermExamEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeCourse
case|:
name|query
operator|+=
literal|"CourseEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeSpecial
case|:
name|query
operator|+=
literal|"SpecialEvent"
expr_stmt|;
break|break;
block|}
comment|//query += form.getEventTypes()[i];
block|}
name|query
operator|+=
literal|")"
expr_stmt|;
if|if
condition|(
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and upper(e.eventName) like :eventNameSubstring"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and m.meetingDate>=:eventDateFrom"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and m.meetingDate<=:eventDateTo"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|StringTokenizer
name|s
init|=
operator|new
name|StringTokenizer
argument_list|(
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|.
name|trim
argument_list|()
argument_list|,
literal|", "
argument_list|)
init|;
name|s
operator|.
name|hasMoreTokens
argument_list|()
condition|;
control|)
block|{
name|String
name|token
init|=
name|s
operator|.
name|nextToken
argument_list|()
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
name|query
operator|+=
literal|" and (upper(e.mainContact.firstName) like '%"
operator|+
name|token
operator|+
literal|"%' or upper(e.mainContact.middleName) like '%"
operator|+
name|token
operator|+
literal|"%' or upper(e.mainContact.lastName) like '%"
operator|+
name|token
operator|+
literal|"%')"
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|form
operator|.
name|getMode
argument_list|()
condition|)
block|{
case|case
name|EventListForm
operator|.
name|sModeMyEvents
case|:
name|query
operator|+=
literal|" and e.mainContact.externalUniqueId = :userId"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllApprovedEvents
case|:
name|query
operator|+=
literal|" and m.approvedDate is not null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllEventsWaitingApproval
case|:
name|query
operator|+=
literal|" and m.approvedDate is null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeEvents4Approval
case|:
name|query
operator|+=
literal|" and m.approvedDate is null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllEvents
case|:
break|break;
block|}
if|if
condition|(
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|>=
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and e.sponsoringOrganization.uniqueId=:sponsorOrgId"
expr_stmt|;
block|}
name|query
operator|+=
literal|" order by e.eventName, e.uniqueId"
expr_stmt|;
name|Query
name|hibQuery
init|=
operator|new
name|EventDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
name|query
argument_list|)
decl_stmt|;
if|if
condition|(
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|hibQuery
operator|.
name|setString
argument_list|(
literal|"eventNameSubstring"
argument_list|,
literal|"%"
operator|+
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|toUpperCase
argument_list|()
operator|.
name|trim
argument_list|()
operator|+
literal|"%"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
try|try
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateFrom"
argument_list|,
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yyyy"
argument_list|)
operator|.
name|parse
argument_list|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|ParseException
name|ex
parameter_list|)
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateFrom"
argument_list|,
operator|new
name|Date
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
try|try
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateTo"
argument_list|,
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yyyy"
argument_list|)
operator|.
name|parse
argument_list|(
name|form
operator|.
name|getEventDateTo
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|ParseException
name|ex
parameter_list|)
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateTo"
argument_list|,
operator|new
name|Date
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|>=
literal|0
condition|)
block|{
name|hibQuery
operator|.
name|setLong
argument_list|(
literal|"sponsorOrgId"
argument_list|,
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|form
operator|.
name|getMode
argument_list|()
condition|)
block|{
case|case
name|EventListForm
operator|.
name|sModeMyEvents
case|:
name|hibQuery
operator|.
name|setString
argument_list|(
literal|"userId"
argument_list|,
name|form
operator|.
name|getUserId
argument_list|()
argument_list|)
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllApprovedEvents
case|:
case|case
name|EventListForm
operator|.
name|sModeAllEventsWaitingApproval
case|:
case|case
name|EventListForm
operator|.
name|sModeEvents4Approval
case|:
break|break;
block|}
return|return
name|hibQuery
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
return|;
block|}
specifier|public
name|void
name|htmlTableForEvents
parameter_list|(
name|HttpSession
name|httpSession
parameter_list|,
name|EventListForm
name|form
parameter_list|,
name|JspWriter
name|outputStream
parameter_list|)
block|{
name|List
name|events
init|=
name|loadEvents
argument_list|(
name|form
argument_list|)
decl_stmt|;
name|int
name|numberOfEvents
init|=
name|events
operator|.
name|size
argument_list|()
decl_stmt|;
name|TableStream
name|eventsTable
init|=
name|this
operator|.
name|initTable
argument_list|(
name|outputStream
argument_list|)
decl_stmt|;
if|if
condition|(
name|numberOfEvents
operator|>
literal|100
operator|&&
name|form
operator|.
name|getMode
argument_list|()
operator|!=
name|EventListForm
operator|.
name|sModeEvents4Approval
condition|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|TableCell
name|cell
init|=
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|5
argument_list|,
literal|false
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"Warning: There are more than 100 events matching your search criteria. Only the first 100 events are displayed. Please, redefine the search criteria in your filter."
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"padding-bottom:10px;color:red;font-weight:bold;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|eventsTable
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|numberOfEvents
operator|==
literal|0
condition|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|TableCell
name|cell
init|=
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|5
argument_list|,
literal|false
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"No events matching the search criteria were found."
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"padding-bottom:10px;color:red;font-weight:bold;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|eventsTable
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
else|else
name|buildTableHeader
argument_list|(
name|eventsTable
argument_list|,
name|form
operator|.
name|isAdmin
argument_list|()
operator|||
name|form
operator|.
name|isEventManager
argument_list|()
argument_list|)
expr_stmt|;
name|ArrayList
name|eventIds
init|=
operator|new
name|ArrayList
argument_list|()
decl_stmt|;
name|int
name|idx
init|=
literal|0
decl_stmt|;
for|for
control|(
name|Iterator
name|it
init|=
name|events
operator|.
name|iterator
argument_list|()
init|;
name|it
operator|.
name|hasNext
argument_list|()
condition|;
name|idx
operator|++
control|)
block|{
name|Event
name|event
init|=
operator|(
name|Event
operator|)
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|form
operator|.
name|getMode
argument_list|()
operator|==
name|EventListForm
operator|.
name|sModeEvents4Approval
condition|)
block|{
name|boolean
name|myApproval
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Iterator
name|j
init|=
name|event
operator|.
name|getMeetings
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|j
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Meeting
name|m
init|=
operator|(
name|Meeting
operator|)
name|j
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|m
operator|.
name|getApprovedDate
argument_list|()
operator|==
literal|null
operator|&&
name|m
operator|.
name|getLocation
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getManagingDepartments
argument_list|()
operator|.
name|contains
argument_list|(
name|m
operator|.
name|getLocation
argument_list|()
operator|.
name|getControllingDepartment
argument_list|()
argument_list|)
condition|)
block|{
name|myApproval
operator|=
literal|true
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
operator|!
name|myApproval
condition|)
continue|continue;
block|}
if|else  if
condition|(
name|idx
operator|==
literal|100
condition|)
break|break;
name|eventIds
operator|.
name|add
argument_list|(
name|event
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|TreeSet
argument_list|<
name|MultiMeeting
argument_list|>
name|meetings
init|=
name|event
operator|.
name|getMultiMeetings
argument_list|()
decl_stmt|;
name|addEventsRowsToTable
argument_list|(
name|eventsTable
argument_list|,
name|event
argument_list|,
name|form
operator|.
name|isAdmin
argument_list|()
operator|||
name|form
operator|.
name|isEventManager
argument_list|()
argument_list|,
name|meetings
argument_list|)
expr_stmt|;
for|for
control|(
name|MultiMeeting
name|meeting
range|:
name|meetings
control|)
name|addMeetingRowsToTable
argument_list|(
name|eventsTable
argument_list|,
name|meeting
argument_list|,
name|form
operator|.
name|isAdmin
argument_list|()
operator|||
name|form
operator|.
name|isEventManager
argument_list|()
argument_list|,
name|form
operator|.
name|getDispConflicts
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|eventsTable
operator|.
name|tableComplete
argument_list|()
expr_stmt|;
name|Navigation
operator|.
name|set
argument_list|(
name|httpSession
argument_list|,
name|Navigation
operator|.
name|sInstructionalOfferingLevel
argument_list|,
name|eventIds
argument_list|)
expr_stmt|;
block|}
specifier|protected
name|boolean
name|match
parameter_list|(
name|String
name|filter
parameter_list|,
name|String
name|name
parameter_list|)
block|{
if|if
condition|(
name|filter
operator|==
literal|null
operator|||
name|filter
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|)
return|return
literal|true
return|;
name|String
name|n
init|=
operator|(
name|name
operator|==
literal|null
condition|?
literal|""
else|:
name|name
operator|)
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
name|StringTokenizer
name|stk1
init|=
operator|new
name|StringTokenizer
argument_list|(
name|filter
operator|.
name|toUpperCase
argument_list|()
argument_list|,
literal|";"
argument_list|)
decl_stmt|;
while|while
condition|(
name|stk1
operator|.
name|hasMoreTokens
argument_list|()
condition|)
block|{
name|StringTokenizer
name|stk2
init|=
operator|new
name|StringTokenizer
argument_list|(
name|stk1
operator|.
name|nextToken
argument_list|()
argument_list|,
literal|" ,"
argument_list|)
decl_stmt|;
name|boolean
name|match
init|=
literal|true
decl_stmt|;
while|while
condition|(
name|match
operator|&&
name|stk2
operator|.
name|hasMoreTokens
argument_list|()
condition|)
block|{
name|String
name|token
init|=
name|stk2
operator|.
name|nextToken
argument_list|()
operator|.
name|trim
argument_list|()
decl_stmt|;
if|if
condition|(
name|token
operator|.
name|length
argument_list|()
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|token
operator|.
name|indexOf
argument_list|(
literal|'*'
argument_list|)
operator|>=
literal|0
operator|||
name|token
operator|.
name|indexOf
argument_list|(
literal|'?'
argument_list|)
operator|>=
literal|0
condition|)
block|{
try|try
block|{
name|String
name|tokenRegExp
init|=
literal|"\\s+"
operator|+
name|token
operator|.
name|replaceAll
argument_list|(
literal|"\\."
argument_list|,
literal|"\\."
argument_list|)
operator|.
name|replaceAll
argument_list|(
literal|"\\?"
argument_list|,
literal|".+"
argument_list|)
operator|.
name|replaceAll
argument_list|(
literal|"\\*"
argument_list|,
literal|".*"
argument_list|)
operator|+
literal|"\\s"
decl_stmt|;
if|if
condition|(
operator|!
name|Pattern
operator|.
name|compile
argument_list|(
name|tokenRegExp
argument_list|)
operator|.
name|matcher
argument_list|(
literal|" "
operator|+
name|n
operator|+
literal|" "
argument_list|)
operator|.
name|find
argument_list|()
condition|)
name|match
operator|=
literal|false
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|PatternSyntaxException
name|e
parameter_list|)
block|{
name|match
operator|=
literal|false
expr_stmt|;
block|}
block|}
if|else if
condition|(
name|n
operator|.
name|indexOf
argument_list|(
name|token
argument_list|)
operator|<
literal|0
condition|)
name|match
operator|=
literal|false
expr_stmt|;
block|}
if|if
condition|(
name|match
condition|)
return|return
literal|true
return|;
block|}
return|return
literal|false
return|;
block|}
specifier|protected
name|List
argument_list|<
name|Meeting
argument_list|>
name|loadMeetings
parameter_list|(
name|MeetingListForm
name|form
parameter_list|)
block|{
name|boolean
name|conf
init|=
operator|(
name|form
operator|.
name|getMode
argument_list|()
operator|==
name|EventListForm
operator|.
name|sModeAllConflictingEvents
operator|)
decl_stmt|;
name|String
name|query
init|=
literal|"select m from Event e inner join e.meetings m where e.class in ("
decl_stmt|;
if|if
condition|(
name|conf
condition|)
block|{
name|query
operator|=
literal|"select m from Event e inner join e.meetings m, Meeting mx where "
operator|+
literal|"mx.uniqueId!=m.uniqueId and m.meetingDate=mx.meetingDate and m.startPeriod< mx.stopPeriod and m.stopPeriod> mx.startPeriod and "
operator|+
literal|"m.locationPermanentId = mx.locationPermanentId and e.class in ("
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|form
operator|.
name|getEventTypes
argument_list|()
operator|.
name|length
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|query
operator|+=
literal|","
expr_stmt|;
switch|switch
condition|(
name|form
operator|.
name|getEventTypes
argument_list|()
index|[
name|i
index|]
operator|.
name|intValue
argument_list|()
condition|)
block|{
case|case
name|Event
operator|.
name|sEventTypeClass
case|:
name|query
operator|+=
literal|"ClassEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeFinalExam
case|:
name|query
operator|+=
literal|"FinalExamEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeMidtermExam
case|:
name|query
operator|+=
literal|"MidtermExamEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeCourse
case|:
name|query
operator|+=
literal|"CourseEvent"
expr_stmt|;
break|break;
case|case
name|Event
operator|.
name|sEventTypeSpecial
case|:
name|query
operator|+=
literal|"SpecialEvent"
expr_stmt|;
break|break;
block|}
comment|//query += form.getEventTypes()[i];
block|}
name|query
operator|+=
literal|")"
expr_stmt|;
if|if
condition|(
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and upper(e.eventName) like :eventNameSubstring"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and m.meetingDate>=:eventDateFrom"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and m.meetingDate<=:eventDateTo"
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|StringTokenizer
name|s
init|=
operator|new
name|StringTokenizer
argument_list|(
name|form
operator|.
name|getEventMainContactSubstring
argument_list|()
operator|.
name|trim
argument_list|()
argument_list|,
literal|", "
argument_list|)
init|;
name|s
operator|.
name|hasMoreTokens
argument_list|()
condition|;
control|)
block|{
name|String
name|token
init|=
name|s
operator|.
name|nextToken
argument_list|()
operator|.
name|toUpperCase
argument_list|()
decl_stmt|;
name|query
operator|+=
literal|" and (upper(e.mainContact.firstName) like '%"
operator|+
name|token
operator|+
literal|"%' or upper(e.mainContact.middleName) like '%"
operator|+
name|token
operator|+
literal|"%' or upper(e.mainContact.lastName) like '%"
operator|+
name|token
operator|+
literal|"%')"
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|form
operator|.
name|getMode
argument_list|()
condition|)
block|{
case|case
name|EventListForm
operator|.
name|sModeMyEvents
case|:
name|query
operator|+=
literal|" and e.mainContact.externalUniqueId = :userId"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllApprovedEvents
case|:
name|query
operator|+=
literal|" and m.approvedDate is not null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllEventsWaitingApproval
case|:
name|query
operator|+=
literal|" and m.approvedDate is null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeEvents4Approval
case|:
name|query
operator|+=
literal|" and m.approvedDate is null"
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllEvents
case|:
break|break;
block|}
if|if
condition|(
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|>=
literal|0
condition|)
block|{
name|query
operator|+=
literal|" and e.sponsoringOrganization.uniqueId=:sponsorOrgId"
expr_stmt|;
block|}
name|Query
name|hibQuery
init|=
operator|new
name|EventDAO
argument_list|()
operator|.
name|getSession
argument_list|()
operator|.
name|createQuery
argument_list|(
name|query
argument_list|)
decl_stmt|;
if|if
condition|(
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
name|hibQuery
operator|.
name|setString
argument_list|(
literal|"eventNameSubstring"
argument_list|,
literal|"%"
operator|+
name|form
operator|.
name|getEventNameSubstring
argument_list|()
operator|.
name|toUpperCase
argument_list|()
operator|.
name|trim
argument_list|()
operator|+
literal|"%"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateFrom
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
try|try
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateFrom"
argument_list|,
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yyyy"
argument_list|)
operator|.
name|parse
argument_list|(
name|form
operator|.
name|getEventDateFrom
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|ParseException
name|ex
parameter_list|)
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateFrom"
argument_list|,
operator|new
name|Date
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getEventDateTo
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
condition|)
block|{
try|try
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateTo"
argument_list|,
operator|new
name|SimpleDateFormat
argument_list|(
literal|"MM/dd/yyyy"
argument_list|)
operator|.
name|parse
argument_list|(
name|form
operator|.
name|getEventDateTo
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|ParseException
name|ex
parameter_list|)
block|{
name|hibQuery
operator|.
name|setDate
argument_list|(
literal|"eventDateTo"
argument_list|,
operator|new
name|Date
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
operator|>=
literal|0
condition|)
block|{
name|hibQuery
operator|.
name|setLong
argument_list|(
literal|"sponsorOrgId"
argument_list|,
name|form
operator|.
name|getSponsoringOrganization
argument_list|()
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|form
operator|.
name|getMode
argument_list|()
condition|)
block|{
case|case
name|EventListForm
operator|.
name|sModeMyEvents
case|:
name|hibQuery
operator|.
name|setString
argument_list|(
literal|"userId"
argument_list|,
name|form
operator|.
name|getUserId
argument_list|()
argument_list|)
expr_stmt|;
break|break;
case|case
name|EventListForm
operator|.
name|sModeAllApprovedEvents
case|:
case|case
name|EventListForm
operator|.
name|sModeAllEventsWaitingApproval
case|:
case|case
name|EventListForm
operator|.
name|sModeEvents4Approval
case|:
break|break;
block|}
name|List
name|meetings
init|=
name|hibQuery
operator|.
name|setCacheable
argument_list|(
literal|true
argument_list|)
operator|.
name|list
argument_list|()
decl_stmt|;
if|if
condition|(
name|form
operator|.
name|getMode
argument_list|()
operator|==
name|EventListForm
operator|.
name|sModeEvents4Approval
operator|||
operator|(
name|form
operator|.
name|getLocation
argument_list|()
operator|!=
literal|null
operator|&&
name|form
operator|.
name|getLocation
argument_list|()
operator|.
name|trim
argument_list|()
operator|.
name|length
argument_list|()
operator|>
literal|0
operator|)
condition|)
block|{
for|for
control|(
name|Iterator
name|it
init|=
name|meetings
operator|.
name|iterator
argument_list|()
init|;
name|it
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Meeting
name|meeting
init|=
operator|(
name|Meeting
operator|)
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|form
operator|.
name|getMode
argument_list|()
operator|==
name|EventListForm
operator|.
name|sModeEvents4Approval
condition|)
block|{
if|if
condition|(
name|meeting
operator|.
name|getApprovedDate
argument_list|()
operator|!=
literal|null
operator|||
name|meeting
operator|.
name|getLocation
argument_list|()
operator|==
literal|null
operator|||
operator|!
name|form
operator|.
name|getManagingDepartments
argument_list|()
operator|.
name|contains
argument_list|(
name|meeting
operator|.
name|getLocation
argument_list|()
operator|.
name|getControllingDepartment
argument_list|()
argument_list|)
condition|)
block|{
name|it
operator|.
name|remove
argument_list|()
expr_stmt|;
continue|continue;
block|}
block|}
if|if
condition|(
name|meeting
operator|.
name|getLocation
argument_list|()
operator|==
literal|null
operator|||
operator|!
name|match
argument_list|(
name|form
operator|.
name|getLocation
argument_list|()
argument_list|,
name|meeting
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
argument_list|)
condition|)
block|{
name|it
operator|.
name|remove
argument_list|()
expr_stmt|;
continue|continue;
block|}
block|}
block|}
name|Comparator
argument_list|<
name|Meeting
argument_list|>
name|cmp
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|MeetingListForm
operator|.
name|sOrderByName
operator|.
name|equals
argument_list|(
name|form
operator|.
name|getOrderBy
argument_list|()
argument_list|)
condition|)
block|{
name|cmp
operator|=
operator|new
name|Comparator
argument_list|<
name|Meeting
argument_list|>
argument_list|()
block|{
specifier|public
name|int
name|compare
parameter_list|(
name|Meeting
name|m1
parameter_list|,
name|Meeting
name|m2
parameter_list|)
block|{
name|int
name|cmp
init|=
name|m1
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
operator|.
name|compareToIgnoreCase
argument_list|(
name|m2
operator|.
name|getEvent
argument_list|()
operator|.
name|getEventName
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
name|cmp
operator|=
name|m1
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
operator|.
name|compareTo
argument_list|(
name|m2
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
return|return
name|m1
operator|.
name|compareTo
argument_list|(
name|m2
argument_list|)
return|;
block|}
block|}
expr_stmt|;
block|}
if|else if
condition|(
name|MeetingListForm
operator|.
name|sOrderByLocation
operator|.
name|equals
argument_list|(
name|form
operator|.
name|getOrderBy
argument_list|()
argument_list|)
condition|)
block|{
name|cmp
operator|=
operator|new
name|Comparator
argument_list|<
name|Meeting
argument_list|>
argument_list|()
block|{
specifier|public
name|int
name|compare
parameter_list|(
name|Meeting
name|m1
parameter_list|,
name|Meeting
name|m2
parameter_list|)
block|{
name|String
name|l1
init|=
operator|(
name|m1
operator|.
name|getLocation
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|m1
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|)
decl_stmt|;
name|String
name|l2
init|=
operator|(
name|m2
operator|.
name|getLocation
argument_list|()
operator|==
literal|null
condition|?
literal|""
else|:
name|m2
operator|.
name|getLocation
argument_list|()
operator|.
name|getLabel
argument_list|()
operator|)
decl_stmt|;
name|int
name|cmp
init|=
name|l1
operator|.
name|compareToIgnoreCase
argument_list|(
name|l2
argument_list|)
decl_stmt|;
if|if
condition|(
name|cmp
operator|!=
literal|0
condition|)
return|return
name|cmp
return|;
return|return
name|m1
operator|.
name|compareTo
argument_list|(
name|m2
argument_list|)
return|;
block|}
block|}
expr_stmt|;
block|}
if|else if
condition|(
name|MeetingListForm
operator|.
name|sOrderByTime
operator|.
name|equals
argument_list|(
name|form
operator|.
name|getOrderBy
argument_list|()
argument_list|)
condition|)
block|{
name|cmp
operator|=
operator|new
name|Comparator
argument_list|<
name|Meeting
argument_list|>
argument_list|()
block|{
specifier|public
name|int
name|compare
parameter_list|(
name|Meeting
name|m1
parameter_list|,
name|Meeting
name|m2
parameter_list|)
block|{
return|return
name|m1
operator|.
name|compareTo
argument_list|(
name|m2
argument_list|)
return|;
block|}
block|}
expr_stmt|;
block|}
if|if
condition|(
name|cmp
operator|!=
literal|null
condition|)
name|Collections
operator|.
name|sort
argument_list|(
name|meetings
argument_list|,
name|cmp
argument_list|)
expr_stmt|;
return|return
name|meetings
return|;
block|}
specifier|public
name|void
name|htmlTableForMeetings
parameter_list|(
name|HttpSession
name|httpSession
parameter_list|,
name|MeetingListForm
name|form
parameter_list|,
name|JspWriter
name|outputStream
parameter_list|)
block|{
name|List
name|meetings
init|=
name|loadMeetings
argument_list|(
name|form
argument_list|)
decl_stmt|;
name|int
name|numberOfMeetings
init|=
name|meetings
operator|.
name|size
argument_list|()
decl_stmt|;
name|TableStream
name|eventsTable
init|=
name|this
operator|.
name|initTable
argument_list|(
name|outputStream
argument_list|)
decl_stmt|;
if|if
condition|(
name|numberOfMeetings
operator|>
literal|100
operator|&&
name|form
operator|.
name|getMode
argument_list|()
operator|!=
name|EventListForm
operator|.
name|sModeEvents4Approval
condition|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|TableCell
name|cell
init|=
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|5
argument_list|,
literal|false
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"Warning: There are more than 100 meetings matching your search criteria. Only the first 100 meetings are displayed. Please, redefine the search criteria in your filter."
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"padding-bottom:10px;color:red;font-weight:bold;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|eventsTable
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|numberOfMeetings
operator|==
literal|0
condition|)
block|{
name|TableRow
name|row
init|=
operator|new
name|TableRow
argument_list|()
decl_stmt|;
name|TableCell
name|cell
init|=
name|initCell
argument_list|(
literal|true
argument_list|,
literal|null
argument_list|,
literal|5
argument_list|,
literal|false
argument_list|)
decl_stmt|;
name|cell
operator|.
name|addContent
argument_list|(
literal|"No meetings matching the search criteria were found."
argument_list|)
expr_stmt|;
name|cell
operator|.
name|setStyle
argument_list|(
literal|"padding-bottom:10px;color:red;font-weight:bold;"
argument_list|)
expr_stmt|;
name|row
operator|.
name|addContent
argument_list|(
name|cell
argument_list|)
expr_stmt|;
name|eventsTable
operator|.
name|addContent
argument_list|(
name|row
argument_list|)
expr_stmt|;
block|}
else|else
name|buildMeetingTableHeader
argument_list|(
name|eventsTable
argument_list|,
name|form
operator|.
name|isAdmin
argument_list|()
operator|||
name|form
operator|.
name|isEventManager
argument_list|()
argument_list|)
expr_stmt|;
name|int
name|idx
init|=
literal|0
decl_stmt|;
name|HashSet
argument_list|<
name|Long
argument_list|>
name|eventIdsHash
init|=
operator|new
name|HashSet
argument_list|()
decl_stmt|;
name|Event
name|lastEvent
init|=
literal|null
decl_stmt|;
name|Date
name|now
init|=
operator|new
name|Date
argument_list|()
decl_stmt|;
name|boolean
name|line
init|=
name|MeetingListForm
operator|.
name|sOrderByName
operator|.
name|equals
argument_list|(
name|form
operator|.
name|getOrderBy
argument_list|()
argument_list|)
decl_stmt|;
name|ArrayList
name|eventIds
init|=
operator|new
name|ArrayList
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|it
init|=
name|meetings
operator|.
name|iterator
argument_list|()
init|;
name|it
operator|.
name|hasNext
argument_list|()
condition|;
name|idx
operator|++
control|)
block|{
name|Meeting
name|meeting
init|=
operator|(
name|Meeting
operator|)
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|idx
operator|==
literal|100
condition|)
break|break;
if|if
condition|(
name|eventIdsHash
operator|.
name|add
argument_list|(
name|meeting
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
condition|)
name|eventIds
operator|.
name|add
argument_list|(
name|meeting
operator|.
name|getEvent
argument_list|()
operator|.
name|getUniqueId
argument_list|()
argument_list|)
expr_stmt|;
name|addMeetingRowsToTable
argument_list|(
name|eventsTable
argument_list|,
name|meeting
argument_list|,
name|form
operator|.
name|isAdmin
argument_list|()
operator|||
name|form
operator|.
name|isEventManager
argument_list|()
argument_list|,
name|lastEvent
argument_list|,
name|now
argument_list|,
name|line
argument_list|,
name|form
operator|.
name|getDispConflicts
argument_list|()
argument_list|)
expr_stmt|;
name|lastEvent
operator|=
name|meeting
operator|.
name|getEvent
argument_list|()
expr_stmt|;
block|}
name|eventsTable
operator|.
name|tableComplete
argument_list|()
expr_stmt|;
name|Navigation
operator|.
name|set
argument_list|(
name|httpSession
argument_list|,
name|Navigation
operator|.
name|sInstructionalOfferingLevel
argument_list|,
name|eventIds
argument_list|)
expr_stmt|;
block|}
specifier|protected
name|TableStream
name|initTable
parameter_list|(
name|JspWriter
name|outputStream
parameter_list|)
block|{
name|TableStream
name|table
init|=
operator|new
name|TableStream
argument_list|(
name|outputStream
argument_list|)
decl_stmt|;
name|table
operator|.
name|setWidth
argument_list|(
literal|"90%"
argument_list|)
expr_stmt|;
name|table
operator|.
name|setBorder
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|table
operator|.
name|setCellSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|table
operator|.
name|setCellPadding
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|table
operator|.
name|tableDefComplete
argument_list|()
expr_stmt|;
return|return
operator|(
name|table
operator|)
return|;
block|}
block|}
end_class

end_unit

